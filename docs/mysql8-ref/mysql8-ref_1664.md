# 25.4.3 NDB 集群配置文件

> 原文：[`dev.mysql.com/doc/refman/8.0/en/mysql-cluster-config-file.html`](https://dev.mysql.com/doc/refman/8.0/en/mysql-cluster-config-file.html)

25.4.3.1 NDB 集群配置：基本示例

25.4.3.2 NDB 集群推荐的起始配置

25.4.3.3 NDB 集群连接字符串

25.4.3.4 在 NDB 集群中定义计算机

25.4.3.5 定义 NDB 集群管理服务器

25.4.3.6 定义 NDB 集群数据节点

25.4.3.7 在 NDB 集群中定义 SQL 和其他 API 节点

25.4.3.8 定义系统

25.4.3.9 NDB 集群的 MySQL 服务器选项和变量

25.4.3.10 NDB 集群 TCP/IP 连接

25.4.3.11 使用直接连接的 NDB 集群 TCP/IP 连接

25.4.3.12 NDB 集群共享内存连接

25.4.3.13 数据节点内存管理

25.4.3.14 配置 NDB 集群发送缓冲区参数

配置 NDB 集群需要处理两个文件：

+   `my.cnf`：指定所有 NDB 集群可执行文件的选项。这个文件，你应该在之前使用 MySQL 时熟悉，必须被集群中运行的每个可执行文件访问。

+   `config.ini`：这个文件，有时被称为全局配置文件，只被 NDB 集群管理服务器读取，然后将其中包含的信息分发给参与集群的所有进程。`config.ini` 包含了集群中涉及的每个节点的描述。这包括数据节点的配置参数和集群中所有节点之间连接的配置参数。要快速查看此文件中可能出现的部分以及每个部分中可能放置的配置参数类型，请参阅 config.ini 文件的部分。

**配置数据的缓存。** `NDB` 使用有状态的配置。管理服务器在重新启动时不会每次读取全局配置文件，而是在第一次启动时缓存配置，之后，只有在以下条件之一为真时才会读取全局配置文件：

+   **管理服务器是使用--initial 选项启动的。** 当使用`--initial`时，全局配置文件将被重新读取，任何现有的缓存文件将被删除，并且管理服务器将创建一个新的配置缓存。

+   **管理服务器是使用--reload 选项启动的。** `--reload`选项会导致管理服务器将其缓存与全局配置文件进行比较。如果它们不同，管理服务器将创建一个新的配置缓存；任何现有的配置缓存将被保留，但不被使用。如果管理服务器的缓存和全局配置文件包含相同的配置数据，则使用现有的缓存，并且不会创建新的缓存。

+   **管理服务器是使用--config-cache=FALSE 启动的。** 这会禁用`--config-cache`（默认启用），并可用于强制管理服务器完全绕过配置缓存。在这种情况下，管理服务器会忽略可能存在的任何配置文件，始终从`config.ini`文件中读取其配置数据。

+   **未找到配置缓存。** 在这种情况下，管理服务器会读取全局配置文件并创建一个包含与文件中相同配置数据的缓存。

**配置缓存文件。** 默认情况下，管理服务器会在 MySQL 安装目录中名为`mysql-cluster`的目录中创建配置缓存文件。（如果在 Unix 系统上从源代码构建 NDB Cluster，则默认位置为`/usr/local/mysql-cluster`。）可以通过使用`--configdir`选项在运行时覆盖此设置。配置缓存文件是以`ndb_*`node_id`*_config.bin.*`seq_id`*`的模式命名的二进制文件，其中*`node_id`*是集群中管理服务器的节点 ID，*`seq_id`*是缓存标识符。缓存文件按顺序使用*`seq_id`*进行编号，按创建顺序排列。管理服务器使用由*`seq_id`*确定的最新缓存文件。

注意

通过删除后续配置缓存文件或重命名较早的缓存文件以使其具有更高的*`seq_id`*，可以回滚到先前的配置。然而，由于配置缓存文件以二进制格式编写，不应尝试手动编辑其内容。

有关 NDB Cluster 管理服务器的`--configdir`、`--config-cache`、`--initial`和`--reload`选项的更多信息，请参见第 25.5.4 节“ndb_mgmd — NDB Cluster 管理服务器守护程序”。

我们不断改进 NDB Cluster 配置，并试图简化这个过程。虽然我们努力保持向后兼容性，但有时可能会引入不兼容的更改。在这种情况下，如果更改不向后兼容，我们会尽量提前通知 NDB Cluster 用户。如果您发现这样的更改并且我们没有记录，请按照第 1.5 节“如何报告错误或问题”中给出的说明在 MySQL 错误数据库中报告。
