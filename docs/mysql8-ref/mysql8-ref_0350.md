# 8.1.1 安全指南

> 原文：[`dev.mysql.com/doc/refman/8.0/en/security-guidelines.html`](https://dev.mysql.com/doc/refman/8.0/en/security-guidelines.html)

任何在连接到互联网的计算机上使用 MySQL 的人都应该阅读本节，以避免最常见的安全错误。

在讨论安全性时，有必要全面保护整个服务器主机（不仅仅是 MySQL 服务器）免受所有类型的适用攻击：窃听、篡改、回放和拒绝服务。我们在这里不涵盖可用性和容错性的所有方面。

MySQL 基于访问控制列表（ACL）的安全性用于所有用户可能尝试执行的连接、查询和其他操作。还支持 MySQL 客户端和服务器之间的 SSL 加密连接。这里讨论的许多概念并不特定于 MySQL；相同的一般思想适用于几乎所有应用程序。

运行 MySQL 时，请遵循以下准则：

+   **绝对不要让任何人（除了 MySQL `root`帐户）访问`mysql`系统数据库中的`user`表！** 这是至关重要的。

+   了解 MySQL 访问权限系统的工作原理（参见 Section 8.2, “Access Control and Account Management”）。使用`GRANT`和`REVOKE`语句控制对 MySQL 的访问。不要授予比必要更多的权限。永远不要向所有主机授予权限。

    检查清单：

    +   尝试`mysql -u root`。如果您能够成功连接到服务器而不需要输入密码，任何人都可以以 MySQL `root`用户的身份连接到您的 MySQL 服务器并具有完全权限！查看 MySQL 安装说明，特别注意有关设置`root`密码的信息。参见 Section 2.9.4, “Securing the Initial MySQL Account”。

    +   使用`SHOW GRANTS`语句检查哪些帐户具有访问权限。然后使用`REVOKE`语句删除那些不必要的权限。

+   不要在数据库中存储明文密码。如果您的计算机受到入侵，入侵者可以获取完整的密码列表并使用它们。相反，使用`SHA2()`或其他单向哈希函数并存储哈希值。

    为了防止使用彩虹表进行密码恢复，不要在明文密码上使用这些函数；相反，选择一些字符串作为盐，并使用哈希(hash(password)+salt)值。

+   假设所有密码都将受到使用已知密码列表进行自动破解尝试以及使用关于您的公开信息进行有针对性猜测的影响。不要选择由容易破解或猜测的项目组成的密码，如字典词、专有名词、体育队名、首字母缩写或众所周知的短语，特别是如果它们与您相关。如果这些以可预测方式使用，则大写字母、数字替换和添加以及特殊字符也无济于事。也不要选择您在任何地方看到过的密码或其变体，即使它被作为强密码的示例呈现。

    相反，选择尽可能长且不可预测的密码。这并不意味着组合需要是难以记住和重现的随机字符串，尽管如果您有例如可以生成和填充这样的密码并安全存储它们的密码管理软件，这是一个很好的方法。包含多个单词的短语易于创建、记住和重现，并且比典型用户选择的由单个修改过的单词或可预测字符序列组成的密码安全得多。要创建一个安全的短语密码，请确保其中的单词和其他项目不是已知短语或引语，不按可预测顺序出现，并且最好彼此之间没有任何先前关系。

+   投资于防火墙。这可以保护您免受任何软件中至少 50%的各种利用。将 MySQL 放在防火墙后面或者在一个非军事区（DMZ）中。

    检查清单：

    +   尝试使用诸如`nmap`之类的工具从互联网扫描您的端口。MySQL 默认使用端口 3306。这个端口不应该从不受信任的主机访问。作为检查您的 MySQL 端口是否开放的简单方法，尝试在某个远程机器上运行以下命令，其中*`server_host`*是您的 MySQL 服务器运行的主机的主机名或 IP 地址：

        ```sql
        $> telnet *server_host* 3306
        ```

        如果**telnet**挂起或连接被拒绝，则端口被阻止，这正是您希望的。如果您获得一个连接和一些垃圾字符，则端口是开放的，并且应该在您的防火墙或路由器上关闭，除非您真的有充分理由保持其开放。

+   访问 MySQL 的应用程序不应信任用户输入的任何数据，并且应使用适当的防御性编程技术编写。参见第 8.1.7 节，“客户端编程安全指南”。

+   不要在互联网上传输明文（未加密）数据。这些信息对于所有有时间和能力拦截并将其用于自己目的的人都是可访问的。相反，使用诸如 SSL 或 SSH 之类的加密协议。MySQL 支持内部 SSL 连接。另一种技术是使用 SSH 端口转发来创建一个加密（和压缩）通信隧道。

+   学会使用**tcpdump**和**strings**工具。在大多数情况下，您可以通过发出类似以下命令的命令来检查 MySQL 数据流是否未加密：

    ```sql
    $> tcpdump -l -i eth0 -w - src or dst port 3306 | strings
    ```

    这在 Linux 下运行，并且应该在其他系统下进行小的修改后也能运行。

    警告

    如果您看不到明文数据，这并不总是意味着信息实际上是加密的。如果您需要高安全性，请咨询安全专家。
