# 10.2.1 优化 SELECT 语句

> 原文：[`dev.mysql.com/doc/refman/8.0/en/select-optimization.html`](https://dev.mysql.com/doc/refman/8.0/en/select-optimization.html)

10.2.1.1 WHERE 子句优化

10.2.1.2 范围优化

10.2.1.3 索引合并优化

10.2.1.4 哈希连接优化

10.2.1.5 引擎条件下推优化

10.2.1.6 索引条件下推优化

10.2.1.7 嵌套循环连接算法

10.2.1.8 嵌套连接优化

10.2.1.9 外连接优化

10.2.1.10 外连接简化

10.2.1.11 多范围读取优化

10.2.1.12 块嵌套循环和批量键访问连接

10.2.1.13 条件过滤

10.2.1.14 常量折叠优化

10.2.1.15 IS NULL 优化

10.2.1.16 ORDER BY 优化

10.2.1.17 GROUP BY 优化

10.2.1.18 DISTINCT 优化

10.2.1.19 LIMIT 查询优化

10.2.1.20 函数调用优化

10.2.1.21 窗口函数优化

10.2.1.22 行构造表达式优化

10.2.1.23 避免全表扫描

查询以`SELECT`语句的形式在数据库中执行所有查找操作。调优这些语句是首要任务，无论是为了实现动态网页的亚秒响应时间，还是为了缩短生成大型隔夜报告的时间。

除了`SELECT`语句外，对查询的调优技术也适用于诸如`CREATE TABLE...AS SELECT`、`INSERT INTO...SELECT`以及`DELETE`语句中的`WHERE`子句。这些语句有额外的性能考虑，因为它们将写操作与面向读取的查询操作结合在一起。

NDB Cluster 支持连接下推优化，其中符合条件的连接完整地发送到 NDB Cluster 数据节点，可以在这些节点之间分发并并行执行。有关此优化的更多信息，请参阅 Conditions for NDB pushdown joins。

优化查询的主要考虑因素包括：

+   要使慢`SELECT ... WHERE`查询更快，首先要检查的是是否可以添加索引。在`WHERE`子句中设置索引，以加快评估、过滤和最终检索结果。为了避免浪费磁盘空间，构建一小组索引，可以加速应用程序中使用的许多相关查询。

    索引对于引用不同表的查询特别重要，使用诸如连接和外键等功能。您可以使用`EXPLAIN`语句确定哪些索引用于`SELECT`。请参阅 Section 10.3.1，“MySQL 如何使用索引”和 Section 10.8.1，“使用 EXPLAIN 优化查询”。

+   隔离和调整查询的任何部分，例如需要大量时间的函数调用。根据查询的结构，函数可能会为结果集中的每一行调用一次，甚至为表中的每一行调用一次，从而极大地放大任何低效性。

+   尽量减少查询中的全表扫描次数，特别是对于大表。

+   使用`ANALYZE TABLE`语句定期更新表统计信息，以便优化器具有构建高效执行计划所需的信息。

+   了解针对每个表的存储引擎特定的调整技术、索引技术和配置参数。`InnoDB`和`MyISAM`都有一套指导原则，用于启用和维持查询的高性能。有关详细信息，请参阅 Section 10.5.6，“优化 InnoDB 查询”和 Section 10.6.1，“优化 MyISAM 查询”。

+   您可以使用 Section 10.5.3，“优化 InnoDB 只读事务”中的技术，为`InnoDB`表优化单个查询事务。

+   避免以使其难以理解的方式转换查询，特别是如果优化器自动执行了一些相同的转换。

+   如果性能问题不容易通过基本准则之一解决，请通过阅读`EXPLAIN`计划的内部细节并调整您的索引、`WHERE`子句、连接子句等来调查特定查询。 （当您达到一定的专业水平时，阅读`EXPLAIN`计划可能是每个查询的第一步。）

+   调整 MySQL 用于缓存的内存区域的大小和属性。通过有效利用`InnoDB` 缓冲池、`MyISAM` 关键字缓存和 MySQL 查询缓存，重复查询会更快运行，因为第二次及以后的结果是从内存中检索的。

+   即使使用缓存内存区域运行快速查询，您仍然可以进一步优化，使其需要更少的缓存内存，从而使您的应用程序更具可扩展性。可扩展性意味着您的应用程序可以处理更多同时用户、更大请求等，而不会出现性能大幅下降。

+   处理锁定问题，其中您的查询速度可能会受到其他会话同时访问表的影响。
