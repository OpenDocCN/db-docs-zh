# 10.1 优化概述

> 原文：[`dev.mysql.com/doc/refman/8.0/en/optimize-overview.html`](https://dev.mysql.com/doc/refman/8.0/en/optimize-overview.html)

数据库性能取决于数据库级别的几个因素，例如表、查询和配置设置。这些软件构造在硬件级别导致 CPU 和 I/O 操作，您必须尽量减少并尽可能高效地执行。在处理数据库性能时，您首先学习软件方面的高级规则和指南，并使用挂钟时间来衡量性能。随着您成为专家，您将了解更多内部发生的事情，并开始测量诸如 CPU 周期和 I/O 操作之类的内容。

典型用户的目标是在现有软件和硬件配置中获得最佳的数据库性能。高级用户寻求改进 MySQL 软件本身的机会，或者开发自己的存储引擎和硬件设备，以扩展 MySQL 生态系统。

+   在数据库级别进行优化

+   在硬件级别进行优化

+   平衡可移植性和性能

### 在数据库级别进行优化

使数据库应用程序快速的最重要因素是其基本设计：

+   表是否结构良好？特别是，列是否具有正确的数据类型，每个表是否具有适合工作类型的适当列？例如，频繁更新的应用程序通常有许多列较少的表，而分析大量数据的应用程序通常有少量列较多的表。

+   是否有正确的索引以使查询高效？

+   您是否为每个表使用适当的存储引擎，并充分利用您使用的每个存储引擎的优势和特性？特别是，选择事务性存储引擎如 `InnoDB` 或非事务性存储引擎如 `MyISAM` 对性能和可伸缩性非常重要。

    注意

    `InnoDB` 是新表的默认存储引擎。实际上，高级的 `InnoDB` 性能特性意味着 `InnoDB` 表通常比简单的 `MyISAM` 表性能更好，特别是对于繁忙的数据库。

+   每个表是否使用适当的行格式？此选择还取决于表使用的存储引擎。特别是，压缩表使用更少的磁盘空间，因此需要更少的磁盘 I/O 来读取和写入数据。压缩适用于所有类型的工作负载，包括 `InnoDB` 表和只读 `MyISAM` 表。

+   应用程序是否使用适当的锁定策略？例如，尽可能允许共享访问，以便数据库操作可以并发运行，并在适当时请求独占访问，以便关键操作获得最高优先级。再次强调，存储引擎的选择非常重要。`InnoDB`存储引擎处理大部分锁定问题而无需你的参与，从而实现数据库更好的并发性，并减少对代码的实验和调整量。

+   所有用于缓存的内存区域大小是否正确？也就是说，足够大以容纳频繁访问的数据，但不要太大以超载物理内存并导致分页。要配置的主要内存区域是`InnoDB`缓冲池和`MyISAM`关键缓存。

### 在硬件级别进行优化

任何数据库应用程序最终都会受到硬件限制的影响，随着数据库变得越来越繁忙。数据库管理员必须评估是否可能调整应用程序或重新配置服务器以避免这些瓶颈，或者是否需要更多的硬件资源。系统瓶颈通常来自以下来源：

+   磁盘寻道。磁盘找到一段数据需要时间。现代磁盘，这个平均时间通常低于 10ms，因此理论上我们可以每秒做大约 100 次寻道。这个时间随着新磁盘的推出而缓慢改善，对于单个表来说很难优化。优化寻道时间的方法是将数据分布到多个磁盘上。

+   磁盘读写。当磁盘处于正确位置时，我们需要读取或写入数据。现代磁盘，一个磁盘至少提供 10-20MB/s 的吞吐量。这比寻道更容易优化，因为你可以同时从多个磁盘并行读取。

+   CPU 周期。当数据在主内存中时，我们必须处理它以获得结果。与内存量相比，拥有大表是最常见的限制因素。但对于小表，速度通常不是问题。

+   内存带宽。当 CPU 需要的数据超过 CPU 缓存容量时，主内存带宽成为瓶颈。对于大多数系统来说，这是一个不常见的瓶颈，但需要注意。

### 平衡便携性和性能

要在便携式 MySQL 程序中使用面向性能的 SQL 扩展，可以将 MySQL 特定关键字包装在`/*! */`注释分隔符内的语句中。其他 SQL 服务器会忽略注释的关键字。有关编写注释的信息，请参阅第 11.7 节“注释”。
