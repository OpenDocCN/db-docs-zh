# 11.1.1 字符串文字

> 原文：[`dev.mysql.com/doc/refman/8.0/en/string-literals.html`](https://dev.mysql.com/doc/refman/8.0/en/string-literals.html)

字符串是一系列字节或字符，包含在单引号（`'`）或双引号（`"`）字符之间。例子：

```sql
'a string'
"another string"
```

相邻的引用字符串会被连接成一个单独的字符串。以下行是等效的：

```sql
'a string'
'a' ' ' 'string'
```

如果启用了`ANSI_QUOTES` SQL 模式，则字符串文字只能在单引号内引用，因为在双引号内引用的字符串会被解释为标识符。

二进制字符串是一串字节。每个二进制字符串都有一个名为`binary`的字符集和排序规则。非二进制字符串是一串字符。它具有不同于`binary`的字符集和与字符集兼容的排序规则。

对于这两种类型的字符串，比较是基于字符串单元的数值。对于二进制字符串，单元是字节；比较使用数值字节值。对于非二进制字符串，单元是字符，一些字符集支持多字节字符；比较使用数值字符编码值。字符编码排序是字符串排序规则的一个函数。（有关更多信息，请参见第 12.8.5 节，“二进制排序与 _bin 排序的比较”。）

注意

在**mysql**客户端中，二进制字符串显示为十六进制表示，取决于`--binary-as-hex`的值。有关该选项的更多信息，请参见第 6.5.1 节，“mysql — MySQL 命令行客户端”。

字符串文字可能具有可选的字符集引导符和`COLLATE`子句，以指定它作为使用特定字符集和排序规则的字符串：

```sql
[_*charset_name*]'*string*' [COLLATE *collation_name*]
```

例子：

```sql
SELECT _latin1'*string*';
SELECT _binary'*string*';
SELECT _utf8mb4'*string*' COLLATE utf8mb4_danish_ci;
```

您可以使用`N'*`literal`*'`（或`n'*`literal`*'`）来创建一个使用国家字符集的字符串。这些语句是等效的：

```sql
SELECT N'some text';
SELECT n'some text';
SELECT _utf8'some text';
```

有关这些字符串语法形式的信息，请参见第 12.3.7 节，“国家字符集”和第 12.3.8 节，“字符集引导符”。

在字符串中，除非启用了`NO_BACKSLASH_ESCAPES` SQL 模式，否则某些序列具有特殊含义。这些序列以反斜杠（`\`）开头，称为*转义字符*。MySQL 识别表 11.1，“特殊字符转义序列”中显示的转义序列。对于所有其他转义序列，反斜杠将被忽略。也就是说，转义字符被解释为未转义。例如，`\x`就是`x`。这些序列区分大小写。例如，`\b`被解释为退格，但`\B`被解释为`B`。转义处理根据`character_set_connection`系统变量指示的字符集进行。即使对于由指示不同字符集的引导符引导的字符串，也是如此，如第 12.3.6 节，“字符字符串文字的字符集和排序规则”中所讨论的。

**表 11.1 特殊字符转义序列**

| 转义序列 | 序列表示的字符 |
| --- | --- |
| `\0` | ASCII NUL（`X'00'`）字符 |
| `\'` | 单引号（`'`）字符 |
| `\"` | 双引号（`"`）字符 |
| `\b` | 退格字符 |
| `\n` | 换行（换行）字符 |
| `\r` | 回车字符 |
| `\t` | 制表符字符 |
| `\Z` | ASCII 26（Control+Z）；请参阅表后的注释 |
| `\\` | 反斜杠（`\`）字符 |
| `\%` | `%`字符；请参阅表后的注释 |
| `\_` | 下划线字符；请参阅表后的注释 |
| 转义序列 | 序列表示的字符 |

ASCII 26 字符可以编码为`\Z`，以便您解决 Windows 上 ASCII 26 代表文件结尾的问题。如果文件中有 ASCII 26，则在尝试使用`mysql *`db_name`* < *`file_name`*`时会出现问题。

`\%`和`\_`序列用于在模式匹配上下文中搜索`%`和`_`的字面实例，否则它们将被解释为通配符字符。请参阅第 14.8.1 节，“字符串比较函数和运算符”中的`LIKE`运算符的描述。如果在模式匹配上下文之外使用`\%`或`\_`，它们将被解释为字符串`\%`和`\_`，而不是`%`和`_`。

有几种方法可以在字符串中包含引号字符：

+   在用`'`引用的字符串中的`'`可以写为`''`。

+   在用`"`引用的字符串中的`"`可以写为`""`。

+   通过转义字符（`\`）在引号字符之前加上转义字符。

+   在用`"`引用的字符串中的`'`不需要特殊处理，也不需要加倍或转义。同样，用`'`引用的字符串中的`"`也不需要特殊处理。

以下`SELECT`语句演示了引用和转义的工作方式：

```sql
mysql> SELECT 'hello', '"hello"', '""hello""', 'hel''lo', '\'hello';
+-------+---------+-----------+--------+--------+
| hello | "hello" | ""hello"" | hel'lo | 'hello |
+-------+---------+-----------+--------+--------+

mysql> SELECT "hello", "'hello'", "''hello''", "hel""lo", "\"hello";
+-------+---------+-----------+--------+--------+
| hello | 'hello' | ''hello'' | hel"lo | "hello |
+-------+---------+-----------+--------+--------+

mysql> SELECT 'This\nIs\nFour\nLines';
+--------------------+
| This
Is
Four
Lines |
+--------------------+

mysql> SELECT 'disappearing\ backslash';
+------------------------+
| disappearing backslash |
+------------------------+
```

要将二进制数据插入字符串列（如`BLOB`列），你应该用转义序列表示某些字符。反斜杠（`\`）和用于引用字符串的引号字符必须转义。在某些客户端环境中，可能还需要转义`NUL`或 Control+Z。**mysql**客户端如果未转义包含`NUL`字符的引用字符串，则会截断它们，如果未转义，则 Control+Z 可能被视为 Windows 上的 END-OF-FILE。有关表示每个字符的转义序列，请参见表 11.1，“特殊字符转义序列”。

在编写应用程序时，任何可能包含这些特殊字符的字符串在用作发送到 MySQL 服务器的 SQL 语句中的数据值之前必须正确转义。你可以通过两种方式实现这一点：

+   使用一个函数处理字符串，转义特殊字符。在 C 程序中，你可以使用`mysql_real_escape_string_quote()` C API 函数来转义字符。参见 mysql_real_escape_string_quote()。在构造其他 SQL 语句的 SQL 语句中，你可以使用`QUOTE()`函数。Perl DBI 接口提供了一个`quote`方法，将特殊字符转换为适当的转义序列。参见第 31.9 节，“MySQL Perl API”。其他语言接口可能提供类似的功能。

+   作为显式转义特殊字符的替代方案，许多 MySQL API 提供了一个占位符功能，使你能够在语句字符串中插入特殊标记，然后在发出语句时将数据值绑定到它们。在这种情况下，API 会为你处理值中的特殊字符的转义。
