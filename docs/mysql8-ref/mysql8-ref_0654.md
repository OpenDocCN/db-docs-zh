# 11.1.5 位值字面量

> 原文：[`dev.mysql.com/doc/refman/8.0/en/bit-value-literals.html`](https://dev.mysql.com/doc/refman/8.0/en/bit-value-literals.html)

位值字面量使用`b'*`val`*'`或`0b*`val`*`表示法编写。*`val`*是使用零和一写成的二进制值。任何前导`b`的大小写不重要。前导`0b`区分大小写，不能写成`0B`。

合法的位值字面量：

```sql
b'01'
B'01'
0b01
```

非法的位值字面量：

```sql
b'2'    (2 is not a binary digit)
0B01    (0B must be written as 0b)
```

默认情况下，位值字面量是二进制字符串：

```sql
mysql> SELECT b'1000001', CHARSET(b'1000001');
+------------+---------------------+
| b'1000001' | CHARSET(b'1000001') |
+------------+---------------------+
| A          | binary              |
+------------+---------------------+
mysql> SELECT 0b1100001, CHARSET(0b1100001);
+-----------+--------------------+
| 0b1100001 | CHARSET(0b1100001) |
+-----------+--------------------+
| a         | binary             |
+-----------+--------------------+
```

位值字面量可以具有可选的字符集引导符和`COLLATE`子句，以将其指定为使用特定字符集和排序规则的字符串：

```sql
[_*charset_name*] b'*val*' [COLLATE *collation_name*]
```

示例：

```sql
SELECT _latin1 b'1000001';
SELECT _utf8mb4 0b1000001 COLLATE utf8mb4_danish_ci;
```

示例中使用`b'*`val`*'`表示法，但`0b*`val`*`表示法也允许引导符。有关引导符的信息，请参见第 12.3.8 节，“字符集引导符”。

在数字上下文中，MySQL 将位字面量视为整数。为确保位字面量的数字处理，请在数字上下文中使用它。实现这一点的方法包括添加 0 或使用`CAST(... AS UNSIGNED)`。例如，将位字面量分配给用户定义变量默认情况下是一个二进制字符串。要将该值分配为数字，请在数字上下文中使用它：

```sql
mysql> SET @v1 = b'1100001';
mysql> SET @v2 = b'1100001'+0;
mysql> SET @v3 = CAST(b'1100001' AS UNSIGNED);
mysql> SELECT @v1, @v2, @v3;
+------+------+------+
| @v1  | @v2  | @v3  |
+------+------+------+
| a    |   97 |   97 |
+------+------+------+
```

空位值（`b''`）评估为零长度的二进制字符串。转换为数字后，它产生 0：

```sql
mysql> SELECT CHARSET(b''), LENGTH(b'');
+--------------+-------------+
| CHARSET(b'') | LENGTH(b'') |
+--------------+-------------+
| binary       |           0 |
+--------------+-------------+
mysql> SELECT b''+0;
+-------+
| b''+0 |
+-------+
|     0 |
+-------+
```

位值表示法方便指定要分配给`BIT`列的值：

```sql
mysql> CREATE TABLE t (b BIT(8));
mysql> INSERT INTO t SET b = b'11111111';
mysql> INSERT INTO t SET b = b'1010';
mysql> INSERT INTO t SET b = b'0101';
```

结果集中的位值以二进制形式返回，可能显示不佳。要将位值转换为可打印形式，请在数字上下文中使用它或使用诸如`BIN()`或`HEX()`之类的转换函数。转换后的值中不显示高阶 0 位。

```sql
mysql> SELECT b+0, BIN(b), OCT(b), HEX(b) FROM t;
+------+----------+--------+--------+
| b+0  | BIN(b)   | OCT(b) | HEX(b) |
+------+----------+--------+--------+
|  255 | 11111111 | 377    | FF     |
|   10 | 1010     | 12     | A      |
|    5 | 101      | 5      | 5      |
+------+----------+--------+--------+
```

对于位字面量，位操作被视为数字上下文，但在 MySQL 8.0 及更高版本中，位操作允许数字或二进制字符串参数。要明确指定位字面量的二进制字符串上下文，请至少在一个参数中使用`_binary`引导符：

```sql
mysql> SET @v1 = b'000010101' | b'000101010';
mysql> SET @v2 = _binary b'000010101' | _binary b'000101010';
mysql> SELECT HEX(@v1), HEX(@v2);
+----------+----------+
| HEX(@v1) | HEX(@v2) |
+----------+----------+
| 3F       | 003F     |
+----------+----------+
```

显示的结果对于位操作来说看起来相似，但没有`_binary`的结果是一个`BIGINT`值，而有`_binary`的结果是一个二进制字符串。由于结果类型的差异，显示的值不同：转换后的值中不显示高阶 0 位。
