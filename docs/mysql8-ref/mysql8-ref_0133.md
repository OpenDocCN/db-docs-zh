> 原文：[`dev.mysql.com/doc/refman/8.0/en/pattern-matching.html`](https://dev.mysql.com/doc/refman/8.0/en/pattern-matching.html)

#### 5.3.4.7 模式匹配

MySQL 提供标准 SQL 模式匹配以及一种基于扩展正则表达式的模式匹配形式，类似于 Unix 实用程序（如**vi**，**grep**和**sed**）中使用的形式。

SQL 模式匹配使您可以使用`_`匹配任意单个字符和`%`匹配任意数量的字符（包括零个字符）。在 MySQL 中，默认情况下，SQL 模式是不区分大小写的。这里显示了一些示例。在使用 SQL 模式时，请不要使用`=`或`<>`。请改用`LIKE`或`NOT LIKE`比较运算符。

要查找以`b`开头的名称：

```sql
mysql> SELECT * FROM pet WHERE name LIKE 'b%';
+--------+--------+---------+------+------------+------------+
| name   | owner  | species | sex  | birth      | death      |
+--------+--------+---------+------+------------+------------+
| Buffy  | Harold | dog     | f    | 1989-05-13 | NULL       |
| Bowser | Diane  | dog     | m    | 1989-08-31 | 1995-07-29 |
+--------+--------+---------+------+------------+------------+
```

要查找以`fy`结尾的名称：

```sql
mysql> SELECT * FROM pet WHERE name LIKE '%fy';
+--------+--------+---------+------+------------+-------+
| name   | owner  | species | sex  | birth      | death |
+--------+--------+---------+------+------------+-------+
| Fluffy | Harold | cat     | f    | 1993-02-04 | NULL  |
| Buffy  | Harold | dog     | f    | 1989-05-13 | NULL  |
+--------+--------+---------+------+------------+-------+
```

要查找包含`w`的名称：

```sql
mysql> SELECT * FROM pet WHERE name LIKE '%w%';
+----------+-------+---------+------+------------+------------+
| name     | owner | species | sex  | birth      | death      |
+----------+-------+---------+------+------------+------------+
| Claws    | Gwen  | cat     | m    | 1994-03-17 | NULL       |
| Bowser   | Diane | dog     | m    | 1989-08-31 | 1995-07-29 |
| Whistler | Gwen  | bird    | NULL | 1997-12-09 | NULL       |
+----------+-------+---------+------+------------+------------+
```

要查找包含正好五个字符的名称，请使用五个`_`模式字符的实例：

```sql
mysql> SELECT * FROM pet WHERE name LIKE '_____';
+-------+--------+---------+------+------------+-------+
| name  | owner  | species | sex  | birth      | death |
+-------+--------+---------+------+------------+-------+
| Claws | Gwen   | cat     | m    | 1994-03-17 | NULL  |
| Buffy | Harold | dog     | f    | 1989-05-13 | NULL  |
+-------+--------+---------+------+------------+-------+
```

MySQL 提供的另一种模式匹配类型使用扩展正则表达式。当您测试此类型模式的匹配时，请使用`REGEXP_LIKE()`函数（或`REGEXP`或`RLIKE`运算符，它们是`REGEXP_LIKE()`的同义词）。

以下列表描述了扩展正则表达式的一些特征：

+   `.`匹配任意单个字符。

+   字符类`[...]`匹配括号内的任何字符。例如，`[abc]`匹配`a`，`b`或`c`。要命名一系列字符，请使用短划线。`[a-z]`匹配任何字母，而`[0-9]`匹配任何数字。

+   `*`匹配其前面的内容的零个或多个实例。例如，`x*`匹配任意数量的`x`字符，`[0-9]*`匹配任意数量的数字，`.*`匹配任意数量的任何内容。

+   如果正则表达式模式匹配值的任何位置，则正则表达式模式匹配成功。（这与`LIKE`模式匹配不同，后者仅在模式完全匹配值时才成功。）

+   要锚定模式，使其必须匹配值的开头或结尾，请在模式的开头使用`^`或在结尾使用`$`。

为了演示扩展正则表达式的工作原理，先前显示的`LIKE`查询在这里重新编写为使用`REGEXP_LIKE()`。

要查找以`b`开头的名称，请使用`^`匹配名称的开头：

```sql
mysql> SELECT * FROM pet WHERE REGEXP_LIKE(name, '^b');
+--------+--------+---------+------+------------+------------+
| name   | owner  | species | sex  | birth      | death      |
+--------+--------+---------+------+------------+------------+
| Buffy  | Harold | dog     | f    | 1989-05-13 | NULL       |
| Bowser | Diane  | dog     | m    | 1979-08-31 | 1995-07-29 |
+--------+--------+---------+------+------------+------------+
```

要强制正则表达式比较区分大小写，请使用区分大小写的排序规则，或使用`BINARY`关键字使其中一个字符串成为二进制字符串，或指定`c`匹配控制字符。每个查询仅匹配名称开头的小写`b`：

```sql
SELECT * FROM pet WHERE REGEXP_LIKE(name, '^b' COLLATE utf8mb4_0900_as_cs);
SELECT * FROM pet WHERE REGEXP_LIKE(name, BINARY '^b');
SELECT * FROM pet WHERE REGEXP_LIKE(name, '^b', 'c');
```

要查找以`fy`结尾的名称，请使用`$`来匹配名称的结尾：

```sql
mysql> SELECT * FROM pet WHERE REGEXP_LIKE(name, 'fy$');
+--------+--------+---------+------+------------+-------+
| name   | owner  | species | sex  | birth      | death |
+--------+--------+---------+------+------------+-------+
| Fluffy | Harold | cat     | f    | 1993-02-04 | NULL  |
| Buffy  | Harold | dog     | f    | 1989-05-13 | NULL  |
+--------+--------+---------+------+------------+-------+
```

要查找包含`w`的名称，请使用此查询：

```sql
mysql> SELECT * FROM pet WHERE REGEXP_LIKE(name, 'w');
+----------+-------+---------+------+------------+------------+
| name     | owner | species | sex  | birth      | death      |
+----------+-------+---------+------+------------+------------+
| Claws    | Gwen  | cat     | m    | 1994-03-17 | NULL       |
| Bowser   | Diane | dog     | m    | 1989-08-31 | 1995-07-29 |
| Whistler | Gwen  | bird    | NULL | 1997-12-09 | NULL       |
+----------+-------+---------+------+------------+------------+
```

因为正则表达式模式匹配的是值中的任何位置，所以在前面的查询中，不需要在模式的两侧放置通配符来使其匹配整个值，这与 SQL 模式不同。

要查找恰好包含五个字符的名称，请使用`^`和`$`来匹配名称的开头和结尾，并在中间使用五个`.`的实例：

```sql
mysql> SELECT * FROM pet WHERE REGEXP_LIKE(name, '^.....$');
+-------+--------+---------+------+------------+-------+
| name  | owner  | species | sex  | birth      | death |
+-------+--------+---------+------+------------+-------+
| Claws | Gwen   | cat     | m    | 1994-03-17 | NULL  |
| Buffy | Harold | dog     | f    | 1989-05-13 | NULL  |
+-------+--------+---------+------+------------+-------+
```

使用`{*n*}`（“重复-*n*-次”)操作符，你也可以编写前面的查询：

```sql
mysql> SELECT * FROM pet WHERE REGEXP_LIKE(name, '^.{5}$');
+-------+--------+---------+------+------------+-------+
| name  | owner  | species | sex  | birth      | death |
+-------+--------+---------+------+------------+-------+
| Claws | Gwen   | cat     | m    | 1994-03-17 | NULL  |
| Buffy | Harold | dog     | f    | 1989-05-13 | NULL  |
+-------+--------+---------+------+------------+-------+
```

有关正则表达式语法的更多信息，请参见第 14.8.2 节，“正则表达式”。
