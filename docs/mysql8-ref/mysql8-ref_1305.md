> 原文：[`dev.mysql.com/doc/refman/8.0/en/dynamic-format.html`](https://dev.mysql.com/doc/refman/8.0/en/dynamic-format.html)

#### 18.2.3.2 动态表特性

如果`MyISAM`表包含任何可变长度列（`VARCHAR`、`VARBINARY`、`BLOB`或`TEXT`），或者表是使用`ROW_FORMAT=DYNAMIC`表选项创建的，则使用动态存储格式。

动态格式比静态格式稍微复杂，因为每行都有一个标头，指示其长度。当由于更新而使行变长时，行可能会变得碎片化（存储在非连续的片段中）。

您可以使用`OPTIMIZE TABLE`或**myisamchk -r**来对表进行碎片整理。如果您在一个表中频繁访问或更改固定长度列，并且该表还包含一些可变长度列，那么将可变长度列移动到其他表中以避免碎片化可能是一个好主意。

动态格式表具有以下特点：

+   所有字符串列都是动态的，除了长度小于四的列。

+   每行前面都有一个位图，指示哪些列包含空字符串（对于字符串列）或零（对于数值列）。这不包括包含`NULL`值的列。如果字符串列在去除尾随空格后长度为零，或者数值列的值为零，则在位图中标记并不保存到磁盘。非空字符串保存为长度字节加上字符串内容。

+   `NULL`列需要额外的空间来记录它们的值是否为`NULL`。每个`NULL`列额外占用一位，向上取整到最近的字节。

+   比固定长度表通常需要更少的磁盘空间。

+   每行只使用所需的空间。但是，如果一行变得更大，它将被分成所需的碎片，导致行碎片化。例如，如果更新了一行的信息，使行长度增加，那么该行将变得碎片化。在这种情况下，您可能需要定期运行`OPTIMIZE TABLE`或**myisamchk -r**来提高性能。使用**myisamchk -ei**获取表统计信息。

+   在崩溃后更难重建比静态格式表，因为行可能会分成许多片段，而且链接（片段）可能丢失。

+   动态大小行的预期行长度使用以下表达式计算：

    ```sql
    3
    + (*number of columns* + 7) / 8
    + (*number of char columns*)
    + (*packed size of numeric columns*)
    + (*length of strings*)
    + (*number of NULL columns* + 7) / 8
    ```

    每个链接都会有 6 个字节的惩罚。每当更新导致行的扩大时，就会链接一个动态行。每个新链接至少有 20 个字节，所以下一个扩大可能会放在同一个链接中。如果不是，就会创建另一个链接。你可以使用**myisamchk -ed**来查找链接的数量。所有链接可以通过`OPTIMIZE TABLE`或**myisamchk -r**来移除。
