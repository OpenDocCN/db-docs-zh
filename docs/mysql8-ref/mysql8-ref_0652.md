# 11.1.3 日期和时间文字

> 原文：[`dev.mysql.com/doc/refman/8.0/en/date-and-time-literals.html`](https://dev.mysql.com/doc/refman/8.0/en/date-and-time-literals.html)

+   标准 SQL 和 ODBC 日期和时间文字

+   日期和时间上下文中的字符串和数字文字

日期和时间值可以用几种格式表示，例如带引号的字符串或数字，具体取决于值的确切类型和其他因素。例如，在 MySQL 期望日期的上下文中，它会将 `'2015-07-21'`、`'20150721'` 和 `20150721` 中的任何一个解释为日期。

本节描述了日期和时间文字的可接受格式。有关时间数据类型的更多信息，例如允许值的范围，请参阅 第 13.2 节，“日期和时间数据类型”。

#### 标准 SQL 和 ODBC 日期和时间文字

标准 SQL 要求使用类型关键字和字符串指定时间文字。关键字和字符串之间的空格是可选的。

```sql
DATE '*str*'
TIME '*str*'
TIMESTAMP '*str*'
```

MySQL 识别但不像标准 SQL 那样需要类型关键字。要符合标准的应用程序应该为时间文字包含类型关键字。

MySQL 也识别与标准 SQL 语法对应的 ODBC 语法：

```sql
{ d '*str*' }
{ t '*str*' }
{ ts '*str*' }
```

MySQL 使用类型关键字和 ODBC 结构来生成 `DATE`、`TIME` 和 `DATETIME` 值，包括指定的尾部分数秒部分。`TIMESTAMP` 语法在 MySQL 中生成一个 `DATETIME` 值，因为 `DATETIME` 的范围更接近标准 SQL `TIMESTAMP` 类型，其年份范围从 `0001` 到 `9999`。（MySQL `TIMESTAMP` 的年份范围是 `1970` 到 `2038`。）

#### 日期和时间上下文中的字符串和数字文字

MySQL 识别以这些格式表示的 `DATE` 值：

+   作为字符串，格式为`'*`YYYY-MM-DD`*'`或`'*`YY-MM-DD`*'`。允许使用“宽松”语法，但已被弃用：任何标点字符都可以用作日期部分之间的分隔符。例如，`'2012-12-31'`，`'2012/12/31'`，`'2012¹²³¹'`和`'2012@12@31'`是等效的。从 MySQL 8.0.29 开始，使用除了破折号（`-`）作为分隔符之外的任何字符会引发警告，如下所示：

    ```sql
    mysql> SELECT DATE'2012@12@31';
    +------------------+
    | DATE'2012@12@31' |
    +------------------+
    | 2012-12-31       |
    +------------------+
    1 row in set, 1 warning (0.00 sec)

    mysql> SHOW WARNINGS\G
    *************************** 1\. row ***************************
      Level: Warning
       Code: 4095
    Message: Delimiter '@' in position 4 in datetime value '2012@12@31' at row 1 is
    deprecated. Prefer the standard '-'. 1 row in set (0.00 sec)
    ```

+   作为没有分隔符的字符串，格式为`'*`YYYYMMDD`*'`或`'*`YYMMDD`*'`，前提是字符串作为日期是有意义的。例如，`'20070523'`和`'070523'`被解释为`'2007-05-23'`，但`'071332'`是非法的（具有无意义的月份和日期部分），变为`'0000-00-00'`。

+   作为数字，格式为*`YYYYMMDD`*或*`YYMMDD`*，前提是数字作为日期是有意义的。例如，`19830905`和`830905`被解释为`'1983-09-05'`。

MySQL 在这些格式中识别`DATETIME`和`TIMESTAMP`值：

+   作为字符串，格式为`'*`YYYY-MM-DD hh:mm:ss`*'`或`'*`YY-MM-DD hh:mm:ss`*'`。MySQL 还允许在此处使用“宽松”语法，尽管这已被弃用：任何标点字符都可以用作日期部分或时间部分之间的分隔符。例如，`'2012-12-31 11:30:45'`，`'2012¹²³¹ 11+30+45'`，`'2012/12/31 11*30*45'`和`'2012@12@31 11³⁰⁴⁵'`是等效的。从 MySQL 8.0.29 开始，在这些值中使用除了破折号（`-`）用于日期部分和冒号（`:`）用于时间部分之外的任何字符作为分隔符会引发警告，如下所示：

    ```sql
    mysql> SELECT TIMESTAMP'2012¹²³¹ 11*30*45';
    +--------------------------------+
    | TIMESTAMP'2012¹²³¹ 11*30*45' |
    +--------------------------------+
    | 2012-12-31 11:30:45            |
    +--------------------------------+
    1 row in set, 1 warning (0.00 sec)

    mysql> SHOW WARNINGS\G
    *************************** 1\. row ***************************
      Level: Warning
       Code: 4095
    Message: Delimiter '^' in position 4 in datetime value '2012¹²³¹ 11*30*45' at
    row 1 is deprecated. Prefer the standard '-'. 1 row in set (0.00 sec)
    ```

    日期和时间部分与小数秒部分之间唯一识别的分隔符是小数点。

    日期和时间部分可以用`T`而不是空格分隔。例如，`'2012-12-31 11:30:45'`和`'2012-12-31T11:30:45'`是等效的。

    以前，MySQL 支持日期和时间值中任意数量的前导和尾随空格字符，以及在`DATETIME`和`TIMESTAMP`值的日期和时间部分之间的空格字符。在 MySQL 8.0.29 及更高版本中，此行为已被弃用，多余的空格字符会触发警告，如下所示：

    ```sql
    mysql> SELECT TIMESTAMP'2012-12-31   11-30-45';
    +----------------------------------+
    | TIMESTAMP'2012-12-31   11-30-45' |
    +----------------------------------+
    | 2012-12-31 11:30:45              |
    +----------------------------------+
    1 row in set, 1 warning (0.00 sec)

    mysql> SHOW WARNINGS\G
    *************************** 1\. row ***************************
      Level: Warning
       Code: 4096
    Message: Delimiter ' ' in position 11 in datetime value '2012-12-31   11-30-45'
    at row 1 is superfluous and is deprecated. Please remove. 1 row in set (0.00 sec)
    ```

    从 MySQL 8.0.29 开始，当使用空格字符以外的空格字符时，会引发警告，如下所示：

    ```sql
    mysql> SELECT TIMESTAMP'2021-06-06
        '> 11:15:25';
    +--------------------------------+
    | TIMESTAMP'2021-06-06
     11:15:25'                       |
    +--------------------------------+
    | 2021-06-06 11:15:25            |
    +--------------------------------+
    1 row in set, 1 warning (0.00 sec)

    mysql> SHOW WARNINGS\G
    *************************** 1\. row ***************************
      Level: Warning
       Code: 4095
    Message: Delimiter '\n' in position 10 in datetime value '2021-06-06
    11:15:25' at row 1 is deprecated. Prefer the standard ' '.
    1 row in set (0.00 sec)
    ```

    每个时间值只会引发一次此类警告，即使分隔符、空格或两者都存在多个问题，如下面的一系列语句所示：

    ```sql
    mysql> SELECT TIMESTAMP'2012!-12-31  11:30:45';
    +----------------------------------+
    | TIMESTAMP'2012!-12-31  11:30:45' |
    +----------------------------------+
    | 2012-12-31 11:30:45              |
    +----------------------------------+
    1 row in set, 1 warning (0.00 sec)

    mysql> SHOW WARNINGS\G
    *************************** 1\. row ***************************
      Level: Warning
       Code: 4095
    Message: Delimiter '!' in position 4 in datetime value '2012!-12-31  11:30:45'
    at row 1 is deprecated. Prefer the standard '-'. 1 row in set (0.00 sec)

    mysql> SELECT TIMESTAMP'2012-12-31  11:30:45';
    +---------------------------------+
    | TIMESTAMP'2012-12-31  11:30:45' |
    +---------------------------------+
    | 2012-12-31 11:30:45             |
    +---------------------------------+
    1 row in set, 1 warning (0.00 sec)

    mysql> SHOW WARNINGS\G
    *************************** 1\. row ***************************
      Level: Warning
       Code: 4096
    Message: Delimiter ' ' in position 11 in datetime value '2012-12-31  11:30:45'
    at row 1 is superfluous and is deprecated. Please remove. 1 row in set (0.00 sec)

    mysql> SELECT TIMESTAMP'2012-12-31 11:30:45';
    +--------------------------------+
    | TIMESTAMP'2012-12-31 11:30:45' |
    +--------------------------------+
    | 2012-12-31 11:30:45            |
    +--------------------------------+
    1 row in set (0.00 sec)
    ```

+   作为没有分隔符的字符串，格式为`'*`YYYYMMDDhhmmss`*'`或`'*`YYMMDDhhmmss`*'`，前提是字符串作为日期是有意义的。例如，`'20070523091528'`和`'070523091528'`被解释为`'2007-05-23 09:15:28'`，但`'071122129015'`是非法的（具有无意义的分钟部分），变为`'0000-00-00 00:00:00'`。

+   作为*`YYYYMMDDhhmmss`*或*`YYMMDDhhmmss`*格式的数字，前提是该数字作为日期是有意义的。例如，`19830905132800`和`830905132800`被解释为`'1983-09-05 13:28:00'`。

`DATETIME`或`TIMESTAMP`值可以包括高达微秒（6 位数字）精度的尾部小数部分。小数部分应始终与其余时间部分用小数点分隔；不识别其他小数秒分隔符。有关 MySQL 中小数秒支持的信息，请参见第 13.2.6 节，“时间值中的小数秒”。

包含两位数年份值的日期是模棱两可的，因为世纪未知。MySQL 使用以下规则解释两位数年份值：

+   年份范围在`70-99`之间的值变为`1970-1999`。

+   年份范围在`00-69`之间的值变为`2000-2069`。

另请参阅第 13.2.9 节，“日期中的 2 位数年份”。

对于指定为包含日期部分分隔符的字符串值，无需为小于`10`的月份或日期值指定两位数。`'2015-6-9'`与`'2015-06-09'`相同。同样，对于指定为包含时间部分分隔符的字符串值，无需为小于`10`的小时、分钟或秒值指定两位数。`'2015-10-30 1:2:3'`与`'2015-10-30 01:02:03'`相同。

指定为数字的值应为 6、8、12 或 14 位数字长。如果数字为 8 或 14 位长，则假定为*`YYYYMMDD`*或*`YYYYMMDDhhmmss`*格式，并且年份由前 4 位数字给出。如果数字为 6 或 12 位长，则假定为*`YYMMDD`*或*`YYMMDDhhmmss`*格式，并且年份由前 2 位数字给出。长度不是这些之一的数字被解释为用前导零填充到最接近的长度。

指定为无分隔符字符串的值根据其长度进行解释。对于 8 或 14 个字符长的字符串，假定年份由前 4 个字符给出。否则，假定年份由前 2 个字符给出。字符串从左到右解释以找到年、月、日、小时、分钟和秒值，对于字符串中存在的部分。这意味着您不应使用少于 6 个字符的字符串。例如，如果您指定`'9903'`，认为代表 1999 年 3 月，MySQL 会将其转换为“零”日期值。这是因为年份和月份值为`99`和`03`，但日期部分完全缺失。但是，您可以明确指定零值表示缺失的月份或日期部分。例如，要插入值`'1999-03-00'`，请使用`'990300'`。

MySQL 识别这些格式的`TIME`值：

+   作为*`'D hh:mm:ss'`*格式的字符串。您还可以使用以下“宽松”语法之一：*`'hh:mm:ss'`*、*`'hh:mm'`*、*`'D hh:mm'`*、*`'D hh'`*或*`'ss'`*。这里*`D`*代表天数，可以取值从 0 到 34。

+   作为没有分隔符的字符串，采用*`'hhmmss'`*格式，只要它作为时间是有意义的。例如，`'101112'`被理解为`'10:11:12'`，但`'109712'`是非法的（它有一个荒谬的分钟部分），变成了`'00:00:00'`。

+   作为*`hhmmss`*格式的数字，只要它作为时间是有意义的。例如，`101112`被理解为`'10:11:12'`。还可以理解以下替代格式：*`ss`*、*`mmss`*或*`hhmmss`*。

在*`'D hh:mm:ss.fraction'`*、*`'hh:mm:ss.fraction'`*、*`'hhmmss.fraction'`*和*`hhmmss.fraction`*时间格式中识别尾随的小数秒部分，其中`fraction`是高达微秒（6 位数字）精度的小数部分。小数部分应始终用小数点与时间的其余部分分隔开；不识别其他小数秒分隔符。有关 MySQL 中小数秒支持的信息，请参见 Section 13.2.6, “Fractional Seconds in Time Values”。

对于作为包含时间部分分隔符的字符串指定的`TIME`值，不需要为小时、分钟或秒值少于`10`的两位数指定两位数。`'8:3:2'`等同于`'08:03:02'`。

从 MySQL 8.0.19 开始，您可以在将`TIMESTAMP`和`DATETIME`值插入表时指定时区偏移量。偏移量附加到日期时间文字的时间部分，没有空格，并使用用于设置`time_zone`系统变量的相同格式，以下是一些例外情况：

+   对于小时值小于 10 的情况，需要前导零。

+   值`'-00:00'`被拒绝。

+   诸如`'EET'`和`'Asia/Shanghai'`之类的时区名称不能使用；在这种情况下也不能使用`'SYSTEM'`。

插入的值不能在月份部分、日期部分或两部分中有零。从 MySQL 8.0.22 开始执行此规则，无论服务器 SQL 模式设置如何。

这个例子演示了使用不同的`time_zone`设置将带有时区偏移的日期时间值插入`TIMESTAMP`和`DATETIME`列，然后检索它们：

```sql
mysql> CREATE TABLE ts (
 ->     id INTEGER NOT NULL AUTO_INCREMENT PRIMARY KEY,
 ->     col TIMESTAMP NOT NULL
 -> ) AUTO_INCREMENT = 1;

mysql> CREATE TABLE dt (
 ->     id INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
 ->     col DATETIME NOT NULL
 -> ) AUTO_INCREMENT = 1;

mysql> SET @@time_zone = 'SYSTEM';

mysql> INSERT INTO ts (col) VALUES ('2020-01-01 10:10:10'),
 ->     ('2020-01-01 10:10:10+05:30'), ('2020-01-01 10:10:10-08:00');

mysql> SET @@time_zone = '+00:00';

mysql> INSERT INTO ts (col) VALUES ('2020-01-01 10:10:10'),
 ->     ('2020-01-01 10:10:10+05:30'), ('2020-01-01 10:10:10-08:00');

mysql> SET @@time_zone = 'SYSTEM';

mysql> INSERT INTO dt (col) VALUES ('2020-01-01 10:10:10'),
 ->     ('2020-01-01 10:10:10+05:30'), ('2020-01-01 10:10:10-08:00');

mysql> SET @@time_zone = '+00:00';

mysql> INSERT INTO dt (col) VALUES ('2020-01-01 10:10:10'),
 ->     ('2020-01-01 10:10:10+05:30'), ('2020-01-01 10:10:10-08:00');

mysql> SET @@time_zone = 'SYSTEM';

mysql> SELECT @@system_time_zone;
+--------------------+
| @@system_time_zone |
+--------------------+
| EST                |
+--------------------+

mysql> SELECT col, UNIX_TIMESTAMP(col) FROM dt ORDER BY id;
+---------------------+---------------------+
| col                 | UNIX_TIMESTAMP(col) |
+---------------------+---------------------+
| 2020-01-01 10:10:10 |          1577891410 |
| 2019-12-31 23:40:10 |          1577853610 |
| 2020-01-01 13:10:10 |          1577902210 |
| 2020-01-01 10:10:10 |          1577891410 |
| 2020-01-01 04:40:10 |          1577871610 |
| 2020-01-01 18:10:10 |          1577920210 |
+---------------------+---------------------+

mysql> SELECT col, UNIX_TIMESTAMP(col) FROM ts ORDER BY id;
+---------------------+---------------------+
| col                 | UNIX_TIMESTAMP(col) |
+---------------------+---------------------+
| 2020-01-01 10:10:10 |          1577891410 |
| 2019-12-31 23:40:10 |          1577853610 |
| 2020-01-01 13:10:10 |          1577902210 |
| 2020-01-01 05:10:10 |          1577873410 |
| 2019-12-31 23:40:10 |          1577853610 |
| 2020-01-01 13:10:10 |          1577902210 |
+---------------------+---------------------+
```

即使在插入时使用了偏移量，选择日期时间值时也不显示偏移量。

支持的偏移值范围是`-13:59`到`+14:00`，包括边界值。

包含时区偏移的日期时间文字可以作为预处理语句的参数值接受。
