# 20.7.2 流量控制

> 原文：[`dev.mysql.com/doc/refman/8.0/en/group-replication-flow-control.html`](https://dev.mysql.com/doc/refman/8.0/en/group-replication-flow-control.html)

20.7.2.1 探针和统计信息

20.7.2.2 Group Replication 限流

Group Replication 确保事务仅在组中的大多数成员接收并就同时发送的所有事务之间的相对顺序达成一致后才提交。如果组中的总写入次数超过任何成员的写入容量，则此方法效果良好。如果确实如此，并且一些成员的写入吞吐量低于其他成员，特别是低于写入成员，则这些成员可能会开始落后于写入者。

使一些成员落后于组带来一些问题后果，特别是，这些成员上的读取可能会显示非常旧的数据。根据成员落后的原因，组中的其他成员可能需要保存更多或更少的复制上下文，以便能够满足来自慢速成员的潜在数据传输请求。

然而，在复制协议中有一种机制可以避免快速成员和慢速成员之间在应用的事务方面有太大的距离。这被称为流量控制机制。它试图解决几个目标：

1.  保持成员之间足够接近，使缓冲和成员之间的去同步问题变得不那么严重；

1.  快速适应不同工作负载或组中更多写入者等不同条件；

1.  给每个成员公平分享可用写入容量；

1.  不要将吞吐量降低到绝对必要的程度以避免浪费资源。

考虑到 Group Replication 的设计，是否进行限流取决于两个工作队列：*(i)* *认证* 队列；*(ii)* 以及二进制日志 *应用程序* 队列。每当其中一个队列的大小超过用户定义的阈值时，限流机制就会被触发。只需配置：*(i)* 在认证者或应用程序级别进行流量控制，或两者都进行；以及 *(ii)* 每个队列的阈值是多少。

流量控制取决于两种基本机制：

1.  监控成员以收集有关所有组成员的吞吐量和队列大小的一些统计信息，以便对每个成员应受到的最大写入压力进行合理猜测；

1.  对于试图在每个时间点写入超出其公平份额的成员进行限流。
