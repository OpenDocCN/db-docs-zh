# 18.4.1 修复和检查 CSV 表格

> 原文：[`dev.mysql.com/doc/refman/8.0/en/se-csv-repair.html`](https://dev.mysql.com/doc/refman/8.0/en/se-csv-repair.html)

`CSV`存储引擎支持`CHECK TABLE`和`REPAIR TABLE`语句，用于验证并且在可能的情况下修复损坏的`CSV`表格。

运行`CHECK TABLE`语句时，会通过查找正确的字段分隔符、转义字段（匹配或缺失的引号）、与表定义相比的正确字段数量以及相应的`CSV`元文件的存在来检查`CSV`文件的有效性。发现的第一个无效行会导致错误。检查一个有效的表格会产生类似于以下所示的输出：

```sql
mysql> CHECK TABLE csvtest;
+--------------+-------+----------+----------+
| Table        | Op    | Msg_type | Msg_text |
+--------------+-------+----------+----------+
| test.csvtest | check | status   | OK       |
+--------------+-------+----------+----------+
```

对于损坏的表格进行检查会返回诸如以下的错误：

```sql
mysql> CHECK TABLE csvtest;
+--------------+-------+----------+----------+
| Table        | Op    | Msg_type | Msg_text |
+--------------+-------+----------+----------+
| test.csvtest | check | error    | Corrupt  |
+--------------+-------+----------+----------+
```

要修复表格，请使用`REPAIR TABLE`语句，它会尽可能从现有的`CSV`数据中复制尽可能多的有效行，然后用恢复的行替换现有的`CSV`文件。任何在损坏数据之后的行都会丢失。

```sql
mysql> REPAIR TABLE csvtest;
+--------------+--------+----------+----------+
| Table        | Op     | Msg_type | Msg_text |
+--------------+--------+----------+----------+
| test.csvtest | repair | status   | OK       |
+--------------+--------+----------+----------+
```

警告

在修复过程中，只有从`CSV`文件中第一个损坏行之前的行会被复制到新表中。从第一个损坏行到表格末尾的所有其他行都会被移除，即使是有效行也会被移除。
