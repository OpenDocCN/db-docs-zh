# 3.3 升级最佳实践

> 原文：[`dev.mysql.com/doc/refman/8.0/en/upgrade-best-practices.html`](https://dev.mysql.com/doc/refman/8.0/en/upgrade-best-practices.html)

MySQL 支持在小版本之间升级（在 LTS 系列内）和到下一个主要版本（跨 LTS 系列）。升级提供最新功能、性能和安全修复。

为了准备并确保您对最新 MySQL 版本的升级成功，我们建议遵循以下最佳实践：

+   决定升级为主要版本还是次要版本

+   决定升级类型

+   审查支持的平台

+   了解 MySQL 服务器变更

+   运行升级检查器并修复不兼容性

+   在测试环境中运行应用程序

+   基准应用程序和工作负载性能

+   并行运行两个 MySQL 版本

+   运行最终测试升级

+   检查 MySQL 备份

+   升级生产服务器

+   企业支持

### 决定升级为主要版本还是次要版本

MySQL 发布模型区分了 LTS（长期支持）和创新版本。 LTS 版本提供 8 年以上的支持，适用于生产环境。创新版本为用户提供最新功能和能力。了解更多关于[MySQL 发布模型](https://blogs.oracle.com/mysql/post/introducing-mysql-innovation-and-longterm-support-lts-versions)。

执行小版本升级很简单，而大版本升级需要在升级前进行战略规划和额外测试。这个指南对于大版本升级尤为有用。

### 决定升级类型

有三种主要的升级 MySQL 的方式，请阅读相关文档以确定哪种升级方式最适合您的情况。

+   原地升级：替换 MySQL 服务器软件包。

+   逻辑升级：从旧的 MySQL 实例导出 SQL 到新的实例。

+   复制拓扑升级：考虑每个服务器的拓扑角色。

### 查看支持的平台

如果您当前的操作系统不受新版本 MySQL 支持，则计划升级操作系统，否则不支持就地升级。

有关当前支持的平台列表，请参见：[`www.mysql.com/support/supportedplatforms/database.html`](https://www.mysql.com/support/supportedplatforms/database.html)

### 了解 MySQL 服务器的更改

每个主要版本都带来新功能、行为变化、弃用和移除。了解每个对现有应用程序的影响非常重要。

请参见：第 3.5 节，“MySQL 8.0 中的更改”。

### 运行升级检查器并修复不兼容性

MySQL Shell 的升级检查器实用程序检测数据库版本之间必须在升级之前解决的不兼容性。**util.checkForServerUpgrade()** 函数验证 MySQL 服务器实例是否准备好升级。连接到现有的 MySQL 服务器，并选择您计划升级到的 MySQL 服务器版本，以便实用程序报告在升级之前需要解决的问题。这些问题包括数据类型、存储引擎等不兼容性。

当升级检查工具不再报告任何问题时，您就可以准备升级了。

### 在测试环境中运行应用程���

完成升级检查器的要求后，接下来在新的目标 MySQL 服务器上测试您的应用程序。检查 MySQL 错误日志和应用程序日志中的错误和警告。

### 基准测试应用程序和工作负载性能

我们建议通过比较您的应用程序和工作负载在使用先前版本和新版本的 MySQL 时的性能来进行基准测试。通常，新版本的 MySQL 添加功能并提高性能，但也有可能升级后某些查询运行速度较慢。可能导致性能回退的问题：

+   先前的服务器配置对于新版本不是最佳的

+   数据类型的更改

+   多字节字符集支持需要额外的存储空间

+   存储引擎更改

+   删除或更改的索引

+   更强的加密

+   更强的身份验证

+   SQL 优化器的更改

+   新版本的 MySQL 需要额外的内存

+   物理或虚拟硬件较慢 - 计算或存储

有关相关信息和潜在的缓解技术，请参见有效性能回归。

### 并行运行两个 MySQL 版本

为了最小化风险，在运行升级系统的同时最好保持当前系统运行。

### 运行最终测试升级

在升级生产服务器之前进行练习和试运行。在升级生产系统之前彻底测试升级程序。

### 检查 MySQL 备份

在执行升级之前，请检查完整备份是否存在并可行。

### 升级生产服务器

您已准备好完成升级。

### 企业支持

如果您是 MySQL 企业版客户，您也可以联系 MySQL 支持团队的专家以解决任何问题。
