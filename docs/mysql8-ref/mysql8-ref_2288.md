# A.15 MySQL 8.0 FAQ: MySQL 企业线程池

> 原文：[`dev.mysql.com/doc/refman/8.0/en/faqs-thread-pool.html`](https://dev.mysql.com/doc/refman/8.0/en/faqs-thread-pool.html)

A.15.1\. 什么是线程池，它解决了什么问题？

A.15.2\. [线程池如何限制和管理并发会话和事务，以实现最佳性能和吞吐量？](https://dev.mysql.com/doc/refman/8.0/en/faqs-thread-pool.html#faq-thread-pool-how-manage-operation)

A.15.3\. 线程池与客户端端连接池有何不同？

A.15.4\. 何时应该使用线程池？

A.15.5\. 有推荐的线程池配置吗？

| **A.15.1.** | 什么是线程池，它解决了什么问题？ |
| --- | --- |
|  | MySQL 线程池是一个 MySQL 服务器插件，扩展了 MySQL 服务器的默认连接处理能力，限制了同时执行的语句/查询和事务的数量，以确保每个都有足够的 CPU 和内存资源来完成其任务。对于 MySQL 8.0，线程池插件包含在 MySQL 企业版中，这是一个商业产品。MySQL 服务器中的默认线程处理模型使用一个线程来执行每个客户端连接的语句。随着更多客户端连接到服务器并执行语句，整体性能会下降。线程池插件提供了一种旨在减少开销并提高性能的替代线程处理模型。线程池插件通过有效地管理大量客户端连接的语句执行线程来提高服务器性能，特别是在现代多 CPU/核心系统上。更多信息，请参见 Section 7.6.3，“MySQL 企业线程池”。 |
| **A.15.2.** | 线程池如何限制和管理并发会话和事务，以实现最佳性能和吞吐量？ |
|  | 线程池使用“分而治之”的方法来限制和平衡并发。与 MySQL 服务器的默认连接处理不同，线程池将连接和线程分开，因此连接和执行来自这些连接的语句的线程之间没有固定的关系。然后，线程池在可配置的线程组内管理客户端连接，根据它们被提交以完成的工作的性质进行优先级排序和排队。更多信息，请参见 Section 7.6.3.3，“线程池操作”。 |
| **A.15.3.** | 线程池与客户端端连接池有何不同？ |
|  | MySQL 连接池在客户端上运行，以确保 MySQL 客户端不会不断连接到并断开与 MySQL 服务器的连接。它旨在在 MySQL 客户端中缓存空闲连接，以供其他用户在需要时使用。这最小化了在将查询提交给 MySQL 服务器时建立和拆除连接的开销和费用。MySQL 连接池无法看到后端 MySQL 服务器的查询处理能力或负载。相比之下，线程池在 MySQL 服务器端运行，旨在管理从访问后端 MySQL 数据库的客户端连接接收到的入站并发连接和查询的执行。由于职责的分离，MySQL 连接池和线程池是正交的，可以独立使用。通过 MySQL 连接器进行 MySQL 连接池化在 第三十一章，“连接器和 API” 中有介绍。 |
| **A.15.4.** | 我何时应该使用线程池？ |
|  | 有一些经验法则可供考虑以获得最佳的线程池使用情况：MySQL `Threads_running` 变量跟踪当前在 MySQL 服务器中执行的并发语句数量。如果这个变量持续超过服务器无法正常运行的区域（通常对 InnoDB 工作负载超过 40），线程池应该是有益的，特别是在极端的并行过载情况下。如果您正在使用 `innodb_thread_concurrency` 来限制同时执行语句的数量，您应该发现线程池解决了同样的问题，只是更好地通过将连接分配给线程组，然后根据事务内容、用户定义的指定等排队执行。最后，如果您的工作负载主要由短查询组成，线程池应该是有益的。要了解更多信息，请参见 第 7.6.3.4 节，“线程池调优”。 |
| **A.15.5.** | 是否有推荐的线程池配置？ |
|  | 线程池具有一些用户案例驱动的配置参数，这些参数会影响其性能。要了解这些参数以及调优技巧，请参见 第 7.6.3.4 节，“线程池调优”。 |
