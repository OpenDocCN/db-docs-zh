> 原文：[`dev.mysql.com/doc/refman/8.0/en/replication-features-errors.html`](https://dev.mysql.com/doc/refman/8.0/en/replication-features-errors.html)

#### 19.5.1.29 复制过程中的副本错误

如果一条语句在源端和副本端产生相同的错误（相同的错误代码），错误会被记录，但复制会继续。

如果一条语句在源端和副本端产生不同的错误，复制 SQL 线程将终止，并且副本会在其错误日志中写入一条消息，等待数据库管理员决定如何处理该错误。这包括一种情况，即一条语句在源端或副本端产生错误，但不是同时在两端都出错。要解决这个问题，需要手动连接到副本并确定问题的原因。`SHOW REPLICA STATUS`（或在 MySQL 8.0.22 之前，`SHOW SLAVE STATUS`（或在 MySQL 8.0.22 之前，`START SLAVE` 选项屏蔽（忽略）一些或所有错误。

对于非事务性存储引擎，如`MyISAM`，可能会出现仅部分更新表并返回错误代码的语句。例如，在多行插入中有一行违反键约束，或者在更新了部分行后长时间的更新语句被终止。如果这种情况发生在源端，副本期望执行该语句会产生相同的错误代码。如果没有产生相同的错误代码，复制 SQL 线程将如前所述停止。

如果在源表和副本上使用不同存储引擎的表之间进行复制，请记住，同一语句在针对表的一个版本运行时可能会产生不同的错误，但在另一个版本上不会，或者可能会导致一个版本的表出现错误，而另一个版本不会。例如，由于`MyISAM`忽略外键约束，访问源上的`InnoDB`表的`INSERT`或`UPDATE`语句可能会导致外键违反，但在副本上的相同语句执行在`MyISAM`版本的相同表上不会产生此类错误，导致复制停止。

从 MySQL 8.0.31 开始，复制过滤规则首先应用，然后再进行任何权限或行格式检查，这样可以过滤掉任何未通过验证的事务；对于已被过滤的事务不执行任何检查，因此不会引发错误。这意味着副本只能接受给定用户已被授予访问权限的数据库部分（只要该数据库部分的更新使用基于行的复制格式）。在进行升级或迁移到一个使用入站复制用户无法访问管理表的系统或应用程序时，这可能会有所帮助。另请参阅第 19.2.5 节，“服务器如何评估复制过滤规则”。
