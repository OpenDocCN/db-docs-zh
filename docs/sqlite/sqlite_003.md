# 1\. SQLite 适用的情况

> 原文：[`sqlite.com/whentouse.html`](https://sqlite.com/whentouse.html)

SQLite 与 MySQL、Oracle、PostgreSQL 或 SQL Server 等客户端/服务器 SQL 数据库引擎不直接可比，因为 SQLite 正试图解决不同的问题。

客户端/服务器 SQL 数据库引擎致力于实现企业数据的共享存储库。它们强调可扩展性、并发性、集中化和控制。SQLite 则致力于为个别应用程序和设备提供本地数据存储。SQLite 强调经济性、效率、可靠性、独立性和简单性。

SQLite 并不与客户端/服务器数据库竞争。SQLite 与[fopen()](http://man.he.net/man3/fopen)竞争。

+   **嵌入式设备和物联网**

    因为 SQLite 数据库不需要管理，所以它非常适合在必须在没有专家支持的情况下运行的设备中使用。SQLite 非常适合用于手机、机顶盒、电视、游戏机、摄像头、手表、厨房电器、恒温器、汽车、机床、飞机、远程传感器、无人机、医疗设备和机器人等："物联网"设备。

    客户端/服务器数据库引擎设计用于生活在网络核心的精心管理的数据中心中。SQLite 在那里也能工作，但 SQLite 也可以在网络边缘繁荣发展，自力更生，为本来可能有不稳定连接的应用程序提供快速和可靠的数据服务。

+   **应用程序文件格式**

    SQLite 通常被用作桌面应用程序的磁盘文件格式，例如版本控制系统、财务分析工具、媒体目录和编辑套件、CAD 软件、记录管理程序等等。传统的文件/打开操作调用 sqlite3_open()来连接数据库文件。随着应用内容的更新，更新操作会自动发生，因此文件/保存菜单选项变得多余。可以使用备份 API 来实现文件/另存为菜单选项。

    这种方法有很多好处，包括提高性能、降低成本和复杂性、提高可靠性。更多信息请参阅技术笔记"aff_short.html"、"appfileformat.html"和"fasterthanfs.html"。此用例与下面的数据传输格式和数据容器用例密切相关。

+   **网站**

    SQLite 非常适合作为大多数低到中等流量网站的数据库引擎（也就是说，大多数网站）。SQLite 能处理的网站流量量取决于网站对其数据库的使用情况。一般来说，任何每天少于 100K 次点击的网站都可以很好地使用 SQLite。这个每天 100K 次点击的数字是一个保守估计，而不是严格的上限。SQLite 已经被证明可以处理比这多 10 倍的流量。

    当然，SQLite 的网站（[`www.sqlite.org/`](https://www.sqlite.org/)）本身也使用 SQLite，并且截至本文撰写时（2015 年），它每天处理大约 40 到 50 万次 HTTP 请求，其中约 15-20% 是涉及数据库的动态页面。动态内容每个网页使用 约 200 条 SQL 语句。该设置在一个与其他 23 台物理服务器共享的单个虚拟机上运行，大多数时间负载平均值低于 0.1。

    另请参阅：[2022-12-13 的 Hacker News 讨论](https://news.ycombinator.com/item?id=33975635)。

+   **数据分析**

    理解 SQL 的人可以使用 sqlite3 命令行 shell（或各种第三方 SQLite 访问程序）来分析大型数据集。原始数据可以从 CSV 文件导入，然后可以对这些数据进行切片和切块，生成大量的汇总报告。可以使用内置 SQLite 的 Tcl 或 Python 简单脚本，或者使用可用的适配器在 R 或其他语言中执行更复杂的分析。可能的用途包括网站日志分析、体育统计分析、编程指标汇编以及实验结果分析。许多生物信息学研究人员以这种方式使用 SQLite。

    当然，企业客户/服务器数据库也可以完成同样的事情。SQLite 的优势在于更容易安装和使用，并且生成的数据库是一个单独的文件，可以写入 USB 存储器或通过电子邮件发送给同事。

+   **企业数据缓存**

    许多应用程序将 SQLite 用作来自企业关系型数据库（RDBMS）的相关内容的缓存。这降低了延迟，因为现在大多数查询发生在本地缓存中，避免了网络往返。它还减少了网络和中央数据库服务器的负载。在许多情况下，这意味着客户端应用程序可以在网络中断期间继续运行。

+   **服务器端数据库**

    系统设计师报告称，在数据中心运行的服务器应用程序中使用 SQLite 作为数据存储，换句话说，将 SQLite 作为应用特定数据库服务器的底层存储引擎。

    在这种模式下，整个系统仍然是客户端/服务器模式：客户端向服务器发送请求，并通过网络获取回复。但是，与发送通用 SQL 并获取原始表内容不同，客户端的请求和服务器的响应是高级和特定于应用程序的。服务器将请求转换为多个 SQL 查询，收集结果，进行后处理、过滤和分析，然后构造一个只包含基本信息的高级回复。

    开发人员报告称，在这种情况下，SQLite 通常比客户端/服务器 SQL 数据库引擎更快。数据库请求由服务器串行化，所以并发性不是问题。通过“数据库分片”也可以改善并发性：为不同子域使用单独的数据库文件。例如，服务器可能为每个用户有一个独立的 SQLite 数据库，以便服务器可以处理数百或数千个同时连接，但每个 SQLite 数据库只由一个连接使用。

+   **数据传输格式**

    因为 SQLite 数据库是一个 定义明确的跨平台格式 中的单个紧凑文件，所以经常用作从一个系统向另一个系统传输内容的容器。发送方将内容收集到一个 SQLite 数据库文件中，将该文件传输给接收方，然后接收方使用 SQL 根据需要提取内容。

    即使端点的字长和/或字节顺序不同，SQLite 数据库也能方便地在系统之间传输数据。数据可能是大型二进制大对象、文本和小数值或布尔值的复杂混合。数据格式可以通过添加新的表和/或列轻松扩展，而不会破坏旧的接收器。SQL 查询语言意味着接收器不需要一次性解析整个传输内容，而是可以根据需要查询接收到的内容。数据格式是“透明的”，意味着可以使用多种普遍可用的开源工具，从多个供应商解码以便人类查看。

+   **文件归档和/或数据容器**

    SQLite 归档 的概念展示了如何使用 SQLite 作为 ZIP 归档或 Tarballs 的替代品。存储在 SQLite 中的文件归档只比等效的 ZIP 归档略大一些，在某些情况下甚至更小。SQLite 归档支持增量和原子更新，还能存储更丰富的元数据。

    [Fossil](https://www.fossil-scm.org/) 版本 2.5 及更高版本除了传统的 Tarball 和 ZIP 归档格式外，还提供 SQLite 归档文件 作为下载格式。sqlite3.exe 命令行 shell 版本 3.22.0 及更高版本可以使用 .archive 命令 创建、列出或解包 SQLite 归档。

    SQLite 是将各种内容打包成自包含且自描述包以便通过网络传输的良好解决方案。内容编码在一个 定义明确、跨平台且稳定的文件格式 中。编码高效，接收方可以提取内容的小子集而不必读取和解析整个文件。

    SQL 归档作为分发给多个客户端的软件或内容更新的分发格式非常有用。这个想法的变种被用于将电视节目指南传输到机顶盒，并向车载导航系统发送无线更新。

+   **临时替代*特定*磁盘文件**

    许多程序使用[fopen()](http://man.he.net/man3/fopen)、[fread()](http://man.he.net/man3/fread)和[fwrite()](http://man.he.net/man3/fwrite)来创建和管理自定义格式的数据文件。SQLite 特别适合作为这些*特定*数据文件的替代方案。与直觉相反，SQLite 在读写磁盘内容方面可能比文件系统更快。

+   **内部或临时数据库**

    对于需要以各种方式筛选和排序大量数据的程序，通常将数据加载到内存中的 SQLite 数据库，并使用带有 JOIN 和 ORDER BY 子句的查询来提取所需的数据形式和顺序，比手动编码相同操作更容易且更快。以这种方式在程序内部使用 SQL 数据库还使得程序更具灵活性，因为可以添加新的列和索引而无需重新编码每个查询。

+   **企业数据库演示或测试的替代方案**

    客户端应用程序通常使用通用数据库接口，允许连接到各种 SQL 数据库引擎。在支持的数据库中包括 SQLite 并静态链接 SQLite 引擎到客户端是明智的选择。这样客户端程序就可以独立使用 SQLite 数据文件进行测试或演示。

+   **教育与培训**

    因为设置和使用简单（安装非常简单：只需将**sqlite3**或**sqlite3.exe**可执行文件复制到目标机器并运行即可），SQLite 非常适合用于教授 SQL。学生们可以轻松创建任意数量的数据库，并可以通过电子邮件将数据库发送给教师以进行评语或评分。对于更进一步研究关系型数据库管理系统实现的高级学生来说，模块化且有良好注释和文档的 SQLite 代码可以作为一个很好的基础。

+   **实验性 SQL 语言扩展**

    SQLite 的简单模块化设计使其成为原型设计新的实验性数据库语言特性或思路的良好平台。

# 2\. 客户/服务器关系型数据库管理系统更适用的情况

+   **客户/服务器应用程序**

    如果有许多客户端程序通过网络向同一个数据库发送 SQL，则应使用客户/服务器数据库引擎而不是 SQLite。SQLite 可以在网络文件系统上工作，但由于大多数网络文件系统的延迟，性能不会很好。此外，许多网络文件系统实现中的文件锁逻辑存在错误（在 Unix 和 Windows 上均有）。如果文件锁定无法正常工作，则两个或更多客户端可能尝试同时修改同一数据库的同一部分，导致损坏。由于此问题源于底层文件系统实现的错误，SQLite 无法防止此类问题的发生。

    一个好的经验法则是在同一数据库将直接（无中间应用程序服务器）且同时从许多计算机上网络访问时，避免使用 SQLite。

+   **高流量网站**

    SQLite 通常可以作为网站的数据库后端正常工作。但是，如果网站的写入操作很频繁，或者非常繁忙以至于需要多台服务器，则考虑使用企业级客户/服务器数据库引擎，而不是 SQLite。

+   **非常大的数据集**

    SQLite 数据库大小限制为 281 TB（2⁴⁸字节，256 tebibytes）。即使它可以处理更大的数据库，SQLite 也将整个数据库存储在单个磁盘文件中，而许多文件系统将文件的最大大小限制在此以下。因此，如果您正在考虑这种规模的数据库，则最好考虑使用客户/服务器数据库引擎，该引擎将其内容分布在多个磁盘文件中，可能还分布在多个卷上。

+   **高并发**

    SQLite 支持无限数量的同时读取者，但每次只允许一个写入者。对于许多情况来说，这不是问题。写入者排队等候。每个应用程序都可以快速完成其数据库工作并继续进行，且任何锁定时间不超过几十毫秒。但是，有些应用程序需要更高的并发性，这些应用程序可能需要寻找其他解决方案。

# 3\. 选择正确数据库引擎的检查表

1.  **数据是否通过网络与应用程序分离？ → 选择客户/服务器**

    关系数据库引擎充当减少带宽的数据过滤器。因此，最好将数据库引擎和数据放在同一物理设备上，以便高带宽的引擎到磁盘链路无需经过网络，只需低带宽的应用程序到引擎链路即可。

    但是 SQLite 内置于应用程序中。因此，如果数据位于与应用程序分开的设备上，则需要跨网络进行更高带宽的引擎到磁盘链路。这种方法可行，但不是最佳选择。因此，在数据位于与应用程序分开的设备上时，通常最好选择客户/服务器数据库引擎。

    *Nota Bene:* 在这里，“应用程序”指发出 SQL 语句的代码。如果“应用程序”是应用程序服务器，且内容存储在与应用程序服务器相同的物理机器上，则 SQLite 可能仍然合适，即使最终用户在另一个网络跳跃之外。

1.  **许多并发写入者？ → 选择客户/服务器**

    如果许多线程和/或进程需要同时写入数据库（且它们无法排队并轮流执行），则最好选择支持该功能的数据库引擎，这总是指客户/服务器数据库引擎。

    SQLite 每次仅支持一个写入器对数据库文件进行写入。但在大多数情况下，写入事务只需几毫秒，因此多个写入器可以轮流进行。SQLite 可以处理的写入并发性比许多人想象的要多。然而，由于客户端/服务器数据库系统具有长时间运行的服务器进程来协调访问，因此通常可以处理比 SQLite 更多的写入并发性。

1.  **大数据？ → 选择客户端/服务器**

    如果您的数据将增长到使您无法或不愿将其放入单个磁盘文件的大小，那么您应该选择 SQLite 之外的解决方案。SQLite 支持大小高达 281TB 的数据库，假设您可以找到支持 281TB 文件的磁盘驱动器和文件系统。即便如此，当内容的大小看起来可能会渗入到 TB 范围时，最好考虑使用集中式客户端/服务器数据库。

1.  **否则 → 选择 SQLite！**

    对于设备本地存储，写入并发性低且内容少于一 TB 的情况，SQLite 几乎总是更好的解决方案。SQLite 快速可靠，无需配置或维护。它保持简单。SQLite“只管工作”。
