- en: 原文：[https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html)
  id: totrans-0
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html)
- en: 15.4.2.3 CHANGE REPLICATION SOURCE TO Statement
  id: totrans-1
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 15.4.2.3 CHANGE REPLICATION SOURCE TO 语句
- en: '[PRE0]'
  id: totrans-2
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE
    REPLICATION SOURCE TO Statement") changes the parameters that the replica server
    uses for connecting to the source and reading data from the source. It also updates
    the contents of the replication metadata repositories (see [Section 19.2.4, “Relay
    Log and Replication Metadata Repositories”](replica-logs.html "19.2.4 Relay Log
    and Replication Metadata Repositories")). In MySQL 8.0.23 and later, use [`CHANGE
    REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION
    SOURCE TO Statement") in place of the deprecated [`CHANGE MASTER TO`](change-master-to.html
    "15.4.2.1 CHANGE MASTER TO Statement") statement.'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[`CHANGE REPLICATION SOURCE TO`](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html)更改副本服务器用于连接到源并从源读取数据的参数。它还更新了复制元数据存储库的内容（参见[Section 19.2.4,
    “Relay Log and Replication Metadata Repositories”](https://dev.mysql.com/doc/refman/8.0/en/replica-logs.html)）。在MySQL
    8.0.23及更高版本中，请使用[`CHANGE REPLICATION SOURCE TO`](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html)代替已弃用的[`CHANGE
    MASTER TO`](https://dev.mysql.com/doc/refman/8.0/en/change-master-to.html)语句。'
- en: '[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE
    REPLICATION SOURCE TO Statement") requires the [`REPLICATION_SLAVE_ADMIN`](privileges-provided.html#priv_replication-slave-admin)
    privilege (or the deprecated [`SUPER`](privileges-provided.html#priv_super) privilege).'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: '[`CHANGE REPLICATION SOURCE TO`](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html)需要[`REPLICATION_SLAVE_ADMIN`](https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_replication-slave-admin)权限（或已弃用的[`SUPER`](https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_super)权限）。'
- en: Options that you do not specify on a [`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 CHANGE REPLICATION SOURCE TO Statement") statement retain their value,
    except as indicated in the following discussion. In most cases, there is therefore
    no need to specify options that do not change.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 在[`CHANGE REPLICATION SOURCE TO`](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html)语句中未指定的选项保留其值，除非在以下讨论中另有说明。因此，在大多数情况下，无需指定不更改的选项。
- en: Values used for `SOURCE_HOST` and other [`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 CHANGE REPLICATION SOURCE TO Statement") options are checked for linefeed
    (`\n` or `0x0A`) characters. The presence of such characters in these values causes
    the statement to fail with an error.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 用于`SOURCE_HOST`和其他[`CHANGE REPLICATION SOURCE TO`](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html)选项的值会检查换行符（`\n`或`0x0A`）。这些值中存在这些字符会导致语句失败并出现错误。
- en: 'The optional `FOR CHANNEL *`channel`*` clause lets you name which replication
    channel the statement applies to. Providing a `FOR CHANNEL *`channel`*` clause
    applies the [`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 CHANGE REPLICATION SOURCE TO Statement") statement to a specific replication
    channel, and is used to add a new channel or modify an existing channel. For example,
    to add a new channel called `channel2`:'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 可选的`FOR CHANNEL *`channel`*`子句允许您指定语句适用于哪个复制通道。提供`FOR CHANNEL *`channel`*`子句将[`CHANGE
    REPLICATION SOURCE TO`](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html)语句应用于特定的复制通道，并用于添加新通道或修改现有通道。例如，要添加一个名为`channel2`的新通道：
- en: '[PRE1]'
  id: totrans-8
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: If no clause is named and no extra channels exist, a [`CHANGE REPLICATION SOURCE
    TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION SOURCE TO
    Statement") statement applies to the default channel, whose name is the empty
    string (""). When you have set up multiple replication channels, every [`CHANGE
    REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION
    SOURCE TO Statement") statement must name a channel using the `FOR CHANNEL *`channel`*`
    clause. See [Section 19.2.2, “Replication Channels”](replication-channels.html
    "19.2.2 Replication Channels") for more information.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 如果未命名子句且不存在额外通道，则[`CHANGE REPLICATION SOURCE TO`](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html)语句适用于默认通道，其名称为空字符串（""）。当设置了多个复制通道时，每个[`CHANGE
    REPLICATION SOURCE TO`](https://dev.mysql.com/doc/refman/8.0/en/change-replication-source-to.html)语句必须使用`FOR
    CHANNEL *`channel`*`子句命名通道。有关更多信息，请参见[Section 19.2.2, “Replication Channels”](https://dev.mysql.com/doc/refman/8.0/en/replication-channels.html)。
- en: 'For some of the options of the [`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 CHANGE REPLICATION SOURCE TO Statement") statement, you must issue a
    [`STOP REPLICA`](stop-replica.html "15.4.2.8 STOP REPLICA Statement") statement
    prior to issuing a [`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 CHANGE REPLICATION SOURCE TO Statement") statement (and a [`START REPLICA`](start-replica.html
    "15.4.2.6 START REPLICA Statement") statement afterwards). Sometimes, you only
    need to stop the replication SQL (applier) thread or the replication I/O (receiver)
    thread, not both:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 对于[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE
    REPLICATION SOURCE TO Statement")语句的某些选项，您必须在发出[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 CHANGE REPLICATION SOURCE TO Statement")语句之前发出[`STOP REPLICA`](stop-replica.html
    "15.4.2.8 STOP REPLICA Statement")语句（以及之后发出[`START REPLICA`](start-replica.html
    "15.4.2.6 START REPLICA Statement")语句）。有时，您只需要停止复制SQL（应用程序）线程或复制I/O（接收）线程，而不是两者都要停止：
- en: When the applier thread is stopped, you can execute [`CHANGE REPLICATION SOURCE
    TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION SOURCE TO
    Statement") using any combination that is otherwise allowed of `RELAY_LOG_FILE`,
    `RELAY_LOG_POS`, and `SOURCE_DELAY` options, even if the replication receiver
    thread is running. No other options may be used with this statement when the receiver
    thread is running.
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当应用程序线程停止时，您可以使用`RELAY_LOG_FILE`、`RELAY_LOG_POS`和`SOURCE_DELAY`选项的任何允许组合执行[`CHANGE
    REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION
    SOURCE TO Statement")，即使复制接收线程正在运行。当接收线程正在运行时，不得使用此语句的其他选项。
- en: When the receiver thread is stopped, you can execute [`CHANGE REPLICATION SOURCE
    TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION SOURCE TO
    Statement") using any of the options for this statement (in any allowed combination)
    *except* `RELAY_LOG_FILE`, `RELAY_LOG_POS`, `SOURCE_DELAY`, or `SOURCE_AUTO_POSITION
    = 1` even when the applier thread is running.
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当接收线程停止时，您可以使用此语句的任何选项（以任何允许的组合）执行[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 CHANGE REPLICATION SOURCE TO Statement")，*除了* `RELAY_LOG_FILE`、`RELAY_LOG_POS`、`SOURCE_DELAY`或`SOURCE_AUTO_POSITION
    = 1`，即使应用程序线程正在运行。
- en: Both the receiver thread and the applier thread must be stopped before issuing
    a [`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE
    REPLICATION SOURCE TO Statement") statement that employs `SOURCE_AUTO_POSITION
    = 1`, `GTID_ONLY = 1`, or `ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS`.
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在发出使用`SOURCE_AUTO_POSITION = 1`、`GTID_ONLY = 1`或`ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS`的[`CHANGE
    REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION
    SOURCE TO Statement")语句之前，必须停止接收线程和应用程序线程。
- en: You can check the current state of the replication applier thread and replication
    receiver thread using [`SHOW REPLICA STATUS`](show-replica-status.html "15.7.7.35 SHOW
    REPLICA STATUS Statement"). Note that the Group Replication applier channel (`group_replication_applier`)
    has no receiver thread, only an applier thread.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用[`SHOW REPLICA STATUS`](show-replica-status.html "15.7.7.35 SHOW REPLICA
    STATUS Statement")检查复制应用程序线程和复制接收线程的当前状态。请注意，Group Replication应用程序通道（`group_replication_applier`）没有接收线程，只有一个应用程序线程。
- en: '[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE
    REPLICATION SOURCE TO Statement") statements have a number of side-effects and
    interactions that you should be aware of beforehand:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE
    REPLICATION SOURCE TO Statement")语句具有许多您在执行之前应该了解的副作用和交互作用：'
- en: '[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE
    REPLICATION SOURCE TO Statement") causes an implicit commit of an ongoing transaction.
    See [Section 15.3.3, “Statements That Cause an Implicit Commit”](implicit-commit.html
    "15.3.3 Statements That Cause an Implicit Commit").'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE
    REPLICATION SOURCE TO Statement")会导致正在进行的事务隐式提交。请参阅[第15.3.3节，“导致隐式提交的语句”](implicit-commit.html
    "15.3.3 导致隐式提交的语句")。'
- en: '[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE
    REPLICATION SOURCE TO Statement") causes the previous values for `SOURCE_HOST`,
    `SOURCE_PORT`, `SOURCE_LOG_FILE`, and `SOURCE_LOG_POS` to be written to the error
    log, along with other information about the replica''s state prior to execution.'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE
    REPLICATION SOURCE TO Statement")会将`SOURCE_HOST`、`SOURCE_PORT`、`SOURCE_LOG_FILE`和`SOURCE_LOG_POS`的先前值写入错误日志，以及在执行之前有关副本状态的其他信息。'
- en: If you are using statement-based replication and temporary tables, it is possible
    for a [`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE
    REPLICATION SOURCE TO Statement") statement following a [`STOP REPLICA`](stop-replica.html
    "15.4.2.8 STOP REPLICA Statement") statement to leave behind temporary tables
    on the replica. A warning ([`ER_WARN_OPEN_TEMP_TABLES_MUST_BE_ZERO`](/doc/mysql-errors/8.0/en/server-error-reference.html#error_er_warn_open_temp_tables_must_be_zero))
    is issued whenever this occurs. You can avoid this in such cases by making sure
    that the value of the [`Replica_open_temp_tables`](server-status-variables.html#statvar_Replica_open_temp_tables)
    or [`Slave_open_temp_tables`](server-status-variables.html#statvar_Slave_open_temp_tables)
    system status variable is equal to 0 prior to executing such a [`CHANGE REPLICATION
    SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION SOURCE
    TO Statement") statement.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果您正在使用基于语句的复制和临时表，可能会出现在[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 CHANGE REPLICATION SOURCE TO Statement")语句之后的[`STOP REPLICA`](stop-replica.html
    "15.4.2.8 STOP REPLICA Statement")语句在副本上留下临时表的情况。每当发生这种情况时，都会发出警告([`ER_WARN_OPEN_TEMP_TABLES_MUST_BE_ZERO`](/doc/mysql-errors/8.0/en/server-error-reference.html#error_er_warn_open_temp_tables_must_be_zero))。在这种情况下，您可以通过确保在执行[`CHANGE
    REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION
    SOURCE TO Statement")语句之前，[`Replica_open_temp_tables`](server-status-variables.html#statvar_Replica_open_temp_tables)或[`Slave_open_temp_tables`](server-status-variables.html#statvar_Slave_open_temp_tables)系统状态变量的值等于
    0 来避免这种情况。
- en: When using a multithreaded replica ([`replica_parallel_workers`](replication-options-replica.html#sysvar_replica_parallel_workers)
    > 0), stopping the replica can cause gaps in the sequence of transactions that
    have been executed from the relay log, regardless of whether the replica was stopped
    intentionally or otherwise. When such gaps exist, issuing [`CHANGE REPLICATION
    SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION SOURCE
    TO Statement") fails. The solution in this situation is to issue [`START REPLICA
    UNTIL SQL_AFTER_MTS_GAPS`](start-replica.html "15.4.2.6 START REPLICA Statement")
    which ensures that the gaps are closed. From MySQL 8.0.26, the process of checking
    for gaps in the sequence of transactions is skipped entirely when GTID-based replication
    and GTID auto-positioning are in use, because gaps in transactions can be resolved
    using GTID auto-positioning. In that situation, [`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 CHANGE REPLICATION SOURCE TO Statement") can still be used.
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当使用多线程副本（[`replica_parallel_workers`](replication-options-replica.html#sysvar_replica_parallel_workers)
    > 0）时，停止副本可能导致已从中继日志执行的事务序列中存在间隙，无论副本是有意停止还是其他情况。当存在这样的间隙时，发出[`CHANGE REPLICATION
    SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION SOURCE
    TO Statement")将失败。在这种情况下的解决方案是发出[`START REPLICA UNTIL SQL_AFTER_MTS_GAPS`](start-replica.html
    "15.4.2.6 START REPLICA Statement")，以确保关闭这些间隙。从 MySQL 8.0.26 开始，当使用基于 GTID 的复制和
    GTID 自动定位时，完全跳过检查事务序列中的间隙的过程，因为可以使用 GTID 自动定位解决事务间隙。在这种情况下，仍然可以使用[`CHANGE REPLICATION
    SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION SOURCE
    TO Statement")。
- en: 'The following options are available for [`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 CHANGE REPLICATION SOURCE TO Statement") statements:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 下列选项适用于[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE
    REPLICATION SOURCE TO Statement")语句：
- en: '[`ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS = {OFF | LOCAL | *`uuid`*}`](change-replication-source-to.html#crs-opt-assign_gtids_to_anonymous_transactions)'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS = {OFF | LOCAL | *`uuid`*}`](change-replication-source-to.html#crs-opt-assign_gtids_to_anonymous_transactions)'
- en: Makes the replication channel assign a GTID to replicated transactions that
    do not have one, enabling replication from a source that does not use GTID-based
    replication, to a replica that does. For a multi-source replica, you can have
    a mix of channels that use `ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS`, and channels
    that do not. The default is `OFF`, meaning that the feature is not used.
  id: totrans-22
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使复制通道为没有 GTID 的复制事务分配一个 GTID，从不使用基于 GTID 的复制的源复制到使用基于 GTID 的副本。对于多源副本，您可以同时使用`ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS`和不使用该选项的通道。默认值为`OFF`，表示不使用该功能。
- en: '`LOCAL` assigns a GTID including the replica''s own UUID (the [`server_uuid`](replication-options.html#sysvar_server_uuid)
    setting). `*`uuid`*` assigns a GTID including the specified UUID, such as the
    [`server_uuid`](replication-options.html#sysvar_server_uuid) setting for the replication
    source server. Using a nonlocal UUID lets you differentiate between transactions
    that originated on the replica and transactions that originated on the source,
    and for a multi-source replica, between transactions that originated on different
    sources. The UUID you choose only has significance for the replica''s own use.
    If any of the transactions sent by the source do have a GTID already, that GTID
    is retained.'
  id: totrans-23
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`LOCAL`分配一个包括副本自身UUID（[`server_uuid`](replication-options.html#sysvar_server_uuid)设置）的GTID。`*`uuid`*`分配一个包括指定UUID的GTID，例如复制源服务器的[`server_uuid`](replication-options.html#sysvar_server_uuid)设置。使用非本地UUID可以区分在副本上发起的事务和在源上发起的事务，对于多源副本，还可以区分在不同源上发起的事务。您选择的UUID仅对副本自身使用有意义。如果源发送的任何事务已经具有GTID，则保留该GTID。'
- en: Channels specific to Group Replication cannot use `ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS`,
    but an asynchronous replication channel for another source on a server instance
    that is a Group Replication group member can do so. In that case, do not specify
    the Group Replication group name as the UUID for creating the GTIDs.
  id: totrans-24
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 专用于组复制的通道不能使用`ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS`，但是在作为组复制组成员的服务器实例上的另一个源的异步复制通道可以这样做。在这种情况下，不要将组复制组名称指定为创建GTID的UUID。
- en: To set `ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS` to `LOCAL` or `*`uuid`*`, the
    replica must have [`gtid_mode=ON`](replication-options-gtids.html#sysvar_gtid_mode)
    set, and this cannot be changed afterwards. This option is for use with a source
    that has binary log file position based replication, so `SOURCE_AUTO_POSITION=1`
    cannot be set for the channel. Both the replication SQL thread and the replication
    I/O (receiver) thread must be stopped before setting this option.
  id: totrans-25
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 要将`ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS`设置为`LOCAL`或`*`uuid`*`，副本必须设置[`gtid_mode=ON`](replication-options-gtids.html#sysvar_gtid_mode)，并且之后不能更改。此选项用于与具有基于二进制日志文件位置的复制的源一起使用，因此不能为通道设置`SOURCE_AUTO_POSITION=1`。在设置此选项之前，必须停止复制SQL线程和复制I/O（接收器）线程。
- en: Important
  id: totrans-26
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 重要提示
- en: A replica set up with `ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS` on any channel
    cannot be promoted to replace the replication source server in the event that
    a failover is required, and a backup taken from the replica cannot be used to
    restore the replication source server. The same restriction applies to replacing
    or restoring other replicas that use `ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS`
    on any channel.
  id: totrans-27
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使用任何通道上的`ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS`设置的副本不能在需要故障转移时晋升为替换复制源服务器，并且不能使用从副本中获取的备份来恢复复制源服务器。相同的限制也适用于替换或恢复其他使用任何通道上的`ASSIGN_GTIDS_TO_ANONYMOUS_TRANSACTIONS`的副本。
- en: For further restrictions and information, see [Section 19.1.3.6, “Replication
    From a Source Without GTIDs to a Replica With GTIDs”](replication-gtids-assign-anon.html
    "19.1.3.6 Replication From a Source Without GTIDs to a Replica With GTIDs").
  id: totrans-28
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 有关更多限制和信息，请参阅[第19.1.3.6节，“从没有GTID的源复制到具有GTID的副本”](replication-gtids-assign-anon.html
    "19.1.3.6 从没有GTID的源复制到具有GTID的副本")。
- en: '[`GET_SOURCE_PUBLIC_KEY = {0|1}`](change-replication-source-to.html#crs-opt-get_source_public_key)'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`GET_SOURCE_PUBLIC_KEY = {0|1}`](change-replication-source-to.html#crs-opt-get_source_public_key)'
- en: Enables RSA key pair-based password exchange by requesting the public key from
    the source. The option is disabled by default.
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 通过请求源的公钥启用基于RSA密钥对的密码交换。此选项默认禁用。
- en: This option applies to replicas that authenticate with the `caching_sha2_password`
    authentication plugin. For connections by accounts that authenticate using this
    plugin, the source does not send the public key unless requested, so it must be
    requested or specified in the client. If `SOURCE_PUBLIC_KEY_PATH` is given and
    specifies a valid public key file, it takes precedence over `GET_SOURCE_PUBLIC_KEY`.
    If you are using a replication user account that authenticates with the `caching_sha2_password`
    plugin (which is the default from MySQL 8.0), and you are not using a secure connection,
    you must specify either this option or the `SOURCE_PUBLIC_KEY_PATH` option to
    provide the RSA public key to the replica.
  id: totrans-31
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此选项适用于使用`caching_sha2_password`认证插件进行身份验证的复制品。对于使用此插件进行身份验证的帐户的连接，源不会发送公钥，除非请求，因此必须请求或在客户端中指定。如果给出`SOURCE_PUBLIC_KEY_PATH`并指定有效的公钥文件，则它优先于`GET_SOURCE_PUBLIC_KEY`。如果您正在使用使用`caching_sha2_password`插件进行身份验证的复制用户帐户（这是从MySQL
    8.0开始的默认设置），并且您没有使用安全连接，则必须指定此选项或`SOURCE_PUBLIC_KEY_PATH`选项以向复制品提供RSA公钥。
- en: '[`GTID_ONLY = {0|1}`](change-replication-source-to.html#crs-opt-gtid_only)'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`GTID_ONLY = {0|1}`](change-replication-source-to.html#crs-opt-gtid_only)'
- en: Stops the replication channel persisting file names and file positions in the
    replication metadata repositories. `GTID_ONLY` is available as of MySQL 8.0.27\.
    The `GTID_ONLY` option is disabled by default for asynchronous replication channels,
    but it is enabled by default for Group Replication channels, and it cannot be
    disabled for them.
  id: totrans-33
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 停止复制通道在复制元数据存储库中持久化文件名和文件位置。`GTID_ONLY`从MySQL 8.0.27版本开始提供。`GTID_ONLY`选项在异步复制通道中默认禁用，但在组复制通道中默认启用，并且无法禁用。
- en: For replication channels with this setting, in-memory file positions are still
    tracked, and file positions can still be observed for debugging purposes in error
    messages and through interfaces such as [`SHOW REPLICA STATUS`](show-replica-status.html
    "15.7.7.35 SHOW REPLICA STATUS Statement") statements (where they are shown as
    being invalid if they are out of date). However, the writes and reads required
    to persist and check the file positions are avoided in situations where GTID-based
    replication does not actually require them, including the transaction queuing
    and application process.
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对于具有此设置的复制通道，仍会跟踪内存中的文件位置，并且出于调试目的，文件位置仍然可以在错误消息和通过诸如[`SHOW REPLICA STATUS`](show-replica-status.html
    "15.7.7.35 SHOW REPLICA STATUS Statement")语句（如果它们过时，则显示为无效）等接口中观察到。但是，在GTID基础复制实际上不需要它们的情况下，包括事务排队和应用程序过程中，避免了持久化和检查文件位置所需的写入和读取。
- en: This option can be used only if both the replication SQL (applier) thread and
    replication I/O (receiver) thread are stopped. To set `GTID_ONLY = 1` for a replication
    channel, GTIDs must be in use on the server ([`gtid_mode = ON`](replication-options-gtids.html#sysvar_gtid_mode)),
    and row-based binary logging must be in use on the source (statement-based replication
    is not supported). The options `REQUIRE_ROW_FORMAT = 1` and `SOURCE_AUTO_POSITION
    = 1` must be set for the replication channel.
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 只有在停止复制SQL（应用程序）线程和复制I/O（接收器）线程时才能使用此选项。要为复制通道设置`GTID_ONLY = 1`，必须在服务器上使用GTID（[`gtid_mode
    = ON`](replication-options-gtids.html#sysvar_gtid_mode)），并且源上必须使用基于行的二进制日志记录（不支持基于语句的复制）。必须为复制通道设置选项`REQUIRE_ROW_FORMAT
    = 1`和`SOURCE_AUTO_POSITION = 1`。
- en: When `GTID_ONLY = 1` is set, the replica uses [`replica_parallel_workers=1`](replication-options-replica.html#sysvar_replica_parallel_workers)
    if that system variable is set to zero for the server, so it is always technically
    a multi-threaded applier. This is because a multi-threaded applier uses saved
    positions rather than the replication metadata repositories to locate the start
    of a transaction that it needs to reapply.
  id: totrans-36
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当设置`GTID_ONLY = 1`时，如果服务器上的系统变量`replica_parallel_workers`设置为零，则复制品会使用[`replica_parallel_workers=1`](replication-options-replica.html#sysvar_replica_parallel_workers)，因此它在技术上始终是一个多线程应用程序。这是因为多线程应用程序使用保存的位置而不是复制元数据存储库来定位需要重新应用的事务的起始位置。
- en: If you disable `GTID_ONLY` after setting it, the existing relay logs are deleted
    and the existing known binary log file positions are persisted, even if they are
    stale. The file positions for the binary log and relay log in the replication
    metadata repositories might be invalid, and a warning is returned if this is the
    case. Provided that `SOURCE_AUTO_POSITION` is still enabled, GTID auto-positioning
    is used to provide the correct positioning.
  id: totrans-37
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果在设置`GTID_ONLY`后禁用它，现有的中继日志将被删除，并且现有的已知的二进制日志文件位置将被保留，即使它们已经过时。在复制元数据存储库中，二进制日志和中继日志的文件位置可能是无效的，如果是这种情况，则会返回警告。只要`SOURCE_AUTO_POSITION`仍然启用，GTID自动定位将被用来提供正确的定位。
- en: If you also disable `SOURCE_AUTO_POSITION`, the file positions for the binary
    log and relay log in the replication metadata repositories are used for positioning
    if they are valid. If they are marked as invalid, you must provide a valid binary
    log file name and position (`SOURCE_LOG_FILE` and `SOURCE_LOG_POS`). If you also
    provide a relay log file name and position (`RELAY_LOG_FILE` and `RELAY_LOG_POS`),
    the relay logs are preserved and the applier position is set to the stated position.
    GTID auto-skip ensures that any transactions already applied are skipped even
    if the eventual applier position is not correct.
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果你也禁用了`SOURCE_AUTO_POSITION`，则在复制元数据存储库中使用二进制日志和中继日志的文件位置进行定位，如果它们是有效的。如果它们被标记为无效，你必须提供一个有效的二进制日志文件名和位置（`SOURCE_LOG_FILE`和`SOURCE_LOG_POS`）。如果你还提供了一个中继日志文件名和位置（`RELAY_LOG_FILE`和`RELAY_LOG_POS`），则中继日志将被保留，而应用程序位置将被设置为指定位置。
    GTID自动跳过确保任何已经应用的事务都会被跳过，即使最终的应用程序位置不正确。
- en: '[`IGNORE_SERVER_IDS = (*`server_id_list`*)`](change-replication-source-to.html#crs-opt-ignore_server_ids)'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`IGNORE_SERVER_IDS = (*`server_id_list`*)`](change-replication-source-to.html#crs-opt-ignore_server_ids)'
- en: Makes the replica ignore events originating from the specified servers. The
    option takes a comma-separated list of 0 or more server IDs. Log rotation and
    deletion events from the servers are not ignored, and are recorded in the relay
    log.
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使复制忽略来自指定服务器的事件。该选项接受一个逗号分隔的0个或多个服务器ID的列表。来自服务器的日志旋转和删除事件不会被忽略，并且会记录在中继日志中。
- en: In circular replication, the originating server normally acts as the terminator
    of its own events, so that they are not applied more than once. Thus, this option
    is useful in circular replication when one of the servers in the circle is removed.
    Suppose that you have a circular replication setup with 4 servers, having server
    IDs 1, 2, 3, and 4, and server 3 fails. When bridging the gap by starting replication
    from server 2 to server 4, you can include `IGNORE_SERVER_IDS = (3)` in the [`CHANGE
    REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION
    SOURCE TO Statement") statement that you issue on server 4 to tell it to use server
    2 as its source instead of server 3\. Doing so causes it to ignore and not to
    propagate any statements that originated with the server that is no longer in
    use.
  id: totrans-41
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在循环复制中，原始服务器通常充当其自己事件的终结者，以便它们不会被应用多次。因此，在循环复制中，当圈中的一个服务器被移除时，这个选项是有用的。假设你有一个带有服务器ID为1、2、3和4的4台服务器的循环复制设置，并且服务器3失败了。在通过从服务器2开始到服务器4启动复制来填补这个空白时，你可以在服务器4上发出的[`CHANGE
    REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION
    SOURCE TO Statement")语句中包含`IGNORE_SERVER_IDS = (3)`，告诉��使用服务器2作为其源，而不是服务器3。这样做会导致它忽略并不传播任何源自不再使用的服务器的语句。
- en: If `IGNORE_SERVER_IDS` contains the server's own ID and the server was started
    with the [`--replicate-same-server-id`](replication-options-replica.html#option_mysqld_replicate-same-server-id)
    option enabled, an error results.
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果`IGNORE_SERVER_IDS`包含服务器自己的ID，并且服务器是使用[`--replicate-same-server-id`](replication-options-replica.html#option_mysqld_replicate-same-server-id)选项启动的，则会导致错误。
- en: Note
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意
- en: When global transaction identifiers (GTIDs) are used for replication, transactions
    that have already been applied are automatically ignored, so the `IGNORE_SERVER_IDS`
    function is not required and is deprecated. If [`gtid_mode=ON`](replication-options-gtids.html#sysvar_gtid_mode)
    is set for the server, a deprecation warning is issued if you include the `IGNORE_SERVER_IDS`
    option in a [`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 CHANGE REPLICATION SOURCE TO Statement") statement.
  id: totrans-44
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当全局事务标识符（GTID）用于复制时，已经应用的事务会自动被忽略，因此不需要使用`IGNORE_SERVER_IDS`函数，该函数已被弃用。如果为服务器设置了[`gtid_mode=ON`](replication-options-gtids.html#sysvar_gtid_mode)，则如果在[`CHANGE
    REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION
    SOURCE TO Statement")语句中包含`IGNORE_SERVER_IDS`选项，则会发出弃用警告。
- en: The source metadata repository and the output of [`SHOW REPLICA STATUS`](show-replica-status.html
    "15.7.7.35 SHOW REPLICA STATUS Statement") provide the list of servers that are
    currently ignored. For more information, see [Section 19.2.4.2, “Replication Metadata
    Repositories”](replica-logs-status.html "19.2.4.2 Replication Metadata Repositories"),
    and [Section 15.7.7.35, “SHOW REPLICA STATUS Statement”](show-replica-status.html
    "15.7.7.35 SHOW REPLICA STATUS Statement").
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 源元数据存储库和[`SHOW REPLICA STATUS`](show-replica-status.html "15.7.7.35 显示REPLICA状态语句")的输出提供当前被忽略的服务器列表。有关更多信息，请参见[第19.2.4.2节，“复制元数据存储库”](replica-logs-status.html
    "19.2.4.2 复制元数据存储库")和[第15.7.7.35节，“显示REPLICA状态语句”](show-replica-status.html "15.7.7.35 显示REPLICA状态语句")。
- en: 'If a [`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE
    REPLICATION SOURCE TO Statement") statement is issued without any `IGNORE_SERVER_IDS`
    option, any existing list is preserved. To clear the list of ignored servers,
    it is necessary to use the option with an empty list:'
  id: totrans-46
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果发出不带任何`IGNORE_SERVER_IDS`选项的[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 更改REPLICATION源到语句")语句，则会保留任何现有列表。要清除被忽略服务器的列表，必须使用带有空列表的选项：
- en: '[PRE2]'
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '[`RESET REPLICA ALL`](reset-replica.html "15.4.2.4 RESET REPLICA Statement")
    clears `IGNORE_SERVER_IDS`.'
  id: totrans-48
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '[`RESET REPLICA ALL`](reset-replica.html "15.4.2.4 重置REPLICA语句")清除`IGNORE_SERVER_IDS`。'
- en: Note
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意
- en: A deprecation warning is issued if `SET GTID_MODE=ON` is issued when any channel
    has existing server IDs set with `IGNORE_SERVER_IDS`. Before starting GTID-based
    replication, check for and clear all ignored server ID lists on the servers involved.
    The [`SHOW REPLICA STATUS`](show-replica-status.html "15.7.7.35 SHOW REPLICA STATUS
    Statement") statement displays the list of ignored IDs, if there is one. If you
    do receive the deprecation warning, you can still clear a list after [`gtid_mode=ON`](replication-options-gtids.html#sysvar_gtid_mode)
    is set by issuing a [`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 CHANGE REPLICATION SOURCE TO Statement") statement containing the `IGNORE_SERVER_IDS`
    option with an empty list.
  id: totrans-50
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果在任何通道存在使用`IGNORE_SERVER_IDS`设置的现有服务器ID时发出`SET GTID_MODE=ON`，则会发出弃用警告。在启动基于GTID的复制之前，请检查并清除涉及服务器上的所有被忽略的服务器ID列表。[`SHOW
    REPLICA STATUS`](show-replica-status.html "15.7.7.35 显示REPLICA状态语句")语句显示被忽略的ID列表（如果有）。如果收到弃用警告，仍然可以通过发出包含带有空列表的`IGNORE_SERVER_IDS`选项的[`CHANGE
    REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 更改REPLICATION源到语句")语句来清除列表。
- en: '[`NETWORK_NAMESPACE = ''*`namespace`*''`](change-replication-source-to.html#crs-opt-network_namespace)'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`NETWORK_NAMESPACE = ''*`namespace`*''`](change-replication-source-to.html#crs-opt-network_namespace)'
- en: The network namespace to use for TCP/IP connections to the replication source
    server or, if the MySQL communication stack is in use, for Group Replication’s
    group communication connections. The maximum length of the string value is 64
    characters. If this option is omitted, connections from the replica use the default
    (global) namespace. On platforms that do not implement network namespace support,
    failure occurs when the replica attempts to connect to the source. For information
    about network namespaces, see [Section 7.1.14, “Network Namespace Support”](network-namespace-support.html
    "7.1.14 Network Namespace Support"). `NETWORK_NAMESPACE` is available as of MySQL
    8.0.22.
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 用于TCP/IP连接到复制源服务器的网络命名空间，或者如果使用MySQL通信堆栈，则用于Group Replication的组通信连接。字符串值的最大长度为64个字符。如果省略此选项，则副本的连接将使用默认（全局）命名空间。在不实现网络命名空间支持的平台上，当副本尝试连接到源时会发生故障。有关网络命名空间的信息，请参见[第7.1.14节，“网络命名空间支持”](network-namespace-support.html
    "7.1.14 网络命名空间支持")。`NETWORK_NAMESPACE`在MySQL 8.0.22中可用。
- en: '[`PRIVILEGE_CHECKS_USER = {NULL | ''*`account`*''}`](change-replication-source-to.html#crs-opt-privilege_checks_user)'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`PRIVILEGE_CHECKS_USER = {NULL | ''*`account`*''}`](change-replication-source-to.html#crs-opt-privilege_checks_user)'
- en: Names a user account that supplies a security context for the specified channel.
    `NULL`, which is the default, means no security context is used. `PRIVILEGE_CHECKS_USER`
    is available as of MySQL 8.0.18.
  id: totrans-54
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 为指定通道提供安全上下文的用户帐户名称。`NULL`是默认值，表示不使用安全上下文。`PRIVILEGE_CHECKS_USER`在MySQL 8.0.18中可用。
- en: The user name and host name for the user account must follow the syntax described
    in [Section 8.2.4, “Specifying Account Names”](account-names.html "8.2.4 Specifying
    Account Names"), and the user must not be an anonymous user (with a blank user
    name) or the `CURRENT_USER`. The account must have the [`REPLICATION_APPLIER`](privileges-provided.html#priv_replication-applier)
    privilege, plus the required privileges to execute the transactions replicated
    on the channel. For details of the privileges required by the account, see [Section 19.3.3,
    “Replication Privilege Checks”](replication-privilege-checks.html "19.3.3 Replication
    Privilege Checks"). When you restart the replication channel, the privilege checks
    are applied from that point on. If you do not specify a channel and no other channels
    exist, the statement is applied to the default channel.
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 用户帐户的用户名和主机名必须遵循 [第 8.2.4 节“指定帐户名称”](account-names.html "8.2.4 指定帐户名称") 中描述的语法，并且用户不能是匿名用户（具有空白用户名）或
    `CURRENT_USER`。帐户必须具有 [`REPLICATION_APPLIER`](privileges-provided.html#priv_replication-applier)
    权限，以及执行在通道上复制的事务所需的权限。有关帐户所需权限的详细信息，请参见 [第 19.3.3 节“复制权限检查”](replication-privilege-checks.html
    "19.3.3 复制权限检查")。当重新启动复制通道时，权限检查将从那一点开始应用。如果您不指定通道且没有其他通道存在，则该语句将应用于默认通道。
- en: 'The use of row-based binary logging is strongly recommended when `PRIVILEGE_CHECKS_USER`
    is set, and you can set `REQUIRE_ROW_FORMAT` to enforce this. For example, to
    start privilege checks on the channel `channel_1` on a running replica, issue
    the following statements:'
  id: totrans-56
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当设置了 `PRIVILEGE_CHECKS_USER` 时，强烈建议使用基于行的二进制日志记录，并且您可以设置 `REQUIRE_ROW_FORMAT`
    来强制执行此操作。例如，要在运行中的副本上启动通道 `channel_1` 上的权限检查，请发出以下语句：
- en: '[PRE3]'
  id: totrans-57
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '[`RELAY_LOG_FILE = ''*`relay_log_file`*''`](change-replication-source-to.html#crs-opt-relay_log_file)
    , [`RELAY_LOG_POS = ''*`relay_log_pos`*''`](change-replication-source-to.html#crs-opt-relay_log_file)'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`RELAY_LOG_FILE = ''*`relay_log_file`*''`](change-replication-source-to.html#crs-opt-relay_log_file)，[`RELAY_LOG_POS
    = ''*`relay_log_pos`*''`](change-replication-source-to.html#crs-opt-relay_log_file)'
- en: The relay log file name, and the location in that file, at which the replication
    SQL thread begins reading from the replica's relay log the next time the thread
    starts. `RELAY_LOG_FILE` can use either an absolute or relative path, and uses
    the same base name as `SOURCE_LOG_FILE`. The maximum length of the string value
    is 511 characters.
  id: totrans-59
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 中继日志文件名及文件中的位置，在该位置，复制 SQL 线程在下次启动时开始从副本的中继日志中读取的位置。`RELAY_LOG_FILE` 可以使用绝对路径或相对路径，并且使用与
    `SOURCE_LOG_FILE` 相同的基本名称。字符串值的最大长度为 511 个字符。
- en: A `CHANGE REPLICATION SOURCE TO` statement using `RELAY_LOG_FILE`, `RELAY_LOG_POS`,
    or both options can be executed on a running replica when the replication SQL
    (applier) thread is stopped. Relay logs are preserved if at least one of the replication
    applier thread and the replication I/O (receiver) thread is running. If both threads
    are stopped, all relay log files are deleted unless at least one of `RELAY_LOG_FILE`
    or `RELAY_LOG_POS` is specified. For the Group Replication applier channel (`group_replication_applier`),
    which only has an applier thread and no receiver thread, this is the case if the
    applier thread is stopped, but with that channel you cannot use the `RELAY_LOG_FILE`
    and `RELAY_LOG_POS` options.
  id: totrans-60
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当复制 SQL（应用程序）线程停止时，可以在运行中的副本上执行一个使用 `RELAY_LOG_FILE`、`RELAY_LOG_POS` 或两者选项的
    `CHANGE REPLICATION SOURCE TO` 语句。如果至少有一个复制应用程序线程和复制 I/O（接收器）线程正在运行，则中继日志将被保留。如果两个线程都停止，则除非至少指定一个
    `RELAY_LOG_FILE` 或 `RELAY_LOG_POS`，否则所有中继日志文件都将被删除。对于仅具有应用程序线程而没有接收器线程的 Group
    Replication 应用程序通道（`group_replication_applier`），如果应用程序线程停止，但是对于该通道，您不能使用 `RELAY_LOG_FILE`
    和 `RELAY_LOG_POS` 选项。
- en: '[`REQUIRE_ROW_FORMAT = {0|1}`](change-replication-source-to.html#crs-opt-require_row_format)'
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`REQUIRE_ROW_FORMAT = {0|1}`](change-replication-source-to.html#crs-opt-require_row_format)'
- en: Permits only row-based replication events to be processed by the replication
    channel. This option prevents the replication applier from taking actions such
    as creating temporary tables and executing `LOAD DATA INFILE` requests, which
    increases the security of the channel. The `REQUIRE_ROW_FORMAT` option is disabled
    by default for asynchronous replication channels, but it is enabled by default
    for Group Replication channels, and it cannot be disabled for them. For more information,
    see [Section 19.3.3, “Replication Privilege Checks”](replication-privilege-checks.html
    "19.3.3 Replication Privilege Checks"). `REQUIRE_ROW_FORMAT` is available as of
    MySQL 8.0.19.
  id: totrans-62
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 仅允许处理基于行的复制事件的复制通道。此选项阻止复制应用程序执行诸如创建临时表和执行`LOAD DATA INFILE`请求等操作，从而增加了通道的安全性。对于异步复制通道，默认情况下禁用`REQUIRE_ROW_FORMAT`选项，但对于组复制通道，默认情况下启用，并且无法禁用。有关更多信息，请参见[第19.3.3节，“复制权限检查”](replication-privilege-checks.html
    "19.3.3 复制权限检查")。`REQUIRE_ROW_FORMAT`从MySQL 8.0.19开始提供。
- en: '[`REQUIRE_TABLE_PRIMARY_KEY_CHECK = {STREAM | ON | OFF | GENERATE}`](change-replication-source-to.html#crs-opt-require_table_primary_key_check)'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`REQUIRE_TABLE_PRIMARY_KEY_CHECK = {STREAM | ON | OFF | GENERATE}`](change-replication-source-to.html#crs-opt-require_table_primary_key_check)'
- en: 'Available as of MySQL 8.0.20, this option lets a replica set its own policy
    for primary key checks, as follows:'
  id: totrans-64
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 从MySQL 8.0.20开始提供，此选项允许复制品设置自己的主键检查策略，如下：
- en: '`ON`: The replica sets [`sql_require_primary_key = ON`](server-system-variables.html#sysvar_sql_require_primary_key);
    any replicated [`CREATE TABLE`](create-table.html "15.1.20 CREATE TABLE Statement")
    or [`ALTER TABLE`](alter-table.html "15.1.9 ALTER TABLE Statement") statement
    must result in a table that contains a primary key.'
  id: totrans-65
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ON`：复制品设置[`sql_require_primary_key = ON`](server-system-variables.html#sysvar_sql_require_primary_key)；任何复制的[`CREATE
    TABLE`](create-table.html "15.1.20 CREATE TABLE Statement")或[`ALTER TABLE`](alter-table.html
    "15.1.9 ALTER TABLE Statement")语句必须生成包含主键的表。'
- en: '`OFF`: The replica sets `sql_require_primary_key = OFF`; no replicated `CREATE
    TABLE` or `ALTER TABLE` statement is checked for the presence of a primary key.'
  id: totrans-66
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`OFF`：复制品设置`sql_require_primary_key = OFF`；不会检查任何复制的`CREATE TABLE`或`ALTER TABLE`语句是否存在主键。'
- en: '`STREAM`: The replica uses whatever value of `sql_require_primary_key` is replicated
    from the source for each transaction. This is the default value, and the default
    behavior.'
  id: totrans-67
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`STREAM`：复制品使用从源复制的`sql_require_primary_key`的任何值来处理每个事务。这是默认值和默认行为。'
- en: '`GENERATE`: Added in MySQL 8.0.32, this causes the replica to generate an invisible
    primary key for any [`InnoDB`](innodb-storage-engine.html "Chapter 17 The InnoDB
    Storage Engine") table that, as replicated, lacks a primary key. See [Section 15.1.20.11,
    “Generated Invisible Primary Keys”](create-table-gipks.html "15.1.20.11 Generated
    Invisible Primary Keys"), for more information.'
  id: totrans-68
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`GENERATE`：在MySQL 8.0.32中添加，这会导致复制品为任何缺少主键的[`InnoDB`](innodb-storage-engine.html
    "第17章 InnoDB存储引擎")表生成一个不可见的主键。有关更多信息，请参见[第15.1.20.11节，“生成的不可见主键”](create-table-gipks.html
    "15.1.20.11 生成的不可见主键")。'
- en: '`GENERATE` is not compatible with Group Replication; you can use `ON`, `OFF`,
    or `STREAM`.'
  id: totrans-69
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`GENERATE`与组复制不兼容；您可以使用`ON`、`OFF`或`STREAM`。'
- en: A divergence based on the presence of a generated invisible primary key solely
    on a source or replica table is supported by MySQL Replication as long as the
    source supports GIPKs (MySQL 8.0.30 and later) and the replica uses MySQL version
    8.0.32 or later. If you use GIPKs on a replica and replicate from a source using
    MySQL 8.0.29 or earlier, you should be aware that in this case such divergences
    in schema, other than the extra GIPK on the replica, are not supported and may
    result in replication errors.
  id: totrans-70
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 基于源或复制品表上仅存在生成的不可见主键的差异得到MySQL复制支持，只要源支持GIPKs（MySQL 8.0.30及更高版本），而复制品使用MySQL版本8.0.32或更高版本。如果在复制品上使用GIPKs并从使用MySQL
    8.0.29或更早版本的源进行复制，则应注意，在这种情况下，除了复制品上的额外GIPK之外，不支持模式中的这种差异，并且可能导致复制错误。
- en: For multisource replication, setting `REQUIRE_TABLE_PRIMARY_KEY_CHECK` to `ON`
    or `OFF` lets the replica normalize behavior across replication channels for different
    sources, and to keep a consistent setting for [`sql_require_primary_key`](server-system-variables.html#sysvar_sql_require_primary_key).
    Using `ON` safeguards against the accidental loss of primary keys when multiple
    sources update the same set of tables. Using `OFF` lets sources that can manipulate
    primary keys to work alongside sources that cannot.
  id: totrans-71
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对于多源复制，将`REQUIRE_TABLE_PRIMARY_KEY_CHECK`设置为`ON`或`OFF`可以使副本在不同源的复制通道之间规范化行为，并为[`sql_require_primary_key`](server-system-variables.html#sysvar_sql_require_primary_key)保持一致的设置。使用`ON`可以防止在多个源更新相同的表集时意外丢失主键。使用`OFF`可以让可以操作主键的源与不能操作主键的源一起工作。
- en: In the case of multiple replicas, when `REQUIRE_TABLE_PRIMARY_KEY_CHECK` is
    set to `GENERATE`, the generated invisible primary key added by a given replica
    is independent of any such key added on any other replica. This means that, if
    generated invisible primary keys are in use, the values in the generated primary
    key columns on different replicas are not guaranteed to be the same. This may
    be an issue when failing over to such a replica.
  id: totrans-72
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在多个副本的情况下，当`REQUIRE_TABLE_PRIMARY_KEY_CHECK`设置为`GENERATE`时，给定副本添加的生成的不可见主键与其他副本上添加的任何此类键是独立的。这意味着，如果使用生成的不可见主键，不同副本上生成的主键列中的值不能保证相同。当故障转移到这样的副本时，这可能是一个问题。
- en: When `PRIVILEGE_CHECKS_USER` is `NULL` (the default), the user account does
    not need administration level privileges to set restricted session variables.
    Setting this option to a value other than `NULL` means that, when `REQUIRE_TABLE_PRIMARY_KEY_CHECK`
    is `ON`, `OFF`, or `GENERATE`, the user account does not require session administration
    level privileges to set restricted session variables such as [`sql_require_primary_key`](server-system-variables.html#sysvar_sql_require_primary_key),
    avoiding the need to grant the account such privileges. For more information,
    see [Section 19.3.3, “Replication Privilege Checks”](replication-privilege-checks.html
    "19.3.3 Replication Privilege Checks").
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当`PRIVILEGE_CHECKS_USER`为`NULL`（默认值）时，用户帐户不需要管理级别权限来设置受限制的会话变量。将此选项设置为`NULL`以外的值意味着，当`REQUIRE_TABLE_PRIMARY_KEY_CHECK`为`ON`，`OFF`或`GENERATE`时，用户帐户不需要会话管理级别权限来设置受限制的会话变量，如[`sql_require_primary_key`](server-system-variables.html#sysvar_sql_require_primary_key)，避免需要授予帐户此类权限。有关更多信息，请参见[第19.3.3节，“复制权限检查”](replication-privilege-checks.html
    "19.3.3 复制权限检查")。
- en: '[`SOURCE_AUTO_POSITION = {0|1}`](change-replication-source-to.html#crs-opt-source_auto_position)'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`SOURCE_AUTO_POSITION = {0|1}`](change-replication-source-to.html#crs-opt-source_auto_position)'
- en: Makes the replica attempt to connect to the source using the auto-positioning
    feature of GTID-based replication, rather than a binary log file based position.
    This option is used to start a replica using GTID-based replication. The default
    is 0, meaning that GTID auto-positioning and GTID-based replication are not used.
    This option can be used with `CHANGE REPLICATION SOURCE TO` only if both the replication
    SQL (applier) thread and replication I/O (receiver) thread are stopped.
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使副本尝试使用基于GTID的复制的自动定位功能连接到源，而不是基于二进制日志文件的位置。此选项用于启动使用基于GTID的复制的副本。默认值为0，表示不使用GTID自动定位和基于GTID的复制。只有在停止复制SQL（应用程序）线程和复制I/O（接收器）线程时，才能将此选项与`CHANGE
    REPLICATION SOURCE TO`一起使用。
- en: Both the replica and the source must have GTIDs enabled ([`GTID_MODE=ON`](replication-options-gtids.html#sysvar_gtid_mode),
    `ON_PERMISSIVE,` or `OFF_PERMISSIVE` on the replica, and [`GTID_MODE=ON`](replication-options-gtids.html#sysvar_gtid_mode)
    on the source). `SOURCE_LOG_FILE`, `SOURCE_LOG_POS`, `RELAY_LOG_FILE`, and `RELAY_LOG_POS`
    cannot be specified together with `SOURCE_AUTO_POSITION = 1`. If multi-source
    replication is enabled on the replica, you need to set the `SOURCE_AUTO_POSITION
    = 1` option for each applicable replication channel.
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 副本和源都必须启用GTIDs（[`GTID_MODE=ON`](replication-options-gtids.html#sysvar_gtid_mode)，在副本上为`ON_PERMISSIVE`或`OFF_PERMISSIVE`，在源上为[`GTID_MODE=ON`](replication-options-gtids.html#sysvar_gtid_mode)）。`SOURCE_LOG_FILE`，`SOURCE_LOG_POS`，`RELAY_LOG_FILE`和`RELAY_LOG_POS`不能与`SOURCE_AUTO_POSITION
    = 1`一起指定。如果在副本上启用了多源复制，则需要为每个适用的复制通道设置`SOURCE_AUTO_POSITION = 1`选项。
- en: With `SOURCE_AUTO_POSITION = 1` set, in the initial connection handshake, the
    replica sends a GTID set containing the transactions that it has already received,
    committed, or both. The source responds by sending all transactions recorded in
    its binary log whose GTID is not included in the GTID set sent by the replica.
    This exchange ensures that the source only sends the transactions with a GTID
    that the replica has not already recorded or committed. If the replica receives
    transactions from more than one source, as in the case of a diamond topology,
    the auto-skip function ensures that the transactions are not applied twice. For
    details of how the GTID set sent by the replica is computed, see [Section 19.1.3.3,
    “GTID Auto-Positioning”](replication-gtids-auto-positioning.html "19.1.3.3 GTID
    Auto-Positioning").
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 设置`SOURCE_AUTO_POSITION = 1`后，在初始连接握手中，副本发送一个包含其已接收、已提交或两者都包含的事务的GTID集。源端通过发送其二进制日志中所有GTID不包含在副本发送的GTID集中的事务来做出响应。这种交换确保源端只发送副本尚未记录或提交的具有GTID的事务。如果副本从多个源接收事务，如钻石拓扑结构的情况，自动跳过功能确保事务不会被应用两次。有关副本发送的GTID集如何计算的详细信息，请参见[第19.1.3.3节，“GTID自动定位”](replication-gtids-auto-positioning.html
    "19.1.3.3 GTID Auto-Positioning")。
- en: If any of the transactions that should be sent by the source have been purged
    from the source's binary log, or added to the set of GTIDs in the [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)
    system variable by another method, the source sends the error [`ER_MASTER_HAS_PURGED_REQUIRED_GTIDS`](/doc/mysql-errors/8.0/en/server-error-reference.html#error_er_master_has_purged_required_gtids)
    to the replica, and replication does not start. The GTIDs of the missing purged
    transactions are identified and listed in the source's error log in the warning
    message [`ER_FOUND_MISSING_GTIDS`](/doc/mysql-errors/8.0/en/server-error-reference.html#error_er_found_missing_gtids).
    Also, if during the exchange of transactions it is found that the replica has
    recorded or committed transactions with the source's UUID in the GTID, but the
    source itself has not committed them, the source sends the error [`ER_SLAVE_HAS_MORE_GTIDS_THAN_MASTER`](/doc/mysql-errors/8.0/en/server-error-reference.html#error_er_slave_has_more_gtids_than_master)
    to the replica and replication does not start. For information on how to handle
    these situations, see [Section 19.1.3.3, “GTID Auto-Positioning”](replication-gtids-auto-positioning.html
    "19.1.3.3 GTID Auto-Positioning").
  id: totrans-78
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果应该由源端发送的任何事务已从源端的二进制日志中清除，或者通过其他方法添加到[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)系统变量的GTID集中，源端将向副本发送错误[`ER_MASTER_HAS_PURGED_REQUIRED_GTIDS`](/doc/mysql-errors/8.0/en/server-error-reference.html#error_er_master_has_purged_required_gtids)，并且复制不会启动。缺失的已清除事务的GTID将在源端的错误日志中被识别并列在警告消息[`ER_FOUND_MISSING_GTIDS`](/doc/mysql-errors/8.0/en/server-error-reference.html#error_er_found_missing_gtids)中。此外，如果在事务交换过程中发现副本已记录或提交具有源端UUID的GTID的事务，但源端本身尚未提交它们，则源端将向副本发送错误[`ER_SLAVE_HAS_MORE_GTIDS_THAN_MASTER`](/doc/mysql-errors/8.0/en/server-error-reference.html#error_er_slave_has_more_gtids_than_master)，并且复制不会启动。有关如何处理这些情况的信息，请参见[第19.1.3.3节，“GTID自动定位”](replication-gtids-auto-positioning.html
    "19.1.3.3 GTID Auto-Positioning")。
- en: You can see whether replication is running with GTID auto-positioning enabled
    by checking the Performance Schema [`replication_connection_status`](performance-schema-replication-connection-status-table.html
    "29.12.11.2 The replication_connection_status Table") table or the output of [`SHOW
    REPLICA STATUS`](show-replica-status.html "15.7.7.35 SHOW REPLICA STATUS Statement").
    Disabling the `SOURCE_AUTO_POSITION` option again makes the replica revert to
    file-based replication.
  id: totrans-79
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您可以通过检查性能模式[`replication_connection_status`](performance-schema-replication-connection-status-table.html
    "29.12.11.2 The replication_connection_status Table")表或[`SHOW REPLICA STATUS`](show-replica-status.html
    "15.7.7.35 SHOW REPLICA STATUS Statement")语句的输出来查看是否启用了GTID自动定位的复制。再次禁用`SOURCE_AUTO_POSITION`选项会使副本恢复到基于文件的复制。
- en: '[`SOURCE_BIND = ''*`interface_name`*''`](change-replication-source-to.html#crs-opt-source_bind)'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`SOURCE_BIND = ''*`interface_name`*''`](change-replication-source-to.html#crs-opt-source_bind)'
- en: Determines which of the replica's network interfaces is chosen for connecting
    to the source, for use on replicas that have multiple network interfaces. Specify
    the IP address of the network interface. The maximum length of the string value
    is 255 characters.
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 确定副本的哪个网络接口被选择用于连接到源端，适用于具有多个网络接口的副本。指定网络接口的IP地址。字符串值的最大长度为255个字符。
- en: The IP address configured with this option, if any, can be seen in the `Source_Bind`
    column of the output from [`SHOW REPLICA STATUS`](show-replica-status.html "15.7.7.35 SHOW
    REPLICA STATUS Statement"). In the source metadata repository table `mysql.slave_master_info`,
    the value can be seen as the `Source_bind` column. The ability to bind a replica
    to a specific network interface is also supported by NDB Cluster.
  id: totrans-82
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 配置此选项的IP地址（如果有）可以在[`SHOW REPLICA STATUS`](show-replica-status.html "15.7.7.35
    SHOW REPLICA STATUS Statement")输出的`Source_Bind`列中看到。在源元数据存储库表`mysql.slave_master_info`中，该值可以在`Source_bind`列中看到。将副本绑定到特定网络接口的能力也受到NDB
    Cluster的支持。
- en: '[`SOURCE_COMPRESSION_ALGORITHMS = ''*`algorithm`*[,*`algorithm`*][,*`algorithm`*]''`](change-replication-source-to.html#crs-opt-source_compression_algorithms)'
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`SOURCE_COMPRESSION_ALGORITHMS = ''*`algorithm`*[,*`algorithm`*][,*`algorithm`*]''`](change-replication-source-to.html#crs-opt-source_compression_algorithms)'
- en: Specifies one, two, or three of the permitted compression algorithms for connections
    to the replication source server, separated by commas. The maximum length of the
    string value is 99 characters. The default value is `uncompressed`.
  id: totrans-84
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 指定连接到复制源服务器的允许压缩算法之一、两个或三个，用逗号分隔。字符串值的最大长度为99个字符。默认值为`uncompressed`。
- en: The available algorithms are `zlib`, `zstd`, and `uncompressed`, the same as
    for the [`protocol_compression_algorithms`](server-system-variables.html#sysvar_protocol_compression_algorithms)
    system variable. The algorithms can be specified in any order, but it is not an
    order of preference - the algorithm negotiation process attempts to use `zlib`,
    then `zstd`, then `uncompressed`, if they are specified. `SOURCE_COMPRESSION_ALGORITHMS`
    is available as of MySQL 8.0.18.
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 可用的算法是`zlib`、`zstd`和`uncompressed`，与[`protocol_compression_algorithms`](server-system-variables.html#sysvar_protocol_compression_algorithms)系统变量相同。算法可以以任何顺序指定，但这不是优先顺序
    - 算法协商过程尝试使用`zlib`，然后`zstd`，然后`uncompressed`，如果它们被指定。`SOURCE_COMPRESSION_ALGORITHMS`自MySQL
    8.0.18起可用。
- en: The value of `SOURCE_COMPRESSION_ALGORITHMS` applies only if the [`replica_compressed_protocol`](replication-options-replica.html#sysvar_replica_compressed_protocol)
    or [`slave_compressed_protocol`](replication-options-replica.html#sysvar_slave_compressed_protocol)
    system variable is disabled. If [`replica_compressed_protocol`](replication-options-replica.html#sysvar_replica_compressed_protocol)
    or [`slave_compressed_protocol`](replication-options-replica.html#sysvar_slave_compressed_protocol)
    is enabled, it takes precedence over `SOURCE_COMPRESSION_ALGORITHMS` and connections
    to the source use `zlib` compression if both source and replica support that algorithm.
    For more information, see [Section 6.2.8, “Connection Compression Control”](connection-compression-control.html
    "6.2.8 Connection Compression Control").
  id: totrans-86
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`SOURCE_COMPRESSION_ALGORITHMS`的值仅在禁用[`replica_compressed_protocol`](replication-options-replica.html#sysvar_replica_compressed_protocol)或[`slave_compressed_protocol`](replication-options-replica.html#sysvar_slave_compressed_protocol)系统变量时适用。如果启用了[`replica_compressed_protocol`](replication-options-replica.html#sysvar_replica_compressed_protocol)或[`slave_compressed_protocol`](replication-options-replica.html#sysvar_slave_compressed_protocol)，它优先于`SOURCE_COMPRESSION_ALGORITHMS`，并且如果源和副本都支持该算法，则连接到源使用`zlib`压缩。有关更多信息，请参见[第6.2.8节，“连接压缩控制”](connection-compression-control.html
    "6.2.8 连接压缩控制")。'
- en: Binary log transaction compression (available as of MySQL 8.0.20), which is
    activated by the [`binlog_transaction_compression`](replication-options-binary-log.html#sysvar_binlog_transaction_compression)
    system variable, can also be used to save bandwidth. If you do this in combination
    with connection compression, connection compression has less opportunity to act
    on the data, but can still compress headers and those events and transaction payloads
    that are uncompressed. For more information on binary log transaction compression,
    see [Section 7.4.4.5, “Binary Log Transaction Compression”](binary-log-transaction-compression.html
    "7.4.4.5 Binary Log Transaction Compression").
  id: totrans-87
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 二进制日志事务压缩（自MySQL 8.0.20起可用），由[`binlog_transaction_compression`](replication-options-binary-log.html#sysvar_binlog_transaction_compression)系统变量激活，也可用于节省带宽。如果与连接压缩结合使用，连接压缩的机会减少，但仍可压缩标头以及未压缩的事件和事务有效载荷。有关二进制日志事务压缩的更多信息，请参见[第7.4.4.5节，“二进制日志事务压缩”](binary-log-transaction-compression.html
    "7.4.4.5 二进制日志事务压缩")。
- en: '[`SOURCE_CONNECT_RETRY = *`interval`*`](change-replication-source-to.html#crs-opt-source_connect_retry)'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`SOURCE_CONNECT_RETRY = *`interval`*`](change-replication-source-to.html#crs-opt-source_connect_retry)'
- en: Specifies the interval in seconds between the reconnection attempts that the
    replica makes after the connection to the source times out. The default interval
    is 60.
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 指定副本在连接到源超时后重新连接尝试之间的秒数间隔。默认间隔为60。
- en: The number of attempts is limited by the `SOURCE_RETRY_COUNT` option. If both
    the default settings are used, the replica waits 60 seconds between reconnection
    attempts (`SOURCE_CONNECT_RETRY=60`), and keeps attempting to reconnect at this
    rate for 60 days (`SOURCE_RETRY_COUNT=86400`). These values are recorded in the
    source metadata repository and shown in the [`replication_connection_configuration`](performance-schema-replication-connection-configuration-table.html
    "29.12.11.1 The replication_connection_configuration Table") Performance Schema
    table.
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 尝试次数受`SOURCE_RETRY_COUNT`选项限制。如果使用默认设置，副本在重新连接尝试之间等待60秒（`SOURCE_CONNECT_RETRY=60`），并以这个速率持续尝试重新连接60天（`SOURCE_RETRY_COUNT=86400`）。这些值记录在源元数据存储库中，并显示在[`replication_connection_configuration`](performance-schema-replication-connection-configuration-table.html
    "29.12.11.1 The replication_connection_configuration Table")性能模式表中。
- en: '[`SOURCE_CONNECTION_AUTO_FAILOVER = {0|1}`](change-replication-source-to.html#crs-opt-source_connection_auto_failover)'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`SOURCE_CONNECTION_AUTO_FAILOVER = {0|1}`](change-replication-source-to.html#crs-opt-source_connection_auto_failover)'
- en: Activates the asynchronous connection failover mechanism for a replication channel
    if one or more alternative replication source servers are available (so when there
    are multiple MySQL servers or groups of servers that share the replicated data).
    `SOURCE_CONNECTION_AUTO_FAILOVER` is available as of MySQL 8.0.22\. The default
    is 0, meaning that the mechanism is not activated. For full information and instructions
    to set up this feature, see [Section 19.4.9.2, “Asynchronous Connection Failover
    for Replicas”](replication-asynchronous-connection-failover-replica.html "19.4.9.2 Asynchronous
    Connection Failover for Replicas").
  id: totrans-92
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果有一个或多个备用复制源服务器可用（即有多个共享复制数据的MySQL服务器或服务器组），则为复制通道激活异步连接故障转移机制。`SOURCE_CONNECTION_AUTO_FAILOVER`从MySQL
    8.0.22版本开始提供。默认值为0，表示未激活该机制。有关完整信息和设置此功能的说明，请参阅[第19.4.9.2节，“副本的异步连接故障转移”](replication-asynchronous-connection-failover-replica.html
    "19.4.9.2 Asynchronous Connection Failover for Replicas")。
- en: The asynchronous connection failover mechanism takes over after the reconnection
    attempts controlled by `SOURCE_CONNECT_RETRY` and `SOURCE_RETRY_COUNT` are exhausted.
    It reconnects the replica to an alternative source chosen from a specified source
    list, which you manage using the [`asynchronous_connection_failover_add_source`](replication-functions-async-failover.html#function_asynchronous-connection-failover-add-source)
    and [`asynchronous_connection_failover_delete_source`](replication-functions-async-failover.html#function_asynchronous-connection-failover-delete-source)
    functions. To add and remove managed groups of servers, use the [`asynchronous_connection_failover_add_managed`](replication-functions-async-failover.html#function_asynchronous-connection-failover-add-managed)
    and [`asynchronous_connection_failover_delete_managed`](replication-functions-async-failover.html#function_asynchronous-connection-failover-delete-managed)
    functions instead. For more information, see [Section 19.4.9, “Switching Sources
    and Replicas with Asynchronous Connection Failover”](replication-asynchronous-connection-failover.html
    "19.4.9 Switching Sources and Replicas with Asynchronous Connection Failover").
  id: totrans-93
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在由`SOURCE_CONNECT_RETRY`和`SOURCE_RETRY_COUNT`控制的重新连接尝试耗尽后，异步连接故障转移机制接管。它将副本重新连接到从指定源列表中选择的备用源，您可以使用[`asynchronous_connection_failover_add_source`](replication-functions-async-failover.html#function_asynchronous-connection-failover-add-source)和[`asynchronous_connection_failover_delete_source`](replication-functions-async-failover.html#function_asynchronous-connection-failover-delete-source)函数进行管理。要添加和删除受管理的服务器组，请改用[`asynchronous_connection_failover_add_managed`](replication-functions-async-failover.html#function_asynchronous-connection-failover-add-managed)和[`asynchronous_connection_failover_delete_managed`](replication-functions-async-failover.html#function_asynchronous-connection-failover-delete-managed)函数。有关更多信息，请参阅[第19.4.9节，“使用异步连接故障转移切换源和副本”](replication-asynchronous-connection-failover.html
    "19.4.9 Switching Sources and Replicas with Asynchronous Connection Failover")。
- en: Important
  id: totrans-94
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 重要提示
- en: You can only set `SOURCE_CONNECTION_AUTO_FAILOVER = 1` when GTID auto-positioning
    is in use (`SOURCE_AUTO_POSITION = 1`).
  id: totrans-95
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 只有在使用GTID自动定位时（`SOURCE_AUTO_POSITION = 1`）才能设置`SOURCE_CONNECTION_AUTO_FAILOVER
    = 1`。
- en: When you set `SOURCE_CONNECTION_AUTO_FAILOVER = 1`, set `SOURCE_RETRY_COUNT`
    and `SOURCE_CONNECT_RETRY` to minimal numbers that just allow a few retry attempts
    with the same source, in case the connection failure is caused by a transient
    network outage. Otherwise the asynchronous connection failover mechanism cannot
    be activated promptly. Suitable values are `SOURCE_RETRY_COUNT=3` and `SOURCE_CONNECT_RETRY=10`,
    which make the replica retry the connection 3 times with 10-second intervals between.
  id: totrans-96
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当你设置 `SOURCE_CONNECTION_AUTO_FAILOVER = 1` 时，将 `SOURCE_RETRY_COUNT` 和 `SOURCE_CONNECT_RETRY`
    设置为最小值，只允许几次重试尝试与相同源进行连接，以防连接失败是由瞬时网络中断引起的。否则，异步连接故障转移机制无法及时激活。适当的值是 `SOURCE_RETRY_COUNT=3`
    和 `SOURCE_CONNECT_RETRY=10`，这使得副本在每次连接尝试之间间隔 10 秒的情况下重试连接 3 次。
- en: When you set `SOURCE_CONNECTION_AUTO_FAILOVER = 1`, the replication metadata
    repositories must contain the credentials for a replication user account that
    can be used to connect to all the servers on the source list for the replication
    channel. The account must also have `SELECT` permissions on the Performance Schema
    tables. These credentials can be set using the [`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 CHANGE REPLICATION SOURCE TO Statement") statement with the `SOURCE_USER`
    and `SOURCE_PASSWORD` options. For more information, see [Section 19.4.9, “Switching
    Sources and Replicas with Asynchronous Connection Failover”](replication-asynchronous-connection-failover.html
    "19.4.9 Switching Sources and Replicas with Asynchronous Connection Failover").
  id: totrans-97
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当你设置 `SOURCE_CONNECTION_AUTO_FAILOVER = 1` 时，复制元数据存储库必须包含用于连接到复制通道源列表中所有服务器的复制用户帐户的凭据。该帐户还必须对性能模式表具有
    `SELECT` 权限。这些凭据可以使用带有 `SOURCE_USER` 和 `SOURCE_PASSWORD` 选项的 [`CHANGE REPLICATION
    SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION SOURCE
    TO Statement") 语句进行设置。有关更多信息，请参见 [第 19.4.9 节，“使用异步连接故障转移切换源和副本”](replication-asynchronous-connection-failover.html
    "19.4.9 使用异步连接故障转移切换源和副本")。
- en: From MySQL 8.0.27, when you set `SOURCE_CONNECTION_AUTO_FAILOVER = 1`, asynchronous
    connection failover for replicas is automatically activated if this replication
    channel is on a Group Replication primary in a group in single-primary mode. With
    this function active, if the primary that is replicating goes offline or into
    an error state, the new primary starts replication on the same channel when it
    is elected. If you want to use the function, this replication channel must also
    be set up on all the secondary servers in the replication group, and on any new
    joining members. (If the servers are provisioned using MySQL’s clone functionality,
    this all happens automatically.) If you do not want to use the function, disable
    it by using the [`group_replication_disable_member_action()`](group-replication-functions-for-member-actions.html#function_group-replication-disable-member-action)
    function to disable the Group Replication member action `mysql_start_failover_channels_if_primary`,
    which is enabled by default. For more information, see [Section 19.4.9.2, “Asynchronous
    Connection Failover for Replicas”](replication-asynchronous-connection-failover-replica.html
    "19.4.9.2 Asynchronous Connection Failover for Replicas").
  id: totrans-98
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从 MySQL 8.0.27 开始，当你设置 `SOURCE_CONNECTION_AUTO_FAILOVER = 1` 时，如果这个复制通道在单主模式下的组复制主节点上，副本的异步连接故障转移将自动激活。启用此功能后，如果正在复制的主节点下线或进入错误状态，新的主节点在选举时将在同一通道上开始复制。如果要使用此功能，这个复制通道还必须在复制组中的所有辅助服务器上设置，并在任何新加入的成员上设置。（如果使用
    MySQL 的克隆功能进行服务器配置，则所有这些都会自动发生。）如果不想使用此功能，请使用 [`group_replication_disable_member_action()`](group-replication-functions-for-member-actions.html#function_group-replication-disable-member-action)
    函数禁用默认启用的 Group Replication 成员操作 `mysql_start_failover_channels_if_primary`。有关更多信息，请参见
    [第 19.4.9.2 节，“副本的异步连接故障转移”](replication-asynchronous-connection-failover-replica.html
    "19.4.9.2 副本的异步连接故障转移")。
- en: '[`SOURCE_DELAY = *`interval`*`](change-replication-source-to.html#crs-opt-source_delay)'
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`SOURCE_DELAY = *`interval`*`](change-replication-source-to.html#crs-opt-source_delay)'
- en: Specifies how many seconds behind the source the replica must lag. An event
    received from the source is not executed until at least *`interval`* seconds later
    than its execution on the source. *`interval`* must be a nonnegative integer in
    the range from 0 to 2^(31)−1\. The default is 0. For more information, see [Section 19.4.11,
    “Delayed Replication”](replication-delayed.html "19.4.11 Delayed Replication").
  id: totrans-100
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 指定副本必须滞后源多少秒。从源接收的事件直到至少延迟*`interval`*秒后才执行。*`interval`*必须是0到2^(31)−1范围内的非负整数。默认值为0。更多信息，请参见[Section 19.4.11,
    “Delayed Replication”](replication-delayed.html "19.4.11 Delayed Replication")。
- en: A `CHANGE REPLICATION SOURCE TO` statement using the `SOURCE_DELAY` option can
    be executed on a running replica when the replication SQL thread is stopped.
  id: totrans-101
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使用`SOURCE_DELAY`选项的`CHANGE REPLICATION SOURCE TO`语句可以在运行中的副本上执行，当复制SQL线程停止时。
- en: '[`SOURCE_HEARTBEAT_PERIOD = *`interval`*`](change-replication-source-to.html#crs-opt-source_heartbeat_period)'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`SOURCE_HEARTBEAT_PERIOD = *`interval`*`](change-replication-source-to.html#crs-opt-source_heartbeat_period)'
- en: Controls the heartbeat interval, which stops the connection timeout occurring
    in the absence of data if the connection is still good. A heartbeat signal is
    sent to the replica after that number of seconds, and the waiting period is reset
    whenever the source's binary log is updated with an event. Heartbeats are therefore
    sent by the source only if there are no unsent events in the binary log file for
    a period longer than this.
  id: totrans-103
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 控制心跳间隔，防止在没有数据的情况下发生连接超时，如果连接仍然良好。在那么多秒后向副本发送心跳信号，并且每当源的二进制日志更新为一个事件时，等待时间就会重置。因此，只有在二进制日志文件中有一段时间没有发送的事件时，源才会发送心跳。
- en: The heartbeat interval *`interval`* is a decimal value having the range 0 to
    4294967 seconds and a resolution in milliseconds; the smallest nonzero value is
    0.001\. Setting *`interval`* to 0 disables heartbeats altogether. The heartbeat
    interval defaults to half the value of the [`replica_net_timeout`](replication-options-replica.html#sysvar_replica_net_timeout)
    or [`slave_net_timeout`](replication-options-replica.html#sysvar_slave_net_timeout)
    system variable. It is recorded in the source metadata repository and shown in
    the [`replication_connection_configuration`](performance-schema-replication-connection-configuration-table.html
    "29.12.11.1 The replication_connection_configuration Table") Performance Schema
    table.
  id: totrans-104
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 心跳间隔*`interval`*是一个十进制值，范围为0到4294967秒，分辨率为毫秒；最小的非零值为0.001。将*`interval`*设置为0会完全禁用心跳。心跳间隔默认为[`replica_net_timeout`](replication-options-replica.html#sysvar_replica_net_timeout)或[`slave_net_timeout`](replication-options-replica.html#sysvar_slave_net_timeout)系统变量值的一半。它记录在源元数据存储库中，并显示在[`replication_connection_configuration`](performance-schema-replication-connection-configuration-table.html
    "29.12.11.1 The replication_connection_configuration Table")性能模式表中。
- en: The system variable [`replica_net_timeout`](replication-options-replica.html#sysvar_replica_net_timeout)
    (from MySQL 8.0.26) or [`slave_net_timeout`](replication-options-replica.html#sysvar_slave_net_timeout)
    (before MySQL 8.0.26) specifies the number of seconds that the replica waits for
    either more data or a heartbeat signal from the source, before the replica considers
    the connection broken, aborts the read, and tries to reconnect. The default value
    is 60 seconds (one minute). Note that a change to the value or default setting
    of [`replica_net_timeout`](replication-options-replica.html#sysvar_replica_net_timeout)
    or [`slave_net_timeout`](replication-options-replica.html#sysvar_slave_net_timeout)
    does not automatically change the heartbeat interval, whether that has been set
    explicitly or is using a previously calculated default. A warning is issued if
    you set the global value of [`replica_net_timeout`](replication-options-replica.html#sysvar_replica_net_timeout)
    or `slave_net_timeout` to a value less than that of the current heartbeat interval.
    If [`replica_net_timeout`](replication-options-replica.html#sysvar_replica_net_timeout)
    or [`slave_net_timeout`](replication-options-replica.html#sysvar_slave_net_timeout)
    is changed, you must also issue [`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 CHANGE REPLICATION SOURCE TO Statement") to adjust the heartbeat interval
    to an appropriate value so that the heartbeat signal occurs before the connection
    timeout. If you do not do this, the heartbeat signal has no effect, and if no
    data is received from the source, the replica can make repeated reconnection attempts,
    creating zombie dump threads.
  id: totrans-105
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 系统变量[`replica_net_timeout`](replication-options-replica.html#sysvar_replica_net_timeout)（从MySQL
    8.0.26开始）或[`slave_net_timeout`](replication-options-replica.html#sysvar_slave_net_timeout)（MySQL
    8.0.26之前）指定副本等待来自源的更多数据或心跳信号的秒数，超过该时间副本将认为连接已中断，中止读取并尝试重新连接。默认值为60秒（一分钟）。请注意，对[`replica_net_timeout`](replication-options-replica.html#sysvar_replica_net_timeout)或[`slave_net_timeout`](replication-options-replica.html#sysvar_slave_net_timeout)的值或默认设置的更改不会自动更改心跳间隔，无论是明确设置还是使用先前计算的默认值。如果将全局值[`replica_net_timeout`](replication-options-replica.html#sysvar_replica_net_timeout)或`slave_net_timeout`设置为小于当前心跳间隔的值，将发出警告。如果更改了[`replica_net_timeout`](replication-options-replica.html#sysvar_replica_net_timeout)或[`slave_net_timeout`](replication-options-replica.html#sysvar_slave_net_timeout)，还必须发出[`CHANGE
    REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION
    SOURCE TO Statement")以将心跳间隔调整为适当的值，以便心跳信号在连接超时之前发生。如果不这样做，心跳信号将不起作用，如果未从源接收到数据，则副本可能会进行重复的重新连接尝试，从而创建僵尸转储线程。
- en: '[`SOURCE_HOST = ''*`host_name`*''`](change-replication-source-to.html#crs-opt-source_host)'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`SOURCE_HOST = ''*`host_name`*''`](change-replication-source-to.html#crs-opt-source_host)'
- en: The host name or IP address of the replication source server. The replica uses
    this to connect to the source. The maximum length of the string value is 255 characters.
  id: totrans-107
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 复制源服务器的主机名或IP地址。副本使用此信息连接到源。字符串值的最大长度为255个字符。
- en: If you specify `SOURCE_HOST` or `SOURCE_PORT`, the replica assumes that the
    source server is different from before (even if the option value is the same as
    its current value.) In this case, the old values for the source's binary log file
    name and position are considered no longer applicable, so if you do not specify
    `SOURCE_LOG_FILE` and `SOURCE_LOG_POS` in the statement, `SOURCE_LOG_FILE=''`
    and `SOURCE_LOG_POS=4` are silently appended to it.
  id: totrans-108
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果您指定了`SOURCE_HOST`或`SOURCE_PORT`，则副本会假定源服务器与之前不同（即使选项值与当前值相同）。在这种情况下，源的二进制日志文件名和位置的旧值被认为不再适用，因此如果您在语句中未指定`SOURCE_LOG_FILE`和`SOURCE_LOG_POS`，则会自动追加`SOURCE_LOG_FILE=''`和`SOURCE_LOG_POS=4`。
- en: Setting `SOURCE_HOST=''` (that is, setting its value explicitly to an empty
    string) is *not* the same as not setting `SOURCE_HOST` at all. Trying to set `SOURCE_HOST`
    to an empty string fails with an error.
  id: totrans-109
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将`SOURCE_HOST=''`设置为（即，将其值明确设置为空字符串）*不*等同于根本不设置`SOURCE_HOST`。尝试将`SOURCE_HOST`设置为空字符串会导致错误。
- en: '[`SOURCE_LOG_FILE = ''*`source_log_name`*''`](change-replication-source-to.html#crs-opt-source_log_file),
    [`SOURCE_LOG_POS = *`source_log_pos`*`](change-replication-source-to.html#crs-opt-source_log_file)'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`SOURCE_LOG_FILE = ''*`source_log_name`*''`](change-replication-source-to.html#crs-opt-source_log_file),
    [`SOURCE_LOG_POS = *`source_log_pos`*`](change-replication-source-to.html#crs-opt-source_log_file)'
- en: The binary log file name, and the location in that file, at which the replication
    I/O (receiver) thread begins reading from the source's binary log the next time
    the thread starts. Specify these options if you are using binary log file position
    based replication.
  id: totrans-111
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 二进制日志文件名以及在该文件中的位置，复制I/O（接收器）线程在下次启动时从源二进制日志中开始读取的位置。如果使用基于二进制日志文件位置的复制，请指定这些选项。
- en: '`SOURCE_LOG_FILE` must include the numeric suffix of a specific binary log
    file that is available on the source server, for example, `SOURCE_LOG_FILE=''binlog.000145''`.
    The maximum length of the string value is 511 characters.'
  id: totrans-112
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`SOURCE_LOG_FILE`必须包括源服务器上可用的特定二进制日志文件的数字后缀，例如，`SOURCE_LOG_FILE=''binlog.000145''`。字符串值的最大长度为511个字符。'
- en: '`SOURCE_LOG_POS` is the numeric position for the replica to start reading in
    that file. `SOURCE_LOG_POS=4` represents the start of the events in a binary log
    file.'
  id: totrans-113
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`SOURCE_LOG_POS`是副本在该文件中开始读取的数字位置。`SOURCE_LOG_POS=4`表示二进制日志文件中事件的开始。'
- en: If you specify either of `SOURCE_LOG_FILE` or `SOURCE_LOG_POS`, you cannot specify
    `SOURCE_AUTO_POSITION = 1`, which is for GTID-based replication.
  id: totrans-114
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果指定了`SOURCE_LOG_FILE`或`SOURCE_LOG_POS`中的任一个，则不能指定`SOURCE_AUTO_POSITION = 1`，该选项用于基于GTID的复制。
- en: If neither of `SOURCE_LOG_FILE` or `SOURCE_LOG_POS` is specified, the replica
    uses the last coordinates of the *replication SQL thread* before `CHANGE REPLICATION
    SOURCE TO` was issued. This ensures that there is no discontinuity in replication,
    even if the replication SQL (applier) thread was late compared to the replication
    I/O (receiver) thread.
  id: totrans-115
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果未指定`SOURCE_LOG_FILE`或`SOURCE_LOG_POS`中的任何一个，则副本使用*复制SQL线程*在发出`CHANGE REPLICATION
    SOURCE TO`之前的最后坐标。这确保了即使复制SQL（应用程序）线程比复制I/O（接收器）线程晚，复制也不会出现不连续。
- en: '[`SOURCE_PASSWORD = ''*`password`*''`](change-replication-source-to.html#crs-opt-source_password)'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`SOURCE_PASSWORD = ''*`password`*''`](change-replication-source-to.html#crs-opt-source_password)'
- en: The password for the replication user account to use for connecting to the replication
    source server. The maximum length of the string value is 32 characters. If you
    specify `SOURCE_PASSWORD`, `SOURCE_USER` is also required.
  id: totrans-117
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 用于连接到复制源服务器的复制用户帐户的密码。字符串值的最大长度为32个字符。如果指定了`SOURCE_PASSWORD`，则还需要`SOURCE_USER`。
- en: The password used for a replication user account in a `CHANGE REPLICATION SOURCE
    TO` statement is limited to 32 characters in length. Trying to use a password
    of more than 32 characters causes `CHANGE REPLICATION SOURCE TO` to fail.
  id: totrans-118
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在`CHANGE REPLICATION SOURCE TO`语句中用于复制用户帐户的密码长度限制为32个字符。尝试使用超过32个字符的密码会导致`CHANGE
    REPLICATION SOURCE TO`失败。
- en: The password is masked in MySQL Server’s logs, Performance Schema tables, and
    [`SHOW PROCESSLIST`](show-processlist.html "15.7.7.29 SHOW PROCESSLIST Statement")
    statements.
  id: totrans-119
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 密码在MySQL Server的日志、性能模式表和[`SHOW PROCESSLIST`](show-processlist.html "15.7.7.29 SHOW
    PROCESSLIST Statement")语句中被掩盖。
- en: '[`SOURCE_PORT = *`port_num`*`](change-replication-source-to.html#crs-opt-source_port)'
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`SOURCE_PORT = *`port_num`*`](change-replication-source-to.html#crs-opt-source_port)'
- en: The TCP/IP port number that the replica uses to connect to the replication source
    server.
  id: totrans-121
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 副本用于连接到复制源服务器的TCP/IP端口号。
- en: Note
  id: totrans-122
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意
- en: Replication cannot use Unix socket files. You must be able to connect to the
    replication source server using TCP/IP.
  id: totrans-123
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 复制不能使用Unix套接字文件。您必须能够使用TCP/IP连接到复制源服务器。
- en: If you specify `SOURCE_HOST` or `SOURCE_PORT`, the replica assumes that the
    source server is different from before (even if the option value is the same as
    its current value.) In this case, the old values for the source's binary log file
    name and position are considered no longer applicable, so if you do not specify
    `SOURCE_LOG_FILE` and `SOURCE_LOG_POS` in the statement, `SOURCE_LOG_FILE=''`
    and `SOURCE_LOG_POS=4` are silently appended to it.
  id: totrans-124
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果指定了`SOURCE_HOST`或`SOURCE_PORT`，则副本会假定源服务器与以前不同（即使选项值与当前值相同）。在这种情况下，源二进制日志文件名和位置的旧值被认为不再适用，因此如果在语句中不指定`SOURCE_LOG_FILE`和`SOURCE_LOG_POS`，则会自动附加`SOURCE_LOG_FILE=''`和`SOURCE_LOG_POS=4`。
- en: '[`SOURCE_PUBLIC_KEY_PATH = ''*`key_file_name`*''`](change-replication-source-to.html#crs-opt-source_public_key_path)'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`SOURCE_PUBLIC_KEY_PATH = ''*`key_file_name`*''`](change-replication-source-to.html#crs-opt-source_public_key_path)'
- en: Enables RSA key pair-based password exchange by providing the path name to a
    file containing a replica-side copy of the public key required by the source.
    The file must be in PEM format. The maximum length of the string value is 511
    characters.
  id: totrans-126
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 通过提供包含源端所需的公钥副本的文件路径名，启用基于RSA密钥对的密码交换。文件必须采用PEM格式。字符串值的最大长度为511个字符。
- en: This option applies to replicas that authenticate with the `sha256_password`
    or `caching_sha2_password` authentication plugin. (For `sha256_password`, `SOURCE_PUBLIC_KEY_PATH`
    can be used only if MySQL was built using OpenSSL.) If you are using a replication
    user account that authenticates with the `caching_sha2_password` plugin (which
    is the default from MySQL 8.0), and you are not using a secure connection, you
    must specify either this option or the `GET_SOURCE_PUBLIC_KEY=1` option to provide
    the RSA public key to the replica.
  id: totrans-127
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此选项适用于使用`sha256_password`或`caching_sha2_password`认证插件进行身份验证的副本。（对于`sha256_password`，只有在使用OpenSSL构建MySQL时才能使用`SOURCE_PUBLIC_KEY_PATH`。）如果您正在使用使用`caching_sha2_password`插件进行身份验证的复制用户帐户（这是MySQL
    8.0的默认设置），并且您没有使用安全连接，则必须指定此选项或`GET_SOURCE_PUBLIC_KEY=1`选项之一以向副本提供RSA公钥。
- en: '[`SOURCE_RETRY_COUNT = *`count`*`](change-replication-source-to.html#crs-opt-source_retry_count)'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`SOURCE_RETRY_COUNT = *`count`*`](change-replication-source-to.html#crs-opt-source_retry_count)'
- en: Sets the maximum number of reconnection attempts that the replica makes after
    the connection to the source times out, as determined by the [`replica_net_timeout`](replication-options-replica.html#sysvar_replica_net_timeout)
    or [`slave_net_timeout`](replication-options-replica.html#sysvar_slave_net_timeout)
    system variable. If the replica does need to reconnect, the first retry occurs
    immediately after the timeout. The default is 86400 attempts.
  id: totrans-129
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 设置副本在与源的连接超时后进行的重新连接尝试的最大次数，由[`replica_net_timeout`](replication-options-replica.html#sysvar_replica_net_timeout)或[`slave_net_timeout`](replication-options-replica.html#sysvar_slave_net_timeout)系统变量确定。如果副本确实需要重新连接，则第一次重试会在超时后立即发生。默认值为86400次尝试。
- en: The interval between the attempts is specified by the `SOURCE_CONNECT_RETRY`
    option. If both the default settings are used, the replica waits 60 seconds between
    reconnection attempts (`SOURCE_CONNECT_RETRY=60`), and keeps attempting to reconnect
    at this rate for 60 days (`SOURCE_RETRY_COUNT=86400`). A setting of 0 for `SOURCE_RETRY_COUNT`
    means that there is no limit on the number of reconnection attempts, so the replica
    keeps trying to reconnect indefinitely.
  id: totrans-130
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 尝试之间的间隔由`SOURCE_CONNECT_RETRY`选项指定。如果使用默认设置，副本在重新连接尝试之间等待60秒（`SOURCE_CONNECT_RETRY=60`），并以此速率继续尝试重新连接60天（`SOURCE_RETRY_COUNT=86400`）。将`SOURCE_RETRY_COUNT`设置为0意味着没有重新连接尝试次数限制，因此副本将无限尝试重新连接。
- en: The values for `SOURCE_CONNECT_RETRY` and `SOURCE_RETRY_COUNT` are recorded
    in the source metadata repository and shown in the [`replication_connection_configuration`](performance-schema-replication-connection-configuration-table.html
    "29.12.11.1 The replication_connection_configuration Table") Performance Schema
    table. `SOURCE_RETRY_COUNT` supersedes the [`--master-retry-count`](replication-options-replica.html#option_mysqld_master-retry-count)
    server startup option.
  id: totrans-131
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`SOURCE_CONNECT_RETRY`和`SOURCE_RETRY_COUNT`的值记录在源元数据存储库中，并显示在[`replication_connection_configuration`](performance-schema-replication-connection-configuration-table.html
    "29.12.11.1 The replication_connection_configuration Table")性能模式表中。`SOURCE_RETRY_COUNT`取代了[`--master-retry-count`](replication-options-replica.html#option_mysqld_master-retry-count)服务器启动选项。'
- en: '[`SOURCE_SSL = {0|1}`](change-replication-source-to.html#crs-opt-source_ssl)'
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`SOURCE_SSL = {0|1}`](change-replication-source-to.html#crs-opt-source_ssl)'
- en: Specify whether the replica encrypts the replication connection. The default
    is 0, meaning that the replica does not encrypt the replication connection. If
    you set `SOURCE_SSL=1`, you can configure the encryption using the `SOURCE_SSL_*`xxx`*`
    and `SOURCE_TLS_*`xxx`*` options.
  id: totrans-133
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 指定副本是否加密复制连接。默认值为0，表示副本不加密复制连接。如果设置`SOURCE_SSL=1`，则可以使用`SOURCE_SSL_*`xxx`*`和`SOURCE_TLS_*`xxx`*`选项配置加密。
- en: Setting `SOURCE_SSL=1` for a replication connection and then setting no further
    `SOURCE_SSL_*`xxx`*` options corresponds to setting `--ssl-mode=REQUIRED` for
    the client, as described in [Command Options for Encrypted Connections](connection-options.html#encrypted-connection-options
    "Command Options for Encrypted Connections"). With `SOURCE_SSL=1`, the connection
    attempt only succeeds if an encrypted connection can be established. A replication
    connection does not fall back to an unencrypted connection, so there is no setting
    corresponding to the `--ssl-mode=PREFERRED` setting for replication. If `SOURCE_SSL=0`
    is set, this corresponds to `--ssl-mode=DISABLED`.
  id: totrans-134
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 为复制连接设置`SOURCE_SSL=1`，然后不设置更多的`SOURCE_SSL_*`xxx`*`选项相当于为客户端设置`--ssl-mode=REQUIRED`，如[加密连接的命令选项](connection-options.html#encrypted-connection-options
    "加密连接的命令选项")中所述。使用`SOURCE_SSL=1`，只有在可以建立加密连接时连接尝试才会成功。复制连接不会退回到未加密连接，因此没有与复制的`--ssl-mode=PREFERRED`设置相对应的设置。如果设置`SOURCE_SSL=0`，则相当于`--ssl-mode=DISABLED`。
- en: Important
  id: totrans-135
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 重要
- en: To help prevent sophisticated man-in-the-middle attacks, it is important for
    the replica to verify the server’s identity. You can specify additional `SOURCE_SSL_*`xxx`*`
    options to correspond to the settings `--ssl-mode=VERIFY_CA` and `--ssl-mode=VERIFY_IDENTITY`,
    which are a better choice than the default setting to help prevent this type of
    attack. With these settings, the replica checks that the server’s certificate
    is valid, and checks that the host name the replica is using matches the identity
    in the server’s certificate. To implement one of these levels of verification,
    you must first ensure that the CA certificate for the server is reliably available
    to the replica, otherwise availability issues will result. For this reason, they
    are not the default setting.
  id: totrans-136
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 为了帮助防止复杂的中间人攻击，副本验证服务器的身份非常重要。您可以指定额外的`SOURCE_SSL_*`xxx`*`选项对应于设置`--ssl-mode=VERIFY_CA`和`--ssl-mode=VERIFY_IDENTITY`，这比默认设置更好地帮助防止这种类型的攻击。使用这些设置，副本会检查服务器的证书是否有效，并检查副本正在使用的主机名是否与服务器证书中的标识匹配。要实施这些验证级别之一，您必须首先确保服务器的CA证书可靠地可用于副本，否则将导致可用性问题。因此，它们不是默认设置。
- en: '[`SOURCE_SSL_*`xxx`*`](change-replication-source-to.html#crs-opt-source_ssl_xxx),
    [`SOURCE_TLS_*`xxx`*`](change-replication-source-to.html#crs-opt-source_ssl_xxx)'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`SOURCE_SSL_*`xxx`*`](change-replication-source-to.html#crs-opt-source_ssl_xxx),
    [`SOURCE_TLS_*`xxx`*`](change-replication-source-to.html#crs-opt-source_ssl_xxx)'
- en: Specify how the replica uses encryption and ciphers to secure the replication
    connection. These options can be changed even on replicas that are compiled without
    SSL support. They are saved to the source metadata repository, but are ignored
    if the replica does not have SSL support enabled. The maximum length of the value
    for the string-valued `SOURCE_SSL_*`xxx`*` and `SOURCE_TLS_*`xxx`*` options is
    511 characters, with the exception of [`SOURCE_TLS_CIPHERSUITES`](change-replication-source-to.html#crs-opt-source_ssl_xxx),
    for which it is 4000 characters.
  id: totrans-138
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 指定副本如何使用加密和密码来保护复制连接。即使在没有SSL支持的编译副本上也可以更改这些选项。它们保存在源元数据存储库中，但如果副本没有启用SSL支持，则会被忽略。字符串值为`SOURCE_SSL_*`xxx`*`和`SOURCE_TLS_*`xxx`*`选项的最大长度为511个字符，例外是[`SOURCE_TLS_CIPHERSUITES`](change-replication-source-to.html#crs-opt-source_ssl_xxx)，其长度为4000个字符。
- en: The `SOURCE_SSL_*`xxx`*` and `SOURCE_TLS_*`xxx`*` options perform the same functions
    as the `--ssl-*`xxx`*` and `--tls-*`xxx`*` client options described in [Command
    Options for Encrypted Connections](connection-options.html#encrypted-connection-options
    "Command Options for Encrypted Connections"). The correspondence between the two
    sets of options, and the use of the `SOURCE_SSL_*`xxx`*` and `SOURCE_TLS_*`xxx`*`
    options to set up a secure connection, is explained in [Section 19.3.1, “Setting
    Up Replication to Use Encrypted Connections”](replication-encrypted-connections.html
    "19.3.1 Setting Up Replication to Use Encrypted Connections").
  id: totrans-139
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`SOURCE_SSL_*`xxx`*`和`SOURCE_TLS_*`xxx`*`选项执行与[加密连接的命令选项](connection-options.html#encrypted-connection-options
    "加密连接的命令选项")中描述的`--ssl-*`xxx`*`和`--tls-*`xxx`*`客户端选项相同的功能。两组选项之间的对应关系，以及使用`SOURCE_SSL_*`xxx`*`和`SOURCE_TLS_*`xxx`*`选项建立安全连接的方法，在[第19.3.1节，“设置复制使用加密连接”](replication-encrypted-connections.html
    "19.3.1 设置复制使用加密连接")中有解释。'
- en: '[`SOURCE_USER = ''*`user_name`*''`](change-replication-source-to.html#crs-opt-source_user)'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`SOURCE_USER = ''*`user_name`*''`](change-replication-source-to.html#crs-opt-source_user)'
- en: The user name for the replication user account to use for connecting to the
    replication source server. The maximum length of the string value is 96 characters.
  id: totrans-141
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 复制用户帐户的用户名，用于连接到复制源服务器。字符串值的最大长度为96个字符。
- en: For Group Replication, this account must exist on every member of the replication
    group. It is used for distributed recovery if the XCom communication stack is
    in use for the group, and also used for group communication connections if the
    MySQL communication stack is in use for the group. With the MySQL communication
    stack, the account must have the [`GROUP_REPLICATION_STREAM`](privileges-provided.html#priv_group-replication-stream)
    permission.
  id: totrans-142
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 对于组复制，此帐户必须存在于复制组的每个成员中。如果XCom通信堆栈用于组，则用于分布式恢复，如果MySQL通信堆栈用于组，则用于组通信连接。对于MySQL通信堆栈，帐户必须具有[`GROUP_REPLICATION_STREAM`](privileges-provided.html#priv_group-replication-stream)权限。
- en: It is possible to set an empty user name by specifying `SOURCE_USER=''`, but
    the replication channel cannot be started with an empty user name. In releases
    before MySQL 8.0.21, only set an empty `SOURCE_USER` user name if you need to
    clear previously used credentials from the replication metadata repositories for
    security purposes. Do not use the channel afterwards, due to a bug in these releases
    that can substitute a default user name if an empty user name is read from the
    repositories (for example, during an automatic restart of a Group Replication
    channel). From MySQL 8.0.21, it is valid to set an empty `SOURCE_USER` user name
    and use the channel afterwards if you always provide user credentials using the
    [`START REPLICA`](start-replica.html "15.4.2.6 START REPLICA Statement") statement
    or [`START GROUP_REPLICATION`](start-group-replication.html "15.4.3.1 START GROUP_REPLICATION
    Statement") statement that starts the replication channel. This approach means
    that the replication channel always needs operator intervention to restart, but
    the user credentials are not recorded in the replication metadata repositories.
  id: totrans-143
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 可以通过指定`SOURCE_USER=''`来设置空用户名称，但不能使用空用户名称启动复制通道。在MySQL 8.0.21之前的版本中，仅在需要出于安全目的清除先前使用的凭据时才设置空的`SOURCE_USER`用户名称。不要在此之后使用通道，因为在这些版本中存在一个错误，如果从存储库中读取空用户名称（例如，在组复制通道的自动重启期间），则可能会替换默认用户名称。从MySQL
    8.0.21开始，可以设置空的`SOURCE_USER`用户名称，并且可以在之后使用通道，如果始终使用[`START REPLICA`](start-replica.html
    "15.4.2.6 START REPLICA Statement")语句或[`START GROUP_REPLICATION`](start-group-replication.html
    "15.4.3.1 START GROUP_REPLICATION Statement")语句提供用户凭据以启动复制通道。这种方法意味着复制通道始终需要操作员干预才能重新启动，但用户凭据不会记录在复制元数据存储库中。
- en: Important
  id: totrans-144
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 重要提示
- en: To connect to the source using a replication user account that authenticates
    with the `caching_sha2_password` plugin, you must either set up a secure connection
    as described in [Section 19.3.1, “Setting Up Replication to Use Encrypted Connections”](replication-encrypted-connections.html
    "19.3.1 Setting Up Replication to Use Encrypted Connections"), or enable the unencrypted
    connection to support password exchange using an RSA key pair. The `caching_sha2_password`
    authentication plugin is the default for new users created from MySQL 8.0 (see
    [Section 8.4.1.2, “Caching SHA-2 Pluggable Authentication”](caching-sha2-pluggable-authentication.html
    "8.4.1.2 Caching SHA-2 Pluggable Authentication")). If the user account that you
    create or use for replication uses this authentication plugin, and you are not
    using a secure connection, you must enable RSA key pair-based password exchange
    for a successful connection. You can do this using either the `SOURCE_PUBLIC_KEY_PATH`
    option or the `GET_SOURCE_PUBLIC_KEY=1` option for this statement.
  id: totrans-145
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 要使用使用`caching_sha2_password`插件进行身份验证的复制用户帐户连接到源，您必须设置安全连接，如[Section 19.3.1,
    “Setting Up Replication to Use Encrypted Connections”](replication-encrypted-connections.html
    "19.3.1 Setting Up Replication to Use Encrypted Connections")中所述，或启用不加密的连接以支持使用RSA密钥对进行密码交换。`caching_sha2_password`身份验证插件是从MySQL
    8.0开始的新用户的默认插件（请参阅[Section 8.4.1.2, “Caching SHA-2 Pluggable Authentication”](caching-sha2-pluggable-authentication.html
    "8.4.1.2 Caching SHA-2 Pluggable Authentication")）。如果您创建或使用用于复制的用户帐户使用此身份验证插件，并且未使用安全连接，则必须启用基于RSA密钥对的密码交换以成功连接。您可以使用此语句的`SOURCE_PUBLIC_KEY_PATH`选项或`GET_SOURCE_PUBLIC_KEY=1`选项来执行此操作。
- en: '[`SOURCE_ZSTD_COMPRESSION_LEVEL = *`level`*`](change-replication-source-to.html#crs-opt-source_zstd_compression_level)'
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`SOURCE_ZSTD_COMPRESSION_LEVEL = *`level`*`](change-replication-source-to.html#crs-opt-source_zstd_compression_level)'
- en: The compression level to use for connections to the replication source server
    that use the `zstd` compression algorithm. `SOURCE_ZSTD_COMPRESSION_LEVEL` is
    available as of MySQL 8.0.18\. The permitted levels are from 1 to 22, with larger
    values indicating increasing levels of compression. The default level is 3.
  id: totrans-147
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 用于使用`zstd`压缩算法的连接到复制源服务器的压缩级别。`SOURCE_ZSTD_COMPRESSION_LEVEL`自MySQL 8.0.18起可用。允许的级别为1到22，较大的值表示较高级别的压缩。默认级别为3。
- en: The compression level setting has no effect on connections that do not use `zstd`
    compression. For more information, see [Section 6.2.8, “Connection Compression
    Control”](connection-compression-control.html "6.2.8 Connection Compression Control").
  id: totrans-148
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 压缩级别设置对不使用`zstd`压缩的连接没有影响。有关更多信息，请参见[第6.2.8节，“连接压缩控制”](connection-compression-control.html
    "6.2.8 连接压缩控制")。
- en: Examples
  id: totrans-149
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 示例
- en: '[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE
    REPLICATION SOURCE TO Statement") is useful for setting up a replica when you
    have the snapshot of the source and have recorded the source''s binary log coordinates
    corresponding to the time of the snapshot. After loading the snapshot into the
    replica to synchronize it with the source, you can run `CHANGE REPLICATION SOURCE
    TO SOURCE_LOG_FILE=''*`log_name`*'', SOURCE_LOG_POS=*`log_pos`*` on the replica
    to specify the coordinates at which the replica should begin reading the source''s
    binary log. The following example changes the source server the replica uses and
    establishes the source''s binary log coordinates from which the replica begins
    reading:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: '[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE
    REPLICATION SOURCE TO Statement")对于在具有源快照并记录了快照时间对应的源二进制日志坐标的情况下设置副本非常有用。在将快照加载到副本以与源同步之后，您可以在副本上运行`CHANGE
    REPLICATION SOURCE TO SOURCE_LOG_FILE=''*`log_name`*'', SOURCE_LOG_POS=*`log_pos`*`来指定副本应开始读取源二进制日志的坐标。以下示例更改了副本使用的源服务器并建立了副本开始读取的源二进制日志坐标：'
- en: '[PRE4]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: For the procedure to switch an existing replica to a new source during failover,
    see [Section 19.4.8, “Switching Sources During Failover”](replication-solutions-switch.html
    "19.4.8 Switching Sources During Failover").
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 有关在故障切换期间将现有副本切换到新源的过程，请参见[第19.4.8节，“故障切换期间切换源”](replication-solutions-switch.html
    "19.4.8 故障切换期间切换源")。
- en: When GTIDs are in use on the source and the replica, specify GTID auto-positioning
    instead of giving the binary log file position, as in the following example. For
    full instructions to configure and start GTID-based replication on new or stopped
    servers, online servers, or additional replicas, see [Section 19.1.3, “Replication
    with Global Transaction Identifiers”](replication-gtids.html "19.1.3 Replication
    with Global Transaction Identifiers").
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 当源和副本上使用GTID时，请指定GTID自动定位，而不是提供二进制日志文件位置，如下例所示。有关在新服务器或停止的服务器、在线服务器或其他副本上配置和启动基于GTID的复制的完整说明，请参见[第19.1.3节，“具有全局事务标识符的复制”](replication-gtids.html
    "19.1.3 具有全局事务标识符的复制")。
- en: '[PRE5]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: In this example, multi-source replication is in use, and the [`CHANGE REPLICATION
    SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE REPLICATION SOURCE
    TO Statement") statement is applied to the replication channel `"source_3"` that
    connects the replica to the specified host. For guidance on setting up multi-source
    replication, see [Section 19.1.5, “MySQL Multi-Source Replication”](replication-multi-source.html
    "19.1.5 MySQL Multi-Source Replication").
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 在此示例中，使用了多源复制，并且[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 CHANGE REPLICATION SOURCE TO Statement")语句应用于连接副本到指定主机的复制通道`"source_3"`。有关设置多源复制的指导，请参见[第19.1.5节，“MySQL多源复制”](replication-multi-source.html
    "19.1.5 MySQL多源复制")。
- en: 'The next example shows how to make the replica apply transactions from relay
    log files that you want to repeat. To do this, the source need not be reachable.
    You can use [`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 CHANGE REPLICATION SOURCE TO Statement") to locate the relay log position
    where you want the replica to start reapplying transactions, and then start the
    SQL thread:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 下一个示例显示了如何使副本应用您想要重复的中继日志文件中的事务。为此，源不需要可达。您可以使用[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html
    "15.4.2.3 CHANGE REPLICATION SOURCE TO Statement")来定位您希望副本开始重新应用事务的中继日志位置，然后启动SQL线程：
- en: '[PRE6]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '[`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE
    REPLICATION SOURCE TO Statement") can also be used to skip over transactions in
    the binary log that are causing replication to stop. The appropriate method to
    do this depends on whether GTIDs are in use or not. For instructions to skip transactions
    using [`CHANGE REPLICATION SOURCE TO`](change-replication-source-to.html "15.4.2.3 CHANGE
    REPLICATION SOURCE TO Statement") or another method, see [Section 19.1.7.3, “Skipping
    Transactions”](replication-administration-skip.html "19.1.7.3 Skipping Transactions").'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: '[`更改复制源为`](change-replication-source-to.html "15.4.2.3 更改复制源为语句")也可以用于跳过导致复制停止的二进制日志中的事务。执行此操作的适当方法取决于是否使用GTID。有关使用[`更改复制源为`](change-replication-source-to.html
    "15.4.2.3 更改复制源为语句")或其他方法跳过事务的说明，请参见[第19.1.7.3节，“跳过事务”](replication-administration-skip.html
    "19.1.7.3 跳过事务")。'
