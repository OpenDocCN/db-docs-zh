- en: 原文：[https://dev.mysql.com/doc/refman/8.0/en/error-log-configuration.html](https://dev.mysql.com/doc/refman/8.0/en/error-log-configuration.html)
  id: totrans-0
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://dev.mysql.com/doc/refman/8.0/en/error-log-configuration.html](https://dev.mysql.com/doc/refman/8.0/en/error-log-configuration.html)
- en: 7.4.2.1 Error Log Configuration
  id: totrans-1
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 7.4.2.1 错误日志配置
- en: In MySQL 8.0, error logging uses the MySQL component architecture described
    at [Section 7.5, “MySQL Components”](components.html "7.5 MySQL Components").
    The error log subsystem consists of components that perform log event filtering
    and writing, as well as a system variable that configures which components to
    load and enable to achieve the desired logging result.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在 MySQL 8.0 中，错误日志记录使用了在[第 7.5 节，“MySQL 组件”](components.html "7.5 MySQL 组件")中描述的
    MySQL 组件架构。错误日志子系统由执行日志事件过滤和写入的组件以及配置哪些组件加载和启用以实现所需日志记录结果的系统变量组成。
- en: This section discusses how to load and enable components for error logging.
    For instructions specific to log filters, see [Section 7.4.2.4, “Types of Error
    Log Filtering”](error-log-filtering.html "7.4.2.4 Types of Error Log Filtering").
    For instructions specific to the JSON and system log sinks, see [Section 7.4.2.7,
    “Error Logging in JSON Format”](error-log-json.html "7.4.2.7 Error Logging in
    JSON Format"), and [Section 7.4.2.8, “Error Logging to the System Log”](error-log-syslog.html
    "7.4.2.8 Error Logging to the System Log"). For additional details about all available
    log components, see [Section 7.5.3, “Error Log Components”](error-log-components.html
    "7.5.3 Error Log Components").
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本节讨论了如何加载和启用错误日志记录的组件。有关特定于日志过滤器的说明，请参阅[第 7.4.2.4 节，“错误日志过滤类型”](error-log-filtering.html
    "7.4.2.4 错误日志过滤类型")。有关特定于 JSON 和系统日志接收器的说明，请参阅[第 7.4.2.7 节，“以 JSON 格式记录错误日志”](error-log-json.html
    "7.4.2.7 以 JSON 格式记录错误日志")和[第 7.4.2.8 节，“将错误日志记录到系统日志”](error-log-syslog.html
    "7.4.2.8 将错误日志记录到系统日志")。有关所有可用日志组件的更多详细信息，请参阅[第 7.5.3 节，“错误日志组件”](error-log-components.html
    "7.5.3 错误日志组件")。
- en: 'Component-based error logging offers these features:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 基于组件的错误日志记录提供了以下功能：
- en: Log events that can be filtered by filter components to affect the information
    available for writing.
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可由过滤组件过滤的日志事件，以影响可用于写入的信息。
- en: Log events that are output by sink (writer) components. Multiple sink components
    can be enabled, to write error log output to multiple destinations.
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 由接收器（写入器）组件输出的日志事件。可以启用多个接收器组件，将错误日志输出写入多个目的地。
- en: Built-in filter and sink components that implement the default error log format.
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实现默认错误日志格式的内置过滤器和接收器组件。
- en: A loadable sink that enables logging in JSON format.
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个可加载的接收器，可启用以 JSON 格式记录日志。
- en: A loadable sink that enables logging to the system log.
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个可加载的接收器，可启用将日志记录到系统日志中。
- en: System variables that control which log components to load and enable and how
    each component operates.
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 控制加载和启用哪些日志组件以及每个组件如何运行的系统变量。
- en: 'Error log configuration is described under the following topics in this section:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 错误日志配置在本节中描述如下主题：
- en: '[The Default Error Log Configuration](error-log-configuration.html#error-log-default-configuration
    "The Default Error Log Configuration")'
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[默认错误日志配置](error-log-configuration.html#error-log-default-configuration "默认错误日志配置")'
- en: '[Error Log Configuration Methods](error-log-configuration.html#error-log-configuration-methods
    "Error Log Configuration Methods")'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[错误日志配置方法](error-log-configuration.html#error-log-configuration-methods "错误日志配置方法")'
- en: '[Implicit Error Log Configuration](error-log-configuration.html#error-log-implicit-configuration
    "Implicit Error Log Configuration")'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[隐式错误日志配置](error-log-configuration.html#error-log-implicit-configuration "隐式错误日志配置")'
- en: '[Explicit Error Log Configuration](error-log-configuration.html#error-log-explicit-configuration
    "Explicit Error Log Configuration")'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[显式错误日志配置](error-log-configuration.html#error-log-explicit-configuration "显式错误日志配置")'
- en: '[Changing the Error Log Configuration Method](error-log-configuration.html#error-log-configuration-change-method
    "Changing the Error Log Configuration Method")'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[更改错误日志配置方法](error-log-configuration.html#error-log-configuration-change-method
    "更改错误日志配置方法")'
- en: '[Troubleshooting Configuration Issues](error-log-configuration.html#error-log-configuration-troubleshooting
    "Troubleshooting Configuration Issues")'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[故障排除配置问题](error-log-configuration.html#error-log-configuration-troubleshooting
    "故障排除配置问题")'
- en: '[Configuring Multiple Log Sinks](error-log-configuration.html#error-log-configuration-multiple-log-sinks
    "Configuring Multiple Log Sinks")'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[配置多个日志接收器](error-log-configuration.html#error-log-configuration-multiple-log-sinks
    "配置多个日志接收器")'
- en: '[Log Sink Performance Schema Support](error-log-configuration.html#error-log-configuration-log-sink-ps-support
    "Log Sink Performance Schema Support")'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[日志汇流性能模式支持](error-log-configuration.html#error-log-configuration-log-sink-ps-support
    "日志汇流性能模式支持")'
- en: The Default Error Log Configuration
  id: totrans-20
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 默认错误日志配置
- en: 'The [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    system variable controls which loadable log components to load (as of MySQL 8.0.30)
    and which log components to enable for error logging. By default, [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    has this value:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: '[`log_error_services`](server-system-variables.html#sysvar_log_error_services)系统变量控制要加载的可加载日志组件（从MySQL
    8.0.30开始）以及要为错误日志记录启用的日志组件。默认情况下，[`log_error_services`](server-system-variables.html#sysvar_log_error_services)具有以下值：'
- en: '[PRE0]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: That value indicates that log events first pass through the `log_filter_internal`
    filter component, then through the `log_sink_internal` sink component, both of
    which are built-in components. A filter modifies log events seen by components
    named later in the [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    value. A sink is a destination for log events. Typically, a sink processes log
    events into log messages that have a particular format and writes these messages
    to its associated output, such as a file or the system log.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 该值表示日志事件首先通过`log_filter_internal`过滤组件，然后通过`log_sink_internal`汇流组件，这两个都是内置组件。过滤器修改后续命名的组件看到的日志事件。汇流是日志事件的目的地。通常，汇流将日志事件处理为具有特定格式的日志消息，并将这些消息写入其关联的输出，例如文件或系统日志。
- en: 'The combination of `log_filter_internal` and `log_sink_internal` implements
    the default error log filtering and output behavior. The action of these components
    is affected by other server options and system variables:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '`log_filter_internal`和`log_sink_internal`的组合实现了默认的错误日志过滤和输出行为。这些组件的操作受其他服务器选项和系统变量的影响：'
- en: The output destination is determined by the [`--log-error`](server-options.html#option_mysqld_log-error)
    option (and, on Windows, [`--pid-file`](server-system-variables.html#sysvar_pid_file)
    and [`--console`](server-options.html#option_mysqld_console)). These determine
    whether to write error messages to the console or a file and, if to a file, the
    error log file name. See [Section 7.4.2.2, “Default Error Log Destination Configuration”](error-log-destination-configuration.html
    "7.4.2.2 Default Error Log Destination Configuration").
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 输出目的地由[`--log-error`](server-options.html#option_mysqld_log-error)选项确定（在Windows上，还有[`--pid-file`](server-system-variables.html#sysvar_pid_file)和[`--console`](server-options.html#option_mysqld_console)）。这些选项确定是否将错误消息写入控制台或文件，如果写入文件，则确定错误日志文件名。参见[Section 7.4.2.2,
    “Default Error Log Destination Configuration”](error-log-destination-configuration.html
    "7.4.2.2 Default Error Log Destination Configuration")。
- en: The [`log_error_verbosity`](server-system-variables.html#sysvar_log_error_verbosity)
    and [`log_error_suppression_list`](server-system-variables.html#sysvar_log_error_suppression_list)
    system variables affect which types of log events `log_filter_internal` permits
    or suppresses. See [Section 7.4.2.5, “Priority-Based Error Log Filtering (log_filter_internal)”](error-log-priority-based-filtering.html
    "7.4.2.5 Priority-Based Error Log Filtering (log_filter_internal)").
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`log_error_verbosity`](server-system-variables.html#sysvar_log_error_verbosity)和[`log_error_suppression_list`](server-system-variables.html#sysvar_log_error_suppression_list)系统变量影响`log_filter_internal`允许或抑制哪些类型的日志事件。参见[Section 7.4.2.5,
    “Priority-Based Error Log Filtering (log_filter_internal)”](error-log-priority-based-filtering.html
    "7.4.2.5 Priority-Based Error Log Filtering (log_filter_internal)")。'
- en: 'When configuring [`log_error_services`](server-system-variables.html#sysvar_log_error_services),
    be aware of the following characteristics:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 在配置[`log_error_services`](server-system-variables.html#sysvar_log_error_services)时，请注意以下特性：
- en: A list of log components may be delimited by semicolon or (as of MySQL 8.0.12)
    comma, optionally followed by space. A given setting cannot use both semicolon
    and comma separators. Component order is significant because the server executes
    components in the order listed.
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 日志组件列表可以用分号或（从MySQL 8.0.12开始）逗号分隔，可选地跟随空格。给定设置不能同时使用分号和逗号分隔符。组件顺序很重要，因为服务器按照列出的顺序执行组件。
- en: 'The final component in the [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    value cannot be a filter. This is an error because any changes it has on events
    would have no effect on output:'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`log_error_services`](server-system-variables.html#sysvar_log_error_services)值中的最终组件不能是过滤器。这是一个错误，因为它对事件的任何更改都不会对输出产生影响：'
- en: '[PRE1]'
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'To correct the problem, include a sink at the end of the value:'
  id: totrans-31
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 要纠正问题，请在值的末尾包含一个sink：
- en: '[PRE2]'
  id: totrans-32
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The order of components named in [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    is significant, particularly with respect to the relative order of filters and
    sinks. Consider this [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    value:'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在 [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    中命名的组件顺序很重要，特别是与过滤器和接收器的相对顺序有关。考虑这个 [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    值：
- en: '[PRE3]'
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE3]'
- en: In this case, log events pass to the built-in filter, then to the first sink,
    then to the second sink. Both sinks receive the filtered log events.
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在这种情况下，日志事件经过内置过滤器，然后传递到第一个接收器，再传递到第二个接收器。两个接收器都会接收到经过过滤的日志事件。
- en: 'Compare that to this [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    value:'
  id: totrans-36
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 将其与此 [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    值进行比较：
- en: '[PRE4]'
  id: totrans-37
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE4]'
- en: In this case, log events pass to the first sink, then to the built-in filter,
    then to the second sink. The first sink receives unfiltered events. The second
    sink receives filtered events. You might configure error logging this way if you
    want one log that contains messages for all log events, and another log that contains
    messages only for a subset of log events.
  id: totrans-38
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在这种情况下，日志事件经过第一个接收器，然后经过内置过滤器，再传递到第二个接收器。第一个接收器接收未经过滤的事件。第二个接收器接收经过过滤的事件。如果您希望一个日志包含所有日志事件的消息，另一个日志仅包含部分日志事件的消息，您可以以这种方式配置错误日志记录。
- en: Error Log Configuration Methods
  id: totrans-39
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 错误日志配置方法
- en: Error log configuration involves loading and enabling error log components as
    necessary and performing component-specific configuration.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 错误日志配置涉及根据需要加载和启用错误日志组件，并执行特定于组件的配置。
- en: There are two error log configuration methods, *implicit* and *explicit*. It
    is recommended that one configuration method is selected and used exclusively.
    Using both methods can result in warnings at startup. For more information, see
    [Troubleshooting Configuration Issues](error-log-configuration.html#error-log-configuration-troubleshooting
    "Troubleshooting Configuration Issues").
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 有两种错误日志配置方法，*隐式* 和 *显式*。建议选择一种配置方法并专门使用。同时使用两种方法可能会导致启动时出现警告。有关更多信息，请参阅 [故障排除配置问题](error-log-configuration.html#error-log-configuration-troubleshooting
    "故障排除配置问题")。
- en: '*Implicit Error Log Configuration* (introduced in MySQL 8.0.30)'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*隐式错误日志配置*（MySQL 8.0.30中引入）'
- en: 'This configuration method loads and enables the log components defined by the
    [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    variable. Loadable components that are not already loaded are loaded implicitly
    at startup before the `InnoDB` storage engine is fully available. This configuration
    method has the following advantages:'
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此配置方法加载并启用由 [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    变量定义的日志组件。在启动时，尚未加载的可加载组件会在`InnoDB`存储引擎完全可用之前隐式加载。此配置方法具有以下优点：
- en: Log components are loaded early in the startup sequence, before the `InnoDB`
    storage engine, making logged information available sooner.
  id: totrans-44
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 日志组件在启动序列的早期加载，早于`InnoDB`存储引擎，使得记录的信息更早可用。
- en: It avoids loss of buffered log information should a failure occur during startup.
  id: totrans-45
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它避免了在启动过程中发生故障时丢失缓冲的日志信息。
- en: Installing error log components using [`INSTALL COMPONENT`](install-component.html
    "15.7.4.3 INSTALL COMPONENT Statement") is not required, simplifying error log
    configuration.
  id: totrans-46
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 [`INSTALL COMPONENT`](install-component.html "15.7.4.3 INSTALL COMPONENT
    Statement") 安装错误日志组件并不是必需的，简化了错误日志配置。
- en: To use this method, see [Implicit Error Log Configuration](error-log-configuration.html#error-log-implicit-configuration
    "Implicit Error Log Configuration").
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 要使用这种方法，请参阅 [隐式错误日志配置](error-log-configuration.html#error-log-implicit-configuration
    "隐式错误日志配置")。
- en: '*Explicit Error Log Configuration*'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*显式错误日志配置*'
- en: Note
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意
- en: This configuration method is supported for backward compatibility. The implicit
    configuration method, introduced in MySQL 8.0.30, is recommended.
  id: totrans-50
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此配置方法支持向后兼容。推荐使用MySQL 8.0.30中引入的隐式配置方法。
- en: This configuration method requires loading error log components using [`INSTALL
    COMPONENT`](install-component.html "15.7.4.3 INSTALL COMPONENT Statement") and
    then configuring [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    to enable the log components. [`INSTALL COMPONENT`](install-component.html "15.7.4.3 INSTALL
    COMPONENT Statement") adds the component to the `mysql.component` table (an `InnoDB`
    table), and the components to load at startup are read from this table, which
    is only accessible after `InnoDB` is initialized.
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这种配置方法需要使用[`INSTALL COMPONENT`](install-component.html "15.7.4.3 INSTALL COMPONENT
    Statement")加载错误日志组件，然后配置[`log_error_services`](server-system-variables.html#sysvar_log_error_services)以启用日志组件。[`INSTALL
    COMPONENT`](install-component.html "15.7.4.3 INSTALL COMPONENT Statement")将组件添加到`mysql.component`表（一个`InnoDB`表），启动时要加载的组件从该表中读取，该表只有在`InnoDB`初始化后才能访问。
- en: Logged information is buffered during the startup sequence while the `InnoDB`
    storage engine is initialized, which is sometimes prolonged by operations such
    as recovery and data dictionary upgrade that occur during the `InnoDB` startup
    sequence.
  id: totrans-52
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在`InnoDB`存储引擎初始化期间，启动序列期间缓冲记录的信息，这有时会因为`InnoDB`启动序列期间发生的恢复和数据字典升级等操作而延长。
- en: To use this method, see [Explicit Error Log Configuration](error-log-configuration.html#error-log-explicit-configuration
    "Explicit Error Log Configuration").
  id: totrans-53
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 要使用此方法，请参阅[显式错误日志配置](error-log-configuration.html#error-log-explicit-configuration
    "显式错误日志配置")。
- en: Implicit Error Log Configuration
  id: totrans-54
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 隐式错误日志配置
- en: This procedure describes how to load and enable error logging components implicitly
    using [`log_error_services`](server-system-variables.html#sysvar_log_error_services).
    For a discussion of error log configuration methods, see [Error Log Configuration
    Methods](error-log-configuration.html#error-log-configuration-methods "Error Log
    Configuration Methods").
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 本过程描述了如何使用[`log_error_services`](server-system-variables.html#sysvar_log_error_services)隐式加载和启用错误日志组件。有关错误日志配置方法的讨论，请参见[错误日志配置方法](error-log-configuration.html#error-log-configuration-methods
    "错误日志配置方法")。
- en: 'To load and enable error logging components implicitly:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 隐式加载和启用错误日志组件：
- en: List the error log components in the [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    value.
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在[`log_error_services`](server-system-variables.html#sysvar_log_error_services)值中列出错误日志组件。
- en: To load and enable the error log components at server startup, set [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    in an option file. The following example configures the use of the JSON log sink
    (`log_sink_json`) in addition to the built-in log filter and sink (`log_filter_internal`,
    `log_sink_internal`).
  id: totrans-58
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 要在服务器启动时加载和启用错误日志组件，请在选项文件中设置[`log_error_services`](server-system-variables.html#sysvar_log_error_services)。以下示例配置了使用JSON日志接收器（`log_sink_json`）以及内置日志过滤器和接收器（`log_filter_internal`，`log_sink_internal`）。
- en: '[PRE5]'
  id: totrans-59
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Note
  id: totrans-60
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意
- en: To use the JSON log sink (`log_sink_syseventlog`) instead of the default sink
    (`log_sink_internal`), you would replace `log_sink_internal` with `log_sink_json`.
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 要使用JSON日志接收器（`log_sink_syseventlog`）而不是默认接收器（`log_sink_internal`），您应该将`log_sink_internal`替换为`log_sink_json`。
- en: 'To load and enable the component immediately and for subsequent restarts, set
    [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    using [`SET PERSIST`](set-variable.html "15.7.6.1 SET Syntax for Variable Assignment"):'
  id: totrans-62
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 要立即加载和启用组件并用于后续重新启动，请使用[`SET PERSIST`](set-variable.html "15.7.6.1 SET Syntax
    for Variable Assignment")设置[`log_error_services`](server-system-variables.html#sysvar_log_error_services")：
- en: '[PRE6]'
  id: totrans-63
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE6]'
- en: If the error log component exposes any system variables that must be set for
    component initialization to succeed, assign those variables appropriate values.
    You can set these variables in an option file or using [`SET PERSIST`](set-variable.html
    "15.7.6.1 SET Syntax for Variable Assignment").
  id: totrans-64
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果错误日志组件公开任何必须设置的系统变量以使组件初始化成功，请为这些变量分配适当的值。您可以在选项文件中设置这些变量，也可以使用[`SET PERSIST`](set-variable.html
    "15.7.6.1 SET Syntax for Variable Assignment")。
- en: Important
  id: totrans-65
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 重要
- en: When implementing an implicit configuration, set [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    first to load a component and expose its system variables, and then set component
    system variables afterward. This configuration order is required regardless of
    whether variable assignment is performed on the command-line, in an option file,
    or using [`SET PERSIST`](set-variable.html "15.7.6.1 SET Syntax for Variable Assignment").
  id: totrans-66
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在实现隐式配置时，首先设置[`log_error_services`](server-system-variables.html#sysvar_log_error_services)以加载组件并公开其系统变量，然后设置组件系统变量。无论是在命令行、选项文件还是使用[`SET
    PERSIST`](set-variable.html "15.7.6.1 SET Syntax for Variable Assignment")进行变量赋值，都需要按照此配置顺序进行。
- en: To disable a log component, remove it from the [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    value. Also remove any associated component variables settings that you have defined.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 要禁用日志组件，请从[`log_error_services`](server-system-variables.html#sysvar_log_error_services)值中移除它。同时移除您定义的任何相关组件变量设置。
- en: Note
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: Loading a log component implicitly using [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    has no effect on the `mysql.component` table. It does not add the component to
    the `mysql.component` table, nor does it remove a component previously installed
    using [`INSTALL COMPONENT`](install-component.html "15.7.4.3 INSTALL COMPONENT
    Statement") from the `mysql.component` table.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 使用[`log_error_services`](server-system-variables.html#sysvar_log_error_services)隐式加载日志组件不会影响`mysql.component`表。它不会将组件添加到`mysql.component`表中，也不会从`mysql.component`表中删除以前使用[`INSTALL
    COMPONENT`](install-component.html "15.7.4.3 INSTALL COMPONENT Statement")安装的组件。
- en: Explicit Error Log Configuration
  id: totrans-70
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 明确的错误日志配置
- en: This procedure describes how to load and enable error logging components explicitly
    by loading components using [`INSTALL COMPONENT`](install-component.html "15.7.4.3 INSTALL
    COMPONENT Statement") and then enabling using [`log_error_services`](server-system-variables.html#sysvar_log_error_services).
    For a discussion of error log configuration methods, see [Error Log Configuration
    Methods](error-log-configuration.html#error-log-configuration-methods "Error Log
    Configuration Methods").
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 本过程描述了如何通过使用[`INSTALL COMPONENT`](install-component.html "15.7.4.3 INSTALL COMPONENT
    Statement")加载组件，然后通过[`log_error_services`](server-system-variables.html#sysvar_log_error_services)启用错误日志组件。有关错误日志配置方法的讨论，请参见[错误日志配置方法](error-log-configuration.html#error-log-configuration-methods
    "Error Log Configuration Methods")。
- en: 'To load and enable error logging components explicitly:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 明确加载和启用错误日志组件：
- en: 'Load the component using [`INSTALL COMPONENT`](install-component.html "15.7.4.3 INSTALL
    COMPONENT Statement") (unless it is built in or already loaded). For example,
    to load the JSON log sink, issue the following statement:'
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用[`INSTALL COMPONENT`](install-component.html "15.7.4.3 INSTALL COMPONENT Statement")加载组件（除非它是内置的或已加载）。例如，要加载
    JSON 日志接收器，请执行以下语句：
- en: '[PRE7]'
  id: totrans-74
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Loading a component using [`INSTALL COMPONENT`](install-component.html "15.7.4.3 INSTALL
    COMPONENT Statement") registers it in the `mysql.component` system table so that
    the server loads it automatically for subsequent startups, after `InnoDB` is initialized.
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使用[`INSTALL COMPONENT`](install-component.html "15.7.4.3 INSTALL COMPONENT Statement")加载组件会将其注册到`mysql.component`系统表中，以便服务器在`InnoDB`初始化后自动加载它以供后续启动使用。
- en: The URN to use when loading a log component with [`INSTALL COMPONENT`](install-component.html
    "15.7.4.3 INSTALL COMPONENT Statement") is the component name prefixed with `file://component_`.
    For example, for the `log_sink_json` component, the corresponding URN is `file://component_log_sink_json`.
    For error log component URNs, see [Section 7.5.3, “Error Log Components”](error-log-components.html
    "7.5.3 Error Log Components").
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使用[`INSTALL COMPONENT`](install-component.html "15.7.4.3 INSTALL COMPONENT Statement")加载日志组件时使用的
    URN 是组件名称前缀为`file://component_`。例如，对于`log_sink_json`组件，相应的 URN 是`file://component_log_sink_json`。有关错误日志组件
    URN，请参见[Section 7.5.3, “Error Log Components”](error-log-components.html "7.5.3 Error
    Log Components")。
- en: If the error log component exposes any system variables that must be set for
    component initialization to succeed, assign those variables appropriate values.
    You can set these variables in an option file or using [`SET PERSIST`](set-variable.html
    "15.7.6.1 SET Syntax for Variable Assignment").
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果错误日志组件公开了必须设置的系统变量以确保组件初始化成功，为这些变量分配适当的值。您可以在选项文件中设置这些变量，也可以使用[`SET PERSIST`](set-variable.html
    "15.7.6.1 SET Syntax for Variable Assignment")。
- en: Enable the component by listing it in the [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    value.
  id: totrans-78
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过在[`log_error_services`](server-system-variables.html#sysvar_log_error_services)值中列出组件来启用该组件。
- en: Important
  id: totrans-79
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 重要
- en: From MySQL 8.0.30, when loading log components explicitly using [`INSTALL COMPONENT`](install-component.html
    "15.7.4.3 INSTALL COMPONENT Statement"), do not persist or set [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    in an option file, which loads log components implicitly at startup. Instead,
    enable log components at runtime using a `SET GLOBAL` statement.
  id: totrans-80
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 从MySQL 8.0.30开始，当使用[`INSTALL COMPONENT`](install-component.html "15.7.4.3 INSTALL
    COMPONENT语句")显式加载日志组件时，请勿在选项文件中持久化或设置[`log_error_services`](server-system-variables.html#sysvar_log_error_services)，该选项文件在启动时隐式加载日志组件。而是使用`SET
    GLOBAL`语句在运行时启用日志组件。
- en: The following example configures the use of the JSON log sink (`log_sink_json`)
    in addition to the built-in log filter and sink (`log_filter_internal`, `log_sink_internal`).
  id: totrans-81
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 以下示例配置了使用JSON日志接收器（`log_sink_json`）以及内置日志过滤器和接收器（`log_filter_internal`，`log_sink_internal`）。
- en: '[PRE8]'
  id: totrans-82
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Note
  id: totrans-83
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 注意
- en: To use the JSON log sink (`log_sink_syseventlog`) instead of the default sink
    (`log_sink_internal`), you would replace `log_sink_internal` with `log_sink_json`.
  id: totrans-84
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 要使用JSON日志接收器（`log_sink_syseventlog`）而不是默认接收器（`log_sink_internal`），您应该将`log_sink_internal`替换为`log_sink_json`。
- en: To disable a log component, remove it from the [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    value. Then, if the component is loadable and you also want to unload it, use
    [`UNINSTALL COMPONENT`](uninstall-component.html "15.7.4.5 UNINSTALL COMPONENT
    Statement"). Also remove any associated component variables settings that you
    have defined.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 要禁用日志组件，请从[`log_error_services`](server-system-variables.html#sysvar_log_error_services)值中删除它。然后，如果组件是可加载的，并且您还想卸载它，请使用[`UNINSTALL
    COMPONENT`](uninstall-component.html "15.7.4.5 UNINSTALL COMPONENT语句")。还要删除您定义的任何相关组件变量设置。
- en: Attempts to use [`UNINSTALL COMPONENT`](uninstall-component.html "15.7.4.5 UNINSTALL
    COMPONENT Statement") to unload a loadable component that is still named in the
    [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    value produce an error.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 尝试使用[`UNINSTALL COMPONENT`](uninstall-component.html "15.7.4.5 UNINSTALL COMPONENT语句")卸载仍在[`log_error_services`](server-system-variables.html#sysvar_log_error_services)值中命名的可加载组件会产生错误。
- en: Changing the Error Log Configuration Method
  id: totrans-87
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 更改错误日志配置方法
- en: 'If you have previously loaded error log components explicitly using [`INSTALL
    COMPONENT`](install-component.html "15.7.4.3 INSTALL COMPONENT Statement") and
    want to switch to an implicit configuration, as described in [Implicit Error Log
    Configuration](error-log-configuration.html#error-log-implicit-configuration "Implicit
    Error Log Configuration"), the following steps are recommended:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您之前使用[`INSTALL COMPONENT`](install-component.html "15.7.4.3 INSTALL COMPONENT语句")显式加载了错误日志组件，并且希望切换到隐式配置，如[隐式错误日志配置](error-log-configuration.html#error-log-implicit-configuration
    "隐式错误日志配置")中所述，建议执行以下步骤：
- en: Set [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    back to its default configuration.
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[`log_error_services`](server-system-variables.html#sysvar_log_error_services)设置回默认配置。
- en: '[PRE9]'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Use [`UNINSTALL COMPONENT`](uninstall-component.html "15.7.4.5 UNINSTALL COMPONENT
    Statement") to uninstall any loadable logging components that you installed previously.
    For example, if you installed the JSON log sink previously, uninstall it as shown:'
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用[`UNINSTALL COMPONENT`](uninstall-component.html "15.7.4.5 UNINSTALL COMPONENT语句")卸载您之前安装的任何可加载日志组件。例如，如果之前安装了JSON日志接收器，请按照以下方式��载它：
- en: '[PRE10]'
  id: totrans-92
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Remove any component variable settings for the uninstalled component. For example,
    if component variables were set in an option file, remove the settings from the
    option file. If component variables were set using [`SET PERSIST`](set-variable.html
    "15.7.6.1 SET Syntax for Variable Assignment"), use [`RESET PERSIST`](set-variable.html
    "15.7.6.1 SET Syntax for Variable Assignment") to clear the settings.
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除已卸载组件的任何组件变量设置。例如，如果在选项文件中设置了组件变量，请从选项文件中删除这些设置。如果使用[`SET PERSIST`](set-variable.html
    "15.7.6.1 变量赋值的SET语法")设置了组件变量，请使用[`RESET PERSIST`](set-variable.html "15.7.6.1 变量赋值的SET语法")来清除这些设置。
- en: Follow the steps in [Implicit Error Log Configuration](error-log-configuration.html#error-log-implicit-configuration
    "Implicit Error Log Configuration") to reimplement your configuration.
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照[隐式错误日志配置](error-log-configuration.html#error-log-implicit-configuration "隐式错误日志配置")中的步骤重新实施您的配置。
- en: 'If you need to revert from an implicit configuration to an explicit configuration,
    perform the following steps:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 如果需要从隐式配置恢复到显式配置，请执行以下步骤：
- en: Set [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    back to its default configuration to unload implicitly loaded log components.
  id: totrans-96
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将[`log_error_services`](server-system-variables.html#sysvar_log_error_services)设置回其默认配置以卸载隐式加载的日志组件。
- en: '[PRE11]'
  id: totrans-97
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Remove any component variable settings associated with the uninstalled components.
    For example, if component variables were set in an option file, remove the settings
    from the option file. If component variables were set using [`SET PERSIST`](set-variable.html
    "15.7.6.1 SET Syntax for Variable Assignment"), use [`RESET PERSIST`](set-variable.html
    "15.7.6.1 SET Syntax for Variable Assignment") to clear the settings.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除与已卸载组件相关的任何组件变量设置。例如，如果在选项文件中设置了组件变量，请从选项文件中删除这些设置。如果使用[`SET PERSIST`](set-variable.html
    "15.7.6.1 变量赋值的SET语法")设置了组件变量，请使用[`RESET PERSIST`](set-variable.html "15.7.6.1 变量赋值的SET语法")清除这些设置。
- en: Restart the server to uninstall the log components that were implicitly loaded.
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 重新启动服务器以卸载隐式加载的日志组件。
- en: Follow the steps in [Explicit Error Log Configuration](error-log-configuration.html#error-log-explicit-configuration
    "Explicit Error Log Configuration") to reimplement your configuration.
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按照[显式错误日志配置](error-log-configuration.html#error-log-explicit-configuration "显式错误日志配置")中的步骤重新实施您的配置。
- en: Troubleshooting Configuration Issues
  id: totrans-101
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 故障排除配置问题
- en: 'From MySQL 8.0.30, log components listed in the [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    value at startup are loaded implicitly early in the MySQL Server startup sequence.
    If the log component was loaded previously using [`INSTALL COMPONENT`](install-component.html
    "15.7.4.3 INSTALL COMPONENT Statement"), the server attempts to load the component
    again later in the startup sequence, which produces the following warning:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 从MySQL 8.0.30开始，在启动时加载在[`log_error_services`](server-system-variables.html#sysvar_log_error_services)值中列出的日志组件会在MySQL服务器启动序列的早期隐式加载。如果以前使用[`INSTALL
    COMPONENT`](install-component.html "15.7.4.3 INSTALL COMPONENT语句")加载了日志组件，则服务器会在启动序列的后期尝试重新加载该组件，从而产生以下警告：
- en: '[PRE12]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'You can check for this warning in the error log or by querying the Performance
    Schema [`error_log`](performance-schema-error-log-table.html "29.12.21.2 The error_log
    Table") table using the following query:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在错误日志中检查此警告，或通过以下查询查询性能模式[`error_log`](performance-schema-error-log-table.html
    "29.12.21.2 error_log表")表来查询此警告：
- en: '[PRE13]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: To prevent this warning, follow the instructions in [Changing the Error Log
    Configuration Method](error-log-configuration.html#error-log-configuration-change-method
    "Changing the Error Log Configuration Method") to adjust your error log configuration.
    Either an implicit or explicit error log configuration should be used, but not
    both.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 要避免此警告，请按照[更改错误日志配置方法](error-log-configuration.html#error-log-configuration-change-method
    "更改错误日志配置方法")中的说明调整您的错误日志配置。应使用隐式或显式错误日志配置，但不要同时使用两者。
- en: 'A similar error occurs when attempting to explicitly load a component that
    was implicitly loaded at startup. For example, if [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    lists the JSON log sink component, that component is implicitly loaded at startup.
    Attempting to explicitly load the same component later returns this error:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 当尝试显式加载在启动时隐式加载的组件时会出现类似错误。例如，如果[`log_error_services`](server-system-variables.html#sysvar_log_error_services)列出了JSON日志接收器组件，则该组件会在启动时隐式加载。尝试稍后显式加载相同组件会返回此错误：
- en: '[PRE14]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Configuring Multiple Log Sinks
  id: totrans-109
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 配置多个日志接收器
- en: 'It is possible to configure multiple log sinks, which enables sending output
    to multiple destinations. To enable the JSON log sink in addition to (rather than
    instead of) the default sink, set the [`log_error_services`](server-system-variables.html#sysvar_log_error_services)
    value like this:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 可以配置多个日志接收器，从而可以将输出发送到多个目的地。要在默认接收器之外启用JSON日志接收器（而不是替代），请将[`log_error_services`](server-system-variables.html#sysvar_log_error_services)值设置如下：
- en: '[PRE15]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'To revert to using only the default sink and unload the system log sink, execute
    these statements:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 要恢复仅使用默认接收器并卸载系统日志接收器，请执行以下语句：
- en: '[PRE16]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Log Sink Performance Schema Support
  id: totrans-114
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 日志接收器性能模式支持
- en: If enabled log components include a sink that provides Performance Schema support,
    events written to the error log are also written to the Performance Schema [`error_log`](performance-schema-error-log-table.html
    "29.12.21.2 The error_log Table") table. This enables examining error log contents
    using SQL queries. Currently, the traditional-format `log_sink_internal` and JSON-format
    `log_sink_json` sinks support this capability. See [Section 29.12.21.2, “The error_log
    Table”](performance-schema-error-log-table.html "29.12.21.2 The error_log Table").
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 如果启用了记录组件包含支持性能模式的接收器，那么写入错误日志的事件也会写入性能模式的[`error_log`](performance-schema-error-log-table.html
    "29.12.21.2 错误日志表")表中。这样可以使用SQL查询来检查错误日志内容。目前，传统格式的`log_sink_internal`和JSON格式的`log_sink_json`接收器支持此功能。请参阅[Section 29.12.21.2,
    “错误日志表”](performance-schema-error-log-table.html "29.12.21.2 错误日志表")。
