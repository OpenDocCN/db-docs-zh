- en: 原文：[https://dev.mysql.com/doc/refman/8.0/en/replication-options-gtids.html](https://dev.mysql.com/doc/refman/8.0/en/replication-options-gtids.html)
  id: totrans-0
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://dev.mysql.com/doc/refman/8.0/en/replication-options-gtids.html](https://dev.mysql.com/doc/refman/8.0/en/replication-options-gtids.html)
- en: 19.1.6.5 Global Transaction ID System Variables
  id: totrans-1
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 19.1.6.5 全局事务ID系统变量
- en: The MySQL Server system variables described in this section are used to monitor
    and control Global Transaction Identifiers (GTIDs). For additional information,
    see [Section 19.1.3, “Replication with Global Transaction Identifiers”](replication-gtids.html
    "19.1.3 Replication with Global Transaction Identifiers").
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本节描述的MySQL服务器系统变量用于监视和控制全局事务标识符（GTIDs）。有关更多信息，请参见[第19.1.3节，“具有全局事务标识符的复制”](replication-gtids.html
    "19.1.3 具有全局事务标识符的复制")。
- en: '[`binlog_gtid_simple_recovery`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)'
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`binlog_gtid_simple_recovery`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)'
- en: '| Command-Line Format | `--binlog-gtid-simple-recovery[={OFF&#124;ON}]` |'
  id: totrans-4
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 命令行格式 | `--binlog-gtid-simple-recovery[={OFF&#124;ON}]` |'
- en: '| System Variable | `[binlog_gtid_simple_recovery](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)`
    |'
  id: totrans-5
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 系统变量 | `[binlog_gtid_simple_recovery](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)`
    |'
- en: '| Scope | Global |'
  id: totrans-6
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 范围 | 全局 |'
- en: '| Dynamic | No |'
  id: totrans-7
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 动态 | 否 |'
- en: '| [`SET_VAR`](optimizer-hints.html#optimizer-hints-set-var "Variable-Setting
    Hint Syntax") Hint Applies | No |'
  id: totrans-8
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| [`SET_VAR`](optimizer-hints.html#optimizer-hints-set-var "变量设置提示语法")提示��用
    | 否 |'
- en: '| Type | Boolean |'
  id: totrans-9
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 类型 | 布尔值 |'
- en: '| Default Value | `ON` |'
  id: totrans-10
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 默认值 | `ON` |'
- en: This variable controls how binary log files are iterated during the search for
    GTIDs when MySQL starts or restarts.
  id: totrans-11
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此变量控制MySQL启动或重新启动时在搜索GTID时如何迭代二进制日志文件。
- en: When [`binlog_gtid_simple_recovery=TRUE`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery),
    which is the default in MySQL 8.0, the values of [`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)
    and [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged) are computed
    at startup based on the values of `Previous_gtids_log_event` in the most recent
    and oldest binary log files. For a description of the computation, see [The `gtid_purged`
    System Variable](replication-gtids-lifecycle.html#replication-gtids-gtid-purged
    "The gtid_purged System Variable"). This setting accesses only two binary log
    files during server restart. If all binary logs on the server were generated using
    MySQL 5.7.8 or later, [`binlog_gtid_simple_recovery=TRUE`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)
    can always safely be used.
  id: totrans-12
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当[`binlog_gtid_simple_recovery=TRUE`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)（这是MySQL
    8.0中的默认值）时，[`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)和[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)的值在启动时基于最新和最旧的二进制日志文件中的`Previous_gtids_log_event`的值进行计算。有关计算的描述，请参见[gtid_purged系统变量](replication-gtids-lifecycle.html#replication-gtids-gtid-purged
    "gtid_purged系统变量")。此设置在服务器重新启动时仅访问两个二进制日志文件。如果服务器上的所有二进制日志都是使用MySQL 5.7.8或更高版本生成的，则始终可以安全地使用[`binlog_gtid_simple_recovery=TRUE`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)。
- en: 'If any binary logs from MySQL 5.7.7 or older are present on the server (for
    example, following an upgrade of an older server to MySQL 8.0), with [`binlog_gtid_simple_recovery=TRUE`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery),
    [`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed) and [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)
    might be initialized incorrectly in the following two situations:'
  id: totrans-13
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果服务器上存在来自MySQL 5.7.7或更旧版本的任何二进制日志（例如，在将较旧服务器升级到MySQL 8.0后），并且使用[`binlog_gtid_simple_recovery=TRUE`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)，[`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)和[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)
    可能会在以下两种情况下被错误初始化：
- en: The newest binary log was generated by MySQL 5.7.5 or earlier, and [`gtid_mode`](replication-options-gtids.html#sysvar_gtid_mode)
    was `ON` for some binary logs but `OFF` for the newest binary log.
  id: totrans-14
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最新的二进制日志是由MySQL 5.7.5或更早版本生成的，并且对于某些二进制日志，[`gtid_mode`](replication-options-gtids.html#sysvar_gtid_mode)为`ON`，但对于最新的二进制日志为`OFF`。
- en: A `SET @@GLOBAL.gtid_purged` statement was issued on MySQL 5.7.7 or earlier,
    and the binary log that was active at the time of the `SET @@GLOBAL.gtid_purged`
    statement has not yet been purged.
  id: totrans-15
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在MySQL 5.7.7或更早版本上发出了`SET @@GLOBAL.gtid_purged`语句，并且在`SET @@GLOBAL.gtid_purged`语句时处于活动状态的二进制日志尚未被清除。
- en: If an incorrect GTID set is computed in either situation, it remains incorrect
    even if the server is later restarted with [`binlog_gtid_simple_recovery=FALSE`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery).
    If either of these situations apply or might apply on the server, set [`binlog_gtid_simple_recovery=FALSE`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)
    before starting or restarting the server.
  id: totrans-16
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果在任何情况下计算出了不正确的GTID集合，则即使稍后使用[`binlog_gtid_simple_recovery=FALSE`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)重新启动服务器，它仍然是不正确的。如果服务器存在任何这些情况或可能存在这些情况，请在启动或重新启动服务器之前设置[`binlog_gtid_simple_recovery=FALSE`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)。
- en: 'When [`binlog_gtid_simple_recovery=FALSE`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)
    is set, the method of computing [`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)
    and [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged) as described
    in [The `gtid_purged` System Variable](replication-gtids-lifecycle.html#replication-gtids-gtid-purged
    "The gtid_purged System Variable") is changed to iterate the binary log files
    as follows:'
  id: totrans-17
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当设置[`binlog_gtid_simple_recovery=FALSE`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)时，计算[`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)和[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)的方法如[gtid_purged系统变量](replication-gtids-lifecycle.html#replication-gtids-gtid-purged
    "gtid_purged系统变量")中所述，将更改为按以下方式迭代二进制日志文件：
- en: Instead of using the value of `Previous_gtids_log_event` and GTID log events
    from the newest binary log file, the computation for [`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)
    iterates from the newest binary log file, and uses the value of `Previous_gtids_log_event`
    and any GTID log events from the first binary log file where it finds a `Previous_gtids_log_event`
    value. If the server's most recent binary log files do not have GTID log events,
    for example if [`gtid_mode=ON`](replication-options-gtids.html#sysvar_gtid_mode)
    was used but the server was later changed to [`gtid_mode=OFF`](replication-options-gtids.html#sysvar_gtid_mode),
    this process can take a long time.
  id: totrans-18
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不再使用最新的二进制日志文件中的`Previous_gtids_log_event`和GTID日志事件的值，而是从最新的二进制日志文件开始计算[`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)，并使用从第一个二进制日志文件中找到的`Previous_gtids_log_event`值。如果服务器的最近的二进制日志文件没有GTID日志事件，例如如果服务器最初使用了[`gtid_mode=ON`](replication-options-gtids.html#sysvar_gtid_mode)，但稍后将服务器更改为[`gtid_mode=OFF`](replication-options-gtids.html#sysvar_gtid_mode)，这个过程可能需要很长时间。
- en: Instead of using the value of `Previous_gtids_log_event` from the oldest binary
    log file, the computation for [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)
    iterates from the oldest binary log file, and uses the value of `Previous_gtids_log_event`
    from the first binary log file where it finds either a nonempty `Previous_gtids_log_event`
    value, or at least one GTID log event (indicating that the use of GTIDs starts
    at that point). If the server's older binary log files do not have GTID log events,
    for example if [`gtid_mode=ON`](replication-options-gtids.html#sysvar_gtid_mode)
    was only set recently on the server, this process can take a long time.
  id: totrans-19
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不再使用最旧的二进制日志文件中的`Previous_gtids_log_event`的值，而是从最旧的二进制日志文件开始计算[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)，并使用从第一个二进制日志文件中找到的非空`Previous_gtids_log_event`值或至少一个GTID日志事件的值（表示从那一点开始使用GTID）。如果服务器的旧二进制日志文件没有GTID日志事件，例如如果服务器最近才设置了[`gtid_mode=ON`](replication-options-gtids.html#sysvar_gtid_mode)，这个过程可能需要很长时间。
- en: '[`enforce_gtid_consistency`](replication-options-gtids.html#sysvar_enforce_gtid_consistency)'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`enforce_gtid_consistency`](replication-options-gtids.html#sysvar_enforce_gtid_consistency)'
- en: '| Command-Line Format | `--enforce-gtid-consistency[=value]` |'
  id: totrans-21
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 命令行格式 | `--enforce-gtid-consistency[=value]` |'
- en: '| System Variable | `[enforce_gtid_consistency](replication-options-gtids.html#sysvar_enforce_gtid_consistency)`
    |'
  id: totrans-22
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 系统变量 | `[enforce_gtid_consistency](replication-options-gtids.html#sysvar_enforce_gtid_consistency)`
    |'
- en: '| Scope | Global |'
  id: totrans-23
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 范围 | 全局 |'
- en: '| Dynamic | Yes |'
  id: totrans-24
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 动态 | 是 |'
- en: '| [`SET_VAR`](optimizer-hints.html#optimizer-hints-set-var "Variable-Setting
    Hint Syntax") Hint Applies | No |'
  id: totrans-25
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| [`SET_VAR`](optimizer-hints.html#optimizer-hints-set-var "变量设置提示语法")提示适用
    | 否 |'
- en: '| Type | Enumeration |'
  id: totrans-26
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 类型 | 枚举 |'
- en: '| Default Value | `OFF` |'
  id: totrans-27
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 默认值 | `OFF` |'
- en: '| Valid Values | `OFF``ON``WARN` |'
  id: totrans-28
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 有效值 | `OFF``ON``WARN` |'
- en: Depending on the value of this variable, the server enforces GTID consistency
    by allowing execution of only statements that can be safely logged using a GTID.
    You *must* set this variable to `ON` before enabling GTID based replication.
  id: totrans-29
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 根据此变量的值，服务器通过仅允许执行可以安全使用 GTID 记录的语句来强制执行 GTID 一致性。在启用基于 GTID 的复制之前，*必须*将此变量设置为
    `ON`。
- en: 'The values that [`enforce_gtid_consistency`](replication-options-gtids.html#sysvar_enforce_gtid_consistency)
    can be configured to are:'
  id: totrans-30
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '[`enforce_gtid_consistency`](replication-options-gtids.html#sysvar_enforce_gtid_consistency)
    可配置的值为：'
- en: '`OFF`: all transactions are allowed to violate GTID consistency.'
  id: totrans-31
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`OFF`：允许所有事务违反 GTID 一致性。'
- en: '`ON`: no transaction is allowed to violate GTID consistency.'
  id: totrans-32
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ON`：不允许任何事务违反 GTID 一致性。'
- en: '`WARN`: all transactions are allowed to violate GTID consistency, but a warning
    is generated in this case.'
  id: totrans-33
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`WARN`：允许所有事务违反 GTID 一致性，但在这种情况下会生成警告。'
- en: '[`--enforce-gtid-consistency`](replication-options-gtids.html#sysvar_enforce_gtid_consistency)
    only takes effect if binary logging takes place for a statement. If binary logging
    is disabled on the server, or if statements are not written to the binary log
    because they are removed by a filter, GTID consistency is not checked or enforced
    for the statements that are not logged.'
  id: totrans-34
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '[`--enforce-gtid-consistency`](replication-options-gtids.html#sysvar_enforce_gtid_consistency)
    仅在对语句进行二进制日志记录时生效。如果服务器上禁用了二进制日志记录，或者如果语句未写入二进制日志因为它们被过滤器移除，那么对于未记录的语句，GTID 一致性不会被检查或强制执行。'
- en: 'Only statements that can be logged using GTID safe statements can be logged
    when [`enforce_gtid_consistency`](replication-options-gtids.html#sysvar_enforce_gtid_consistency)
    is set to `ON`, so the operations listed here cannot be used with this option:'
  id: totrans-35
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当 [`enforce_gtid_consistency`](replication-options-gtids.html#sysvar_enforce_gtid_consistency)
    设置为 `ON` 时，只有可以使用 GTID 安全语句记录的语句才能被记录，因此以下列出的操作不能与此选项一起使用：
- en: '[`CREATE TEMPORARY TABLE`](create-table.html "15.1.20 CREATE TABLE Statement")
    or [`DROP TEMPORARY TABLE`](drop-table.html "15.1.32 DROP TABLE Statement") statements
    inside transactions.'
  id: totrans-36
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在事务中的 [`CREATE TEMPORARY TABLE`](create-table.html "15.1.20 CREATE TABLE Statement")
    或 [`DROP TEMPORARY TABLE`](drop-table.html "15.1.32 DROP TABLE Statement") 语句。
- en: Transactions or statements that update both transactional and nontransactional
    tables. There is an exception that nontransactional DML is allowed in the same
    transaction or in the same statement as transactional DML, if all *nontransactional*
    tables are temporary.
  id: totrans-37
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更新既包含事务表又包含非事务表的事务或语句。有一个例外，即如果所有*非事务*表都是临时表，则允许在同一事务或同一语句中使用非事务 DML。
- en: '[`CREATE TABLE ... SELECT`](create-table-select.html "15.1.20.4 CREATE TABLE
    ... SELECT Statement") statements, prior to MySQL 8.0.21\. From MySQL 8.0.21,
    [`CREATE TABLE ... SELECT`](create-table-select.html "15.1.20.4 CREATE TABLE ...
    SELECT Statement") statements are allowed for storage engines that support atomic
    DDL.'
  id: totrans-38
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`CREATE TABLE ... SELECT`](create-table-select.html "15.1.20.4 CREATE TABLE
    ... SELECT Statement") 语句，在 MySQL 8.0.21 之前。从 MySQL 8.0.21 开始，支持原子 DDL 的存储引擎允许
    [`CREATE TABLE ... SELECT`](create-table-select.html "15.1.20.4 CREATE TABLE ...
    SELECT Statement") 语句。'
- en: For more information, see [Section 19.1.3.7, “Restrictions on Replication with
    GTIDs”](replication-gtids-restrictions.html "19.1.3.7 Restrictions on Replication
    with GTIDs").
  id: totrans-39
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 更多信息，请参阅 [Section 19.1.3.7, “使用 GTID 限制复制”](replication-gtids-restrictions.html
    "19.1.3.7 Restrictions on Replication with GTIDs")。
- en: 'Prior to MySQL 5.7 and in early releases in that release series, the boolean
    [`enforce_gtid_consistency`](replication-options-gtids.html#sysvar_enforce_gtid_consistency)
    defaulted to `OFF`. To maintain compatibility with these earlier releases, the
    enumeration defaults to `OFF`, and setting [`--enforce-gtid-consistency`](replication-options-gtids.html#sysvar_enforce_gtid_consistency)
    without a value is interpreted as setting the value to `ON`. The variable also
    has multiple textual aliases for the values: `0=OFF=FALSE`, `1=ON=TRUE`,`2=WARN`.
    This differs from other enumeration types but maintains compatibility with the
    boolean type used in previous releases. These changes impact on what is returned
    by the variable. Using `SELECT @@ENFORCE_GTID_CONSISTENCY`, `SHOW VARIABLES LIKE
    ''ENFORCE_GTID_CONSISTENCY''`, and `SELECT * FROM INFORMATION_SCHEMA.VARIABLES
    WHERE ''VARIABLE_NAME'' = ''ENFORCE_GTID_CONSISTENCY''`, all return the textual
    form, not the numeric form. This is an incompatible change, since `@@ENFORCE_GTID_CONSISTENCY`
    returns the numeric form for booleans but returns the textual form for `SHOW`
    and the Information Schema.'
  id: totrans-40
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在MySQL 5.7之前以及在该版本系列的早期版本中，布尔值[`enforce_gtid_consistency`](replication-options-gtids.html#sysvar_enforce_gtid_consistency)默认为`OFF`。为了与这些早期版本保持兼容性，枚举默认为`OFF`，并且设置[`--enforce-gtid-consistency`](replication-options-gtids.html#sysvar_enforce_gtid_consistency)而不带值被解释为将值设置为`ON`。该变量还具有多个文本别名用于表示值：`0=OFF=FALSE`，`1=ON=TRUE`，`2=WARN`。这与其他枚举类型不同，但保持了与先前版本中使用的布尔类型的兼容性。这些更改影响了变量返回的内容。使用`SELECT
    @@ENFORCE_GTID_CONSISTENCY`，`SHOW VARIABLES LIKE 'ENFORCE_GTID_CONSISTENCY'`和`SELECT
    * FROM INFORMATION_SCHEMA.VARIABLES WHERE 'VARIABLE_NAME' = 'ENFORCE_GTID_CONSISTENCY'`，都返回文本形式，而不是数字形式。这是一个不兼容的更改，因为`@@ENFORCE_GTID_CONSISTENCY`对于布尔值返回数字形式，但对于`SHOW`和信息模式返回文本形式。
- en: '[`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)'
- en: '| System Variable | `[gtid_executed](replication-options-gtids.html#sysvar_gtid_executed)`
    |'
  id: totrans-42
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 系统变量 | `[gtid_executed](replication-options-gtids.html#sysvar_gtid_executed)`
    |'
- en: '| Scope | Global |'
  id: totrans-43
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 范围 | 全局 |'
- en: '| Dynamic | No |'
  id: totrans-44
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 动态 | 否 |'
- en: '| [`SET_VAR`](optimizer-hints.html#optimizer-hints-set-var "Variable-Setting
    Hint Syntax") Hint Applies | No |'
  id: totrans-45
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| [`SET_VAR`](optimizer-hints.html#optimizer-hints-set-var "Variable-Setting
    Hint Syntax") Hint Applies | 否 |'
- en: '| Type | String |'
  id: totrans-46
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 类型 | 字符串 |'
- en: '| Unit | set of GTIDs |'
  id: totrans-47
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 单位 | GTID集合 |'
- en: When used with global scope, this variable contains a representation of the
    set of all transactions executed on the server and GTIDs that have been set by
    a [`SET`](set-variable.html "15.7.6.1 SET Syntax for Variable Assignment") [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)
    statement. This is the same as the value of the `Executed_Gtid_Set` column in
    the output of [`SHOW MASTER STATUS`](show-master-status.html "15.7.7.23 SHOW MASTER
    STATUS Statement") and [`SHOW REPLICA STATUS`](show-replica-status.html "15.7.7.35 SHOW
    REPLICA STATUS Statement"). The value of this variable is a GTID set, see [GTID
    Sets](replication-gtids-concepts.html#replication-gtids-concepts-gtid-sets "GTID
    Sets") for more information.
  id: totrans-48
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当与全局范围一起使用时，此变量包含服务器上执行的所有事务和由[`SET`](set-variable.html "15.7.6.1 变量赋值的SET语法")
    [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)语句设置的GTIDs的表示。这与[`SHOW
    MASTER STATUS`](show-master-status.html "15.7.7.23 SHOW MASTER STATUS语句")和[`SHOW
    REPLICA STATUS`](show-replica-status.html "15.7.7.35 SHOW REPLICA STATUS语句")输出中的`Executed_Gtid_Set`列的值相同。此变量的值是一个GTID集合，请参阅[GTID
    Sets](replication-gtids-concepts.html#replication-gtids-concepts-gtid-sets "GTID
    Sets")获取更多信息。
- en: When the server starts, `@@GLOBAL.gtid_executed` is initialized. See [`binlog_gtid_simple_recovery`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)
    for more information on how binary logs are iterated to populate [`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed).
    GTIDs are then added to the set as transactions are executed, or if any [`SET`](set-variable.html
    "15.7.6.1 SET Syntax for Variable Assignment") [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)
    statement is executed.
  id: totrans-49
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当服务器启动时，`@@GLOBAL.gtid_executed`被初始化。有关如何迭代二进制日志以填充[`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)的更多信息，请参阅[`binlog_gtid_simple_recovery`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)。随着事务的执行或执行任何[`SET`](set-variable.html
    "15.7.6.1 变量赋值的SET语法") [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)语句，GTIDs将被添加到集合中。
- en: The set of transactions that can be found in the binary logs at any given time
    is equal to [`GTID_SUBTRACT(@@GLOBAL.gtid_executed, @@GLOBAL.gtid_purged)`](gtid-functions.html#function_gtid-subtract);
    that is, to all transactions in the binary log that have not yet been purged.
  id: totrans-50
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在任何给定时间可以在二进制日志中找到的事务集合等于 [`GTID_SUBTRACT(@@GLOBAL.gtid_executed, @@GLOBAL.gtid_purged)`](gtid-functions.html#function_gtid-subtract)；也就是说，所有尚未清除的二进制日志中的事务。
- en: Issuing [`RESET MASTER`](reset-master.html "15.4.1.2 RESET MASTER Statement")
    causes the global value (but not the session value) of this variable to be reset
    to an empty string. GTIDs are not otherwise removed from this set other than when
    the set is cleared due to `RESET MASTER`.
  id: totrans-51
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 执行 [`RESET MASTER`](reset-master.html "15.4.1.2 RESET MASTER Statement") 会导致这个变量的全局值（但不包括会话值）被重置为空字符串。除非由于
    `RESET MASTER` 而清除了该集合，否则 GTID 不会从该集合中删除。
- en: '[`gtid_executed_compression_period`](replication-options-gtids.html#sysvar_gtid_executed_compression_period)'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`gtid_executed_compression_period`](replication-options-gtids.html#sysvar_gtid_executed_compression_period)'
- en: '| Command-Line Format | `--gtid-executed-compression-period=#` |'
  id: totrans-53
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 命令行格式 | `--gtid-executed-compression-period=#` |'
- en: '| System Variable | `[gtid_executed_compression_period](replication-options-gtids.html#sysvar_gtid_executed_compression_period)`
    |'
  id: totrans-54
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 系统变量 | `[gtid_executed_compression_period](replication-options-gtids.html#sysvar_gtid_executed_compression_period)`
    |'
- en: '| Scope | Global |'
  id: totrans-55
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 作用域 | 全局 |'
- en: '| Dynamic | Yes |'
  id: totrans-56
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 动态 | 是 |'
- en: '| [`SET_VAR`](optimizer-hints.html#optimizer-hints-set-var "Variable-Setting
    Hint Syntax") Hint Applies | No |'
  id: totrans-57
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| [`SET_VAR`](optimizer-hints.html#optimizer-hints-set-var "Variable-Setting
    Hint Syntax") 提示适用 | 否 |'
- en: '| Type | Integer |'
  id: totrans-58
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 类型 | 整数 |'
- en: '| Default Value (≥ 8.0.23) | `0` |'
  id: totrans-59
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 默认值（≥ 8.0.23） | `0` |'
- en: '| Default Value (≤ 8.0.22) | `1000` |'
  id: totrans-60
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 默认值（≤ 8.0.22） | `1000` |'
- en: '| Minimum Value | `0` |'
  id: totrans-61
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 最小值 | `0` |'
- en: '| Maximum Value | `4294967295` |'
  id: totrans-62
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 最大值 | `4294967295` |'
- en: Compress the `mysql.gtid_executed` table each time this many transactions have
    been processed. When binary logging is enabled on the server, this compression
    method is not used, and instead the `mysql.gtid_executed` table is compressed
    on each binary log rotation. When binary logging is disabled on the server, the
    compression thread sleeps until the specified number of transactions have been
    executed, then wakes up to perform compression of the `mysql.gtid_executed` table.
    Setting the value of this system variable to 0 means that the thread never wakes
    up, so this explicit compression method is not used. Instead, compression occurs
    implicitly as required.
  id: totrans-63
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 每处理这么多事务时，压缩 `mysql.gtid_executed` 表。当服务器启用二进制日志记录时，不会使用这种压缩方法，而是在每次二进制日志轮换时压缩
    `mysql.gtid_executed` 表。当服务器禁用二进制日志记录时，压缩线程会休眠，直到执行了指定数量的事务，然后唤醒以执行 `mysql.gtid_executed`
    表的压缩。将此系统变量的值设置为 0 表示线程永远不会唤醒，因此不会使用这种显式压缩方法。相反，压缩会根据需要隐式发生。
- en: From MySQL 8.0.17, `InnoDB` transactions are written to the `mysql.gtid_executed`
    table by a separate process to non-`InnoDB` transactions. If the server has a
    mix of `InnoDB` transactions and non-`InnoDB` transactions, the compression controlled
    by this system variable interferes with the work of this process and can slow
    it significantly. For this reason, from that release it is recommended that you
    set [`gtid_executed_compression_period`](replication-options-gtids.html#sysvar_gtid_executed_compression_period)
    to 0.
  id: totrans-64
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 从 MySQL 8.0.17 开始，`InnoDB` 事务由一个单独的进程写入到 `mysql.gtid_executed` 表中，而非 `InnoDB`
    事务。如果服务器同时存在 `InnoDB` 事务和非 `InnoDB` 事务，那么由这个系统变量控制的压缩会干扰这个进程的工作，并且可能显著减慢速度。因此，从那个版本开始，建议将
    [`gtid_executed_compression_period`](replication-options-gtids.html#sysvar_gtid_executed_compression_period)
    设置为 0。
- en: From MySQL 8.0.23, `InnoDB` and non-`InnoDB` transactions are written to the
    `mysql.gtid_executed` table by the same process, and the [`gtid_executed_compression_period`](replication-options-gtids.html#sysvar_gtid_executed_compression_period)
    default value is 0.
  id: totrans-65
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 从 MySQL 8.0.23 开始，`InnoDB` 和非 `InnoDB` 事务由同一进程写入到 `mysql.gtid_executed` 表中，并且
    [`gtid_executed_compression_period`](replication-options-gtids.html#sysvar_gtid_executed_compression_period)
    的默认值为 0。
- en: See [mysql.gtid_executed Table Compression](replication-gtids-concepts.html#replication-gtids-gtid-executed-table-compression
    "mysql.gtid_executed Table Compression") for more information.
  id: totrans-66
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 更多信息请参见 [mysql.gtid_executed 表压缩](replication-gtids-concepts.html#replication-gtids-gtid-executed-table-compression
    "mysql.gtid_executed Table Compression")。
- en: '[`gtid_mode`](replication-options-gtids.html#sysvar_gtid_mode)'
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`gtid_mode`](replication-options-gtids.html#sysvar_gtid_mode)'
- en: '| Command-Line Format | `--gtid-mode=MODE` |'
  id: totrans-68
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 命令行格式 | `--gtid-mode=MODE` |'
- en: '| System Variable | `[gtid_mode](replication-options-gtids.html#sysvar_gtid_mode)`
    |'
  id: totrans-69
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 系统变量 | `[gtid_mode](replication-options-gtids.html#sysvar_gtid_mode)` |'
- en: '| Scope | Global |'
  id: totrans-70
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 范围 | 全局 |'
- en: '| Dynamic | Yes |'
  id: totrans-71
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 动态 | 是 |'
- en: '| [`SET_VAR`](optimizer-hints.html#optimizer-hints-set-var "Variable-Setting
    Hint Syntax") Hint Applies | No |'
  id: totrans-72
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| [`SET_VAR`](optimizer-hints.html#optimizer-hints-set-var "变量设置提示语法") 提示适用
    | 否 |'
- en: '| Type | Enumeration |'
  id: totrans-73
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 类型 | 枚举 |'
- en: '| Default Value | `OFF` |'
  id: totrans-74
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 默认值 | `OFF` |'
- en: '| Valid Values | `OFF``OFF_PERMISSIVE``ON_PERMISSIVE``ON` |'
  id: totrans-75
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 有效值 | `OFF``OFF_PERMISSIVE``ON_PERMISSIVE``ON` |'
- en: Controls whether GTID based logging is enabled and what type of transactions
    the logs can contain. You must have privileges sufficient to set global system
    variables. See [Section 7.1.9.1, “System Variable Privileges”](system-variable-privileges.html
    "7.1.9.1 System Variable Privileges"). [`enforce_gtid_consistency`](replication-options-gtids.html#sysvar_enforce_gtid_consistency)
    must be set to `ON` before you can set [`gtid_mode=ON`](replication-options-gtids.html#sysvar_gtid_mode).
    Before modifying this variable, see [Section 19.1.4, “Changing GTID Mode on Online
    Servers”](replication-mode-change-online.html "19.1.4 Changing GTID Mode on Online
    Servers").
  id: totrans-76
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 控制GTID基础日志记录是否启用以及日志可以包含什么类型的事务。您必须具有足够的权限来设置全局系统变量。请参阅[第7.1.9.1节，“系统变量权限”](system-variable-privileges.html
    "7.1.9.1 系统变量权限")。在设置[`gtid_mode=ON`](replication-options-gtids.html#sysvar_gtid_mode)之前，必须将[`enforce_gtid_consistency`](replication-options-gtids.html#sysvar_enforce_gtid_consistency)设置为`ON`。在修改此变量之前，请参阅[第19.1.4节，“在线服务器上更改GTID模式”](replication-mode-change-online.html
    "19.1.4 在线服务器上更改GTID模式")。
- en: 'Logged transactions can be either anonymous or use GTIDs. Anonymous transactions
    rely on binary log file and position to identify specific transactions. GTID transactions
    have a unique identifier that is used to refer to transactions. The different
    modes are:'
  id: totrans-77
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 记录的事务可以是匿名的或者使用GTIDs。匿名事务依赖于二进制日志文件和位置来识别特定事务。GTID事务具有用于引用事务的唯一标识符。不同的模式包括：
- en: '`OFF`: Both new and replicated transactions must be anonymous.'
  id: totrans-78
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`OFF`: 新事务和复制事务都必须是匿名的。'
- en: '`OFF_PERMISSIVE`: New transactions are anonymous. Replicated transactions can
    be either anonymous or GTID transactions.'
  id: totrans-79
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`OFF_PERMISSIVE`: 新事务是匿名的。复制事务可以是匿名的或者GTID事务。'
- en: '`ON_PERMISSIVE`: New transactions are GTID transactions. Replicated transactions
    can be either anonymous or GTID transactions.'
  id: totrans-80
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ON_PERMISSIVE`: 新事务是GTID事务。复制事务可以是匿名的或���GTID事务。'
- en: '`ON`: Both new and replicated transactions must be GTID transactions.'
  id: totrans-81
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ON`: 新事务和复制事务都必须是GTID事务。'
- en: Changes from one value to another can only be one step at a time. For example,
    if [`gtid_mode`](replication-options-gtids.html#sysvar_gtid_mode) is currently
    set to `OFF_PERMISSIVE`, it is possible to change to `OFF` or `ON_PERMISSIVE`
    but not to `ON`.
  id: totrans-82
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 从一个值更改为另一个值只能一次一步。例如，如果[`gtid_mode`](replication-options-gtids.html#sysvar_gtid_mode)当前设置为`OFF_PERMISSIVE`，则可以更改为`OFF`或`ON_PERMISSIVE`，但不能更改为`ON`。
- en: The values of [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)
    and [`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed) are
    persistent regardless of the value of [`gtid_mode`](replication-options-gtids.html#sysvar_gtid_mode).
    Therefore even after changing the value of [`gtid_mode`](replication-options-gtids.html#sysvar_gtid_mode),
    these variables contain the correct values.
  id: totrans-83
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)和[`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)的值是持久的，无论[`gtid_mode`](replication-options-gtids.html#sysvar_gtid_mode)的值如何。因此，即使更改了[`gtid_mode`](replication-options-gtids.html#sysvar_gtid_mode)的值，这些变量仍包含正确的值。'
- en: '[`gtid_next`](replication-options-gtids.html#sysvar_gtid_next)'
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`gtid_next`](replication-options-gtids.html#sysvar_gtid_next)'
- en: '| System Variable | `[gtid_next](replication-options-gtids.html#sysvar_gtid_next)`
    |'
  id: totrans-85
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 系统变量 | `[gtid_next](replication-options-gtids.html#sysvar_gtid_next)` |'
- en: '| Scope | Session |'
  id: totrans-86
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 范围 | 会话 |'
- en: '| Dynamic | Yes |'
  id: totrans-87
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 动态 | 是 |'
- en: '| [`SET_VAR`](optimizer-hints.html#optimizer-hints-set-var "Variable-Setting
    Hint Syntax") Hint Applies | No |'
  id: totrans-88
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| [`SET_VAR`](optimizer-hints.html#optimizer-hints-set-var "变量设置提示语法") 提示适用
    | 否 |'
- en: '| Type | Enumeration |'
  id: totrans-89
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 类型 | 枚举 |'
- en: '| Default Value | `AUTOMATIC` |'
  id: totrans-90
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 默认值 | `AUTOMATIC` |'
- en: '| Valid Values | `AUTOMATIC``ANONYMOUS``<UUID>:<NUMBER>` |'
  id: totrans-91
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 有效值 | `AUTOMATIC``ANONYMOUS``<UUID>:<NUMBER>` |'
- en: This variable is used to specify whether and how the next GTID is obtained.
  id: totrans-92
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 此变量用于指定下一个GTID是否以及如何获取。
- en: Setting the session value of this system variable is a restricted operation.
    The session user must have either the [`REPLICATION_APPLIER`](privileges-provided.html#priv_replication-applier)
    privilege (see [Section 19.3.3, “Replication Privilege Checks”](replication-privilege-checks.html
    "19.3.3 Replication Privilege Checks")), or privileges sufficient to set restricted
    session variables (see [Section 7.1.9.1, “System Variable Privileges”](system-variable-privileges.html
    "7.1.9.1 System Variable Privileges")).
  id: totrans-93
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 设置此系统变量的会话值是受限制的操作。会话用户必须具有[`REPLICATION_APPLIER`](privileges-provided.html#priv_replication-applier)权限（参见[Section 19.3.3,
    “Replication Privilege Checks”](replication-privilege-checks.html "19.3.3 Replication
    Privilege Checks")），或具有足够权限设置受限制的会话变量（参见[Section 7.1.9.1, “System Variable Privileges”](system-variable-privileges.html
    "7.1.9.1 System Variable Privileges")）。
- en: '`gtid_next` can take any of the following values:'
  id: totrans-94
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`gtid_next` 可以取以下任一值：'
- en: '`AUTOMATIC`: Use the next automatically-generated global transaction ID.'
  id: totrans-95
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`AUTOMATIC`: 使用下一个自动生成的全局事务ID。'
- en: '`ANONYMOUS`: Transactions do not have global identifiers, and are identified
    by file and position only.'
  id: totrans-96
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ANONYMOUS`: 事务没有全局标识符，仅通过文件和位置进行标识。'
- en: A global transaction ID in *`UUID`*:*`NUMBER`* format.
  id: totrans-97
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 以 *`UUID`*:*`NUMBER`* 格式的全局事务ID。
- en: Exactly which of the above options are valid depends on the setting of [`gtid_mode`](replication-options-gtids.html#sysvar_gtid_mode),
    see [Section 19.1.4.1, “Replication Mode Concepts”](replication-mode-change-online-concepts.html
    "19.1.4.1 Replication Mode Concepts") for more information. Setting this variable
    has no effect if [`gtid_mode`](replication-options-gtids.html#sysvar_gtid_mode)
    is `OFF`.
  id: totrans-98
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 以上哪些选项有效取决于[`gtid_mode`](replication-options-gtids.html#sysvar_gtid_mode)的设置，更多信息请参见[Section 19.1.4.1,
    “Replication Mode Concepts”](replication-mode-change-online-concepts.html "19.1.4.1 Replication
    Mode Concepts")。如果[`gtid_mode`](replication-options-gtids.html#sysvar_gtid_mode)为`OFF`，设置此变量不会产生任何效果。
- en: After this variable has been set to *`UUID`*:*`NUMBER`*, and a transaction has
    been committed or rolled back, an explicit `SET GTID_NEXT` statement must again
    be issued before any other statement.
  id: totrans-99
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在将此变量设置为 *`UUID`*:*`NUMBER`* 后，事务已经提交或回滚之后，必须再次发出明确的 `SET GTID_NEXT` 语句，然后才能执行其他语句。
- en: '[`DROP TABLE`](drop-table.html "15.1.32 DROP TABLE Statement") or [`DROP TEMPORARY
    TABLE`](drop-table.html "15.1.32 DROP TABLE Statement") fails with an explicit
    error when used on a combination of nontemporary tables with temporary tables,
    or of temporary tables using transactional storage engines with temporary tables
    using nontransactional storage engines.'
  id: totrans-100
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '[`DROP TABLE`](drop-table.html "15.1.32 DROP TABLE Statement") 或 [`DROP TEMPORARY
    TABLE`](drop-table.html "15.1.32 DROP TABLE Statement") 在将非临时表与临时表组合使用，或者使用事务存储引擎的临时表与使用非事务存储引擎的临时表时会失败，并显示明确的错误。'
- en: '[`gtid_owned`](replication-options-gtids.html#sysvar_gtid_owned)'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`gtid_owned`](replication-options-gtids.html#sysvar_gtid_owned)'
- en: '| System Variable | `[gtid_owned](replication-options-gtids.html#sysvar_gtid_owned)`
    |'
  id: totrans-102
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 系统变量 | `[gtid_owned](replication-options-gtids.html#sysvar_gtid_owned)` |'
- en: '| Scope | Global, Session |'
  id: totrans-103
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 范围 | 全局，会话 |'
- en: '| Dynamic | No |'
  id: totrans-104
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 动态 | 否 |'
- en: '| [`SET_VAR`](optimizer-hints.html#optimizer-hints-set-var "Variable-Setting
    Hint Syntax") Hint Applies | No |'
  id: totrans-105
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| [`SET_VAR`](optimizer-hints.html#optimizer-hints-set-var "Variable-Setting
    Hint Syntax") 提示适用 | 否 |'
- en: '| Type | String |'
  id: totrans-106
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 类型 | 字符串 |'
- en: '| Unit | set of GTIDs |'
  id: totrans-107
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 单元 | GTID集合 |'
- en: This read-only variable is primarily for internal use. Its contents depend on
    its scope.
  id: totrans-108
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这个只读变量主要用于内部使用。其内容取决于其范围。
- en: When used with global scope, [`gtid_owned`](replication-options-gtids.html#sysvar_gtid_owned)
    holds a list of all the GTIDs that are currently in use on the server, with the
    IDs of the threads that own them. This variable is mainly useful for a multi-threaded
    replica to check whether a transaction is already being applied on another thread.
    An applier thread takes ownership of a transaction's GTID all the time it is processing
    the transaction, so `@@global.gtid_owned` shows the GTID and owner for the duration
    of processing. When a transaction has been committed (or rolled back), the applier
    thread releases ownership of the GTID.
  id: totrans-109
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当在全局范围内使用时，[`gtid_owned`](replication-options-gtids.html#sysvar_gtid_owned)
    保存着服务器当前正在使用的所有GTID的列表，以及拥有它们的线程的ID。这个变量主要用于多线程复制，以检查事务是否已经在另一个线程上应用。应用程序线程在处理事务时始终拥有事务的GTID，因此`@@global.gtid_owned`在处理过程中显示GTID和所有者。当事务已经提交（或回滚）时，应用程序线程释放GTID的所有权。
- en: When used with session scope, [`gtid_owned`](replication-options-gtids.html#sysvar_gtid_owned)
    holds a single GTID that is currently in use by and owned by this session. This
    variable is mainly useful for testing and debugging the use of GTIDs when the
    client has explicitly assigned a GTID for the transaction by setting [`gtid_next`](replication-options-gtids.html#sysvar_gtid_next).
    In this case, `@@session.gtid_owned` displays the GTID all the time the client
    is processing the transaction, until the transaction has been committed (or rolled
    back). When the client has finished processing the transaction, the variable is
    cleared. If [`gtid_next=AUTOMATIC`](replication-options-gtids.html#sysvar_gtid_next)
    is used for the session, [`gtid_owned`](replication-options-gtids.html#sysvar_gtid_owned)
    is populated only briefly during the execution of the commit statement for the
    transaction, so it cannot be observed from the session concerned, although it
    is listed if `@@global.gtid_owned` is read at the right point. If you have a requirement
    to track the GTIDs that are handled by a client in a session, you can enable the
    session state tracker controlled by the [`session_track_gtids`](server-system-variables.html#sysvar_session_track_gtids)
    system variable.
  id: totrans-110
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当与会话范围一起使用时，[`gtid_owned`](replication-options-gtids.html#sysvar_gtid_owned)保存当前由此会话使用并拥有的单个GTID。此变量主要用于测试和调试在客户端通过设置[`gtid_next`](replication-options-gtids.html#sysvar_gtid_next)显式分配事务的GTID时GTID的使用情况。在这种情况下，`@@session.gtid_owned`在客户端处理事务时始终显示GTID，直到事务已提交（或回滚）。当客户端完成处理事务时，变量将被清除。如果会话使用[`gtid_next=AUTOMATIC`](replication-options-gtids.html#sysvar_gtid_next)，则[`gtid_owned`](replication-options-gtids.html#sysvar_gtid_owned)仅在事务的提交语句执行期间短暂填充，因此无法从相关会话中观察到，尽管在正确时刻读取`@@global.gtid_owned`时会列出。如果您有跟踪客户端在会话中处理的GTID的要求，可以启用由[`session_track_gtids`](server-system-variables.html#sysvar_session_track_gtids)系统变量控制的会话状态跟踪器。
- en: '[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)'
- en: '| System Variable | `[gtid_purged](replication-options-gtids.html#sysvar_gtid_purged)`
    |'
  id: totrans-112
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 系统变量 | `[gtid_purged](replication-options-gtids.html#sysvar_gtid_purged)`
    |'
- en: '| Scope | Global |'
  id: totrans-113
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 范围 | 全局 |'
- en: '| Dynamic | Yes |'
  id: totrans-114
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 动态 | 是 |'
- en: '| [`SET_VAR`](optimizer-hints.html#optimizer-hints-set-var "Variable-Setting
    Hint Syntax") Hint Applies | No |'
  id: totrans-115
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| [`SET_VAR`](optimizer-hints.html#optimizer-hints-set-var "变量设置提示语法")提示适用
    | 否 |'
- en: '| Type | String |'
  id: totrans-116
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 类型 | 字符串 |'
- en: '| Unit | set of GTIDs |'
  id: totrans-117
  prefs:
  - PREF_IND
  type: TYPE_TB
  zh: '| 单位 | GTID集合 |'
- en: 'The global value of the [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)
    system variable (`@@GLOBAL.gtid_purged`) is a GTID set consisting of the GTIDs
    of all the transactions that have been committed on the server, but do not exist
    in any binary log file on the server. [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)
    is a subset of [`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed).
    The following categories of GTIDs are in [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged):'
  id: totrans-118
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 全局值[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)系统变量（`@@GLOBAL.gtid_purged`）是一个GTID集，包含在服务器上已提交但不在服务器上任何二进制日志文件中存在的所有事务的GTID。[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)是[`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)的子集。[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)中包含以下类别的GTID：
- en: GTIDs of replicated transactions that were committed with binary logging disabled
    on the replica.
  id: totrans-119
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 已在副本上以二进制日志记录禁用的事务的复制GTID。
- en: GTIDs of transactions that were written to a binary log file that has now been
    purged.
  id: totrans-120
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 现在已清除的二进制日志文件中写入的事务的GTID。
- en: GTIDs that were added explicitly to the set by the statement `SET @@GLOBAL.gtid_purged`.
  id: totrans-121
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 明确通过语句`SET @@GLOBAL.gtid_purged`添加到集合中的GTID。
- en: When the server starts, the global value of [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)
    is initialized to a set of GTIDs. For information on how this GTID set is computed,
    see [The `gtid_purged` System Variable](replication-gtids-lifecycle.html#replication-gtids-gtid-purged
    "The gtid_purged System Variable"). If binary logs from MySQL 5.7.7 or older are
    present on the server, you might need to set [`binlog_gtid_simple_recovery=FALSE`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)
    in the server's configuration file to produce the correct computation. See the
    description for [`binlog_gtid_simple_recovery`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)
    for details of the situations in which this setting is needed.
  id: totrans-122
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 当服务器启动时，全局的[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)的值会被初始化为一组GTID。有关如何计算此GTID集合的信息，请参阅[gtid_purged系统变量](replication-gtids-lifecycle.html#replication-gtids-gtid-purged
    "gtid_purged系统变量")。如果服务器上存在来自MySQL 5.7.7或更早版本的二进制日志，则可能需要在服务器的配置文件中设置[`binlog_gtid_simple_recovery=FALSE`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)以生成正确的计算。有关需要此设置的情况的详细信息，请参阅[`binlog_gtid_simple_recovery`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)的描述。
- en: Issuing [`RESET MASTER`](reset-master.html "15.4.1.2 RESET MASTER Statement")
    causes the value of [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)
    to be reset to an empty string.
  id: totrans-123
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 执行[`RESET MASTER`](reset-master.html "15.4.1.2 RESET MASTER Statement")会导致[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)的值被重置为空字符串。
- en: You can set the value of [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)
    in order to record on the server that the transactions in a certain GTID set have
    been applied, although they do not exist in any binary log on the server. An example
    use case for this action is when you are restoring a backup of one or more databases
    on a server, but you do not have the relevant binary logs containing the transactions
    on the server.
  id: totrans-124
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 您可以设置[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)的值，以记录服务器上已应用某个GTID集合中的事务，尽管这些事务在服务器上的任何二进制日志中都不存在。此操作的一个示例用例是在服务器上恢复一个或多个数据库的备份时，但您没有包含这些事务的相关二进制日志。
- en: Important
  id: totrans-125
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 重要提示
- en: GTIDs are only available on a server instance up to the number of non-negative
    values for a signed 64-bit integer (2 to the power of 63, minus 1). If you set
    the value of [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)
    to a number that approaches this limit, subsequent commits can cause the server
    to run out of GTIDs and take the action specified by [`binlog_error_action`](replication-options-binary-log.html#sysvar_binlog_error_action).
    From MySQL 8.0.23, a warning message is issued when the server instance is approaching
    the limit.
  id: totrans-126
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: GTID仅在服务器实例上可用，直到有符号64位整数的非负值的数量（2的63次方减1）。如果您将[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)的值设置为接近此限制的数字，后续的提交可能会导致服务器耗尽GTID并执行[`binlog_error_action`](replication-options-binary-log.html#sysvar_binlog_error_action)指定的操作。从MySQL
    8.0.23开始，当服务器实例接近限制时会发出警告消息。
- en: From MySQL 8.0, there are two ways to set the value of [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged).
    You can either replace the value of [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)
    with your specified GTID set, or you can append your specified GTID set to the
    GTID set that is already held by [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged).
    If the server has no existing GTIDs, for example an empty server that you are
    provisioning with a backup of an existing database, both methods have the same
    result. If you are restoring a backup that overlaps the transactions that are
    already on the server, for example replacing a corrupted table with a partial
    dump from the source made using [**mysqldump**](mysqldump.html "6.5.4 mysqldump
    — A Database Backup Program") (which includes the GTIDs of all the transactions
    on the server, even though the dump is partial), use the first method of replacing
    the value of [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged).
    If you are restoring a backup that is disjoint from the transactions that are
    already on the server, for example provisioning a multi-source replica using dumps
    from two different servers, use the second method of adding to the value of [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged).
  id: totrans-127
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 从MySQL 8.0开始，有两种方法可以设置[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)的值。您可以用您指定的GTID集替换[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)的值，或者将您指定的GTID集附加到已由[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)持有的GTID集中。如果服务器没有现有的GTIDs，例如您正在使用现有数据库的备份进行配置的空服务器，两种方法都会产生相同的结果。如果您正在恢复与服务器上已有的事务重叠的备份，例如用[**mysqldump**](mysqldump.html
    "6.5.4 mysqldump — A Database Backup Program")（即使备份是部分的，也包括服务器上所有事务的GTIDs）从源创建的部分转储替换受损表，使用第一种方法替换[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)的值。如果您正在恢复与服务器上已有的事务不重叠的备份，例如使用来自两个不同服务器的转储进行多源复制的配置，使用第二种方法添加到[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)的值。
- en: 'To replace the value of [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)
    with your specified GTID set, use the following statement:'
  id: totrans-128
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要用您指定的GTID集替换[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)的值，请使用以下语句：
- en: '[PRE0]'
  id: totrans-129
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '`gtid_set` must be a superset of the current value of [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged),
    and must not intersect with `gtid_subtract(gtid_executed,gtid_purged)`. In other
    words, the new GTID set **must** include any GTIDs that were already in [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged),
    and **must not** include any GTIDs in [`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)
    that have not yet been purged. `gtid_set` also cannot include any GTIDs that are
    in `@@global.gtid_owned`, that is, the GTIDs for transactions that are currently
    being processed on the server.'
  id: totrans-130
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`gtid_set`必须是当前[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)值的超集，并且不能与`gtid_subtract(gtid_executed,gtid_purged)`相交。换句话说，新的GTID集合**必须**包括已经在[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)中的任何GTIDs，并且**不能**包括尚未被清除的[`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)中的任何GTIDs。`gtid_set`也不能包括任何在`@@global.gtid_owned`中的GTIDs，即当前正在服务器上处理的事务的GTIDs。'
- en: The result is that the global value of [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)
    is set equal to `gtid_set`, and the value of [`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)
    becomes the union of `gtid_set` and the previous value of [`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed).
  id: totrans-131
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 结果是全局值[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)被设置为`gtid_set`，而[`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)的值变为`gtid_set`和先前[`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)的值的并集。
- en: 'To append your specified GTID set to [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged),
    use the following statement with a plus sign (+) before the GTID set:'
  id: totrans-132
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要将您指定的GTID集附加到[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)，请使用以下带有加号(+)的语句：
- en: '[PRE1]'
  id: totrans-133
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '`gtid_set` **must not** intersect with the current value of [`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed).
    In other words, the new GTID set must not include any GTIDs in [`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed),
    including transactions that are already also in [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged).
    `gtid_set` also cannot include any GTIDs that are in `@@global.gtid_owned`, that
    is, the GTIDs for transactions that are currently being processed on the server.'
  id: totrans-134
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`gtid_set` **绝对不能**与当前值[`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)相交。换句话说，新的GTID集不能包含[`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)中的任何GTID，包括已经在[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)中的事务。`gtid_set`也不能包含任何在`@@global.gtid_owned`中的GTID，即当前正在服务器上处理的事务的GTID。'
- en: The result is that `gtid_set` is added to both [`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)
    and [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged).
  id: totrans-135
  prefs:
  - PREF_IND
  - PREF_IND
  type: TYPE_NORMAL
  zh: 结果是`gtid_set`被添加到[`gtid_executed`](replication-options-gtids.html#sysvar_gtid_executed)和[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)中。
- en: Note
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: If any binary logs from MySQL 5.7.7 or older are present on the server (for
    example, following an upgrade of an older server to MySQL 8.0), after issuing
    a `SET @@GLOBAL.gtid_purged` statement, you might need to set [`binlog_gtid_simple_recovery=FALSE`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)
    in the server's configuration file before restarting the server, otherwise [`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)
    can be computed incorrectly. See the description for [`binlog_gtid_simple_recovery`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)
    for details of the situations in which this setting is needed.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 如果服务器上存在来自MySQL 5.7.7或更早版本的任何二进制日志（例如，在将旧服务器升级到MySQL 8.0后），在发出`SET @@GLOBAL.gtid_purged`语句后，您可能需要在重新启动服务器之前在服务器的配置文件中设置[`binlog_gtid_simple_recovery=FALSE`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)，否则[`gtid_purged`](replication-options-gtids.html#sysvar_gtid_purged)可能会计算错误。有关需要此设置的情况的详细信息，请参阅[`binlog_gtid_simple_recovery`](replication-options-gtids.html#sysvar_binlog_gtid_simple_recovery)的描述。
